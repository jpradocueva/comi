<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" 
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">

<html lang="en" xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head profile="http://www.w3.org/2006/03/hcard http://dublincore.org/documents/2008/08/04/dc-html/">
  <meta http-equiv="Content-Type" content="text/html; charset=us-ascii" />

  <title>Lightweight Machine to Machine Technical Specification - Transport Bindings</title>

  
<style type="text/css">/*<![CDATA[*/
@viewport {
  zoom: 1.0;
  width: extend-to-zoom;
}
@-ms-viewport {
  width: extend-to-zoom;
  zoom: 1.0;
}

@media screen and (min-width: 1024px) {
  ul.toc, #rfc\.toc {
    position: fixed;
    bottom: 0;
    right: 0;
    right: calc(50vw - 525px);
    width: 300px;
    z-index: 1;
  }
  #rfc\.toc {
    top: 15px;
  }
  ul.toc {
    top: 80px;
    overflow: auto;
    overscroll-behavior: contain;
  }

  body {
    padding-right: 350px;
  }
}

body {
  font: 15px "Helvetica Neue",Helvetica,Arial,sans-serif;
  color: #333;
  font-size-adjust: 0.5;
  line-height: 130%;
  margin: 25px auto;
  max-width: 724px;
}

.title, .filename, h1, h2, h3, h4 {
  font-family: "Helvetica Neue",Helvetica,Arial,sans-serif;
  font-size-adjust: 0.5;
  font-weight: 500;
  color: #333;
  line-height: 100%;
  margin: 0.8em 0 0.3em;
}
.title { font-size: 36px; }
h1 { font-size: 30px; }
h2 { font-size: 24px; }
h3, h4 { font-size: 18px; }
h1 a[href], h2 a[href], h3 a[href], h4 a[href] {
  color: #333;
}

ul.toc li {
  list-style: none;
  text-indent: -2.5em;
  padding-left: 2.5em;
  padding-bottom: 5px;
  margin: 0;
}
ul.toc ul {
  margin: 0;
}
/* xml2rfc nests ul directly inside ul which messes with the style badly */
ul.toc, ul.toc>ul, ul.toc ul>ul {
  margin: 0 0 0 1.5em;
}

table {
  margin-left: 0em;
  border-collapse: collapse;
}
th {
  text-align: left;
  border-bottom: 2px solid #ddd;
}
td {
  border-top: 1px solid #ddd;
  vertical-align: top;
}
tr:nth-child(2n+1) > td,
tr:nth-child(2n+1) > th {
  background-color: #f9f9f9;
}
td.reference {
  max-width: 200px;
  border-top: none;
  padding-right: 1em;
}
.right {
  text-align: right;
}


table.header {
  width: 100%;
}
table.header td {
  border: none;
  background-color: transparent;
  color: black;
}
.filename {
  color: rgb(119, 119, 119);
  font-size: 23px;
  font-weight: normal;
  height: auto;
  line-height: 100%;
}
#rfc\.abstract+p {
  font-size: 20px;
  font-weight: 300;
  line-height: 130%;
}

samp, tt, code, pre {
  font: 11pt consolas, monospace;
  font-size-adjust: none;
}
pre {
  background-color: #eee;
  border: 1px solid #ddd;
  overflow-x: auto;
  padding: 5px;
  margin: 5px;
}
.figure {
  font-style: italic;
  margin: 0 1.5em;
}

address {
  margin: 10px 0 0;
}
.vcard {
  font-style: normal;
}
.vcardline {
  display: block;
}
.vcardline .fn {
  font-weight: bold;
}
.vcardline .hidden {
  display: none;
}

dl {
  margin-left: 1em;
}
dl.dl-horizontal: {
  margin-left: 0;
}
dl > dt {
  float: left;
  margin-right: 1em;
}
dl.nohang > dt {
  float: none;
}
dl > dd {
  margin-bottom: .5em;
}
dl.compact > dd {
  margin-bottom: 0em;
}
dl > dd > dl {
  margin-top: 0.5em;
  margin-bottom: 0em;
}
ul.empty {
  list-style-type: none;
}
ul.empty li {
  margin-top: .5em;
}

hr {
  border: 0;
  border-top: 1px solid #eee;
}

a {
  text-decoration: none;
}
a[href] {
  color: #2a6496;
}
a[href]:hover {
  background-color: #eee;
}

ol, ul, li, p {
  padding: 0;
  margin: 0.5em 0 0.5em 2em;
}
li, p {
  margin-left: 0;
}
address {
  font-style: normal;
}

.github-fork-ribbon-wrapper {
  display: none;
}
@media screen and (min-width: 800px) {
  /* "Fork me on GitHub" CSS ribbon based on
   * https://github.com/simonwhitaker/github-fork-ribbon-css
   */
  .github-fork-ribbon {
    position: absolute;
    padding: 2px 0;
    background-color: #a00;
    background-image: linear-gradient(to bottom, rgba(0, 0, 0, 0), rgba(0, 0, 0, 0.15));
    box-shadow: 0 2px 3px 0 rgba(0, 0, 0, 0.5);
    font: 700 12px "Helvetica Neue", Helvetica, Arial, sans-serif;

    pointer-events: auto;

    top: 38px;
    right: -45px;

    transform: rotate(45deg);
  }

  .github-fork-ribbon a[href],
  .github-fork-ribbon a[href]:hover {
    color: #fff;
    background-color: transparent;
    text-decoration: none;
    text-shadow: 0 -1px rgba(0, 0, 0, 0.5);
    text-align: center;

    width: 190px;
    line-height: 18px;

    display: inline-block;
    padding: 2px 0;

    border: 1.5px dotted #fff;
    border-color: rgba(255, 255, 255, 0.6);
  }

  .github-fork-ribbon-wrapper {
    display: block;
    width: 130px;
    height: 130px;
    position: absolute;
    overflow: hidden;
    top: 0; right: 0;
    z-index: 2;
    pointer-events: none;
  }
}
@media screen and (min-width: 1000px) {
  .github-fork-ribbon-wrapper {
    position: fixed;
  }
  /*]]>*/</style>


  <link href="#rfc.toc" rel="Contents">
<link href="#rfc.section.1" rel="Chapter" title="1 Introduction">
<link href="#rfc.section.1.1" rel="Chapter" title="1.1 Terminology">
<link href="#rfc.section.2" rel="Chapter" title="2 LwM2M Architecture">
<link href="#rfc.section.2.1" rel="Chapter" title="2.1 Major differences between RESTCONF and CoMI">
<link href="#rfc.section.2.2" rel="Chapter" title="2.2 Compression of YANG identifiers">
<link href="#rfc.section.2.3" rel="Chapter" title="2.3 Instance identifier">
<link href="#rfc.section.2.4" rel="Chapter" title="2.4 CBOR ordered map schematic">
<link href="#rfc.section.2.5" rel="Chapter" title="2.5 Content-Formats">
<link href="#rfc.section.3" rel="Chapter" title="3 Example syntax">
<link href="#rfc.section.4" rel="Chapter" title="4 CoAP Interface">
<link href="#rfc.section.5" rel="Chapter" title="5 CoMI Collection Interface">
<link href="#rfc.section.5.1" rel="Chapter" title="5.1 Using the &#8216;k&#8217; Uri-Query option">
<link href="#rfc.section.5.2" rel="Chapter" title="5.2 Data Retrieval">
<link href="#rfc.section.5.2.1" rel="Chapter" title="5.2.1 Using the &#8216;c&#8217; Uri-Query option">
<link href="#rfc.section.5.2.2" rel="Chapter" title="5.2.2 Using the &#8216;d&#8217; Uri-Query option">
<link href="#rfc.section.5.2.3" rel="Chapter" title="5.2.3 GET">
<link href="#rfc.section.5.2.4" rel="Chapter" title="5.2.4 FETCH">
<link href="#rfc.section.5.3" rel="Chapter" title="5.3 Data Editing">
<link href="#rfc.section.5.3.1" rel="Chapter" title="5.3.1 Data Ordering">
<link href="#rfc.section.5.3.2" rel="Chapter" title="5.3.2 POST">
<link href="#rfc.section.5.3.3" rel="Chapter" title="5.3.3 PUT">
<link href="#rfc.section.5.3.4" rel="Chapter" title="5.3.4 iPATCH">
<link href="#rfc.section.5.3.5" rel="Chapter" title="5.3.5 DELETE">
<link href="#rfc.section.5.4" rel="Chapter" title="5.4 Full datastore access">
<link href="#rfc.section.5.4.1" rel="Chapter" title="5.4.1 Full datastore examples">
<link href="#rfc.section.5.5" rel="Chapter" title="5.5 Event stream">
<link href="#rfc.section.5.5.1" rel="Chapter" title="5.5.1 Notify Examples">
<link href="#rfc.section.5.6" rel="Chapter" title="5.6 RPC statements">
<link href="#rfc.section.5.6.1" rel="Chapter" title="5.6.1 RPC Example">
<link href="#rfc.section.6" rel="Chapter" title="6 Access to MIB Data">
<link href="#rfc.section.7" rel="Chapter" title="7 Use of Block">
<link href="#rfc.section.8" rel="Chapter" title="8 Resource Discovery">
<link href="#rfc.section.9" rel="Chapter" title="9 Error Handling">
<link href="#rfc.section.10" rel="Chapter" title="10 Security Considerations">
<link href="#rfc.section.10.1" rel="Chapter" title="10.1 DTLS Security">
<link href="#rfc.section.10.1.1" rel="Chapter" title="10.1.1 DTLS Overview">
<link href="#rfc.section.11" rel="Chapter" title="11 IANA Considerations">
<link href="#rfc.section.11.1" rel="Chapter" title="11.1 Resource Type (rt=) Link Target Attribute Values Registry">
<link href="#rfc.section.11.2" rel="Chapter" title="11.2 CoAP Content-Formats Registry">
<link href="#rfc.section.11.3" rel="Chapter" title="11.3 Media Types Registry">
<link href="#rfc.section.11.4" rel="Chapter" title="11.4 Concise Binary Object Representation (CBOR) Tags Registry">
<link href="#rfc.section.12" rel="Chapter" title="12 Acknowledgements">
<link href="#rfc.references" rel="Chapter" title="13 References">
<link href="#rfc.references.1" rel="Chapter" title="13.1 Normative References">
<link href="#rfc.references.2" rel="Chapter" title="13.2 Informative References">
<link href="#rfc.appendix.A" rel="Chapter" title="A ietf-comi YANG module">
<link href="#rfc.appendix.B" rel="Chapter" title="B ietf-comi .sid file">
<link href="#rfc.appendix.C" rel="Chapter" title="C YANG example specifications">
<link href="#rfc.appendix.C.1" rel="Chapter" title="C.1 ietf-system">
<link href="#rfc.appendix.C.2" rel="Chapter" title="C.2 server list">
<link href="#rfc.appendix.C.3" rel="Chapter" title="C.3 interfaces">
<link href="#rfc.appendix.C.4" rel="Chapter" title="C.4 Example-port">
<link href="#rfc.appendix.C.5" rel="Chapter" title="C.5 IP-MIB">
<link href="#rfc.authors" rel="Chapter">


  <meta name="generator" content="xml2rfc version 2.8.2 - https://tools.ietf.org/tools/xml2rfc" />
  <link rel="schema.dct" href="http://purl.org/dc/terms/" />

  <meta name="dct.creator" content="Jimenez, J., Ed., One, A., Two, A., and A. Three" />
  <meta name="dct.identifier" content="urn:ietf:id:draft-omadm-lwm2m-ts" />
  <meta name="dct.issued" scheme="ISO8601" content="2017-12-17" />
  <meta name="dct.abstract" content="This document specifies version 1.0 of the Lightweight Machine-to-Machine (LwM2M) protocol. This Lightweight M2M 1.0 enabler introduces the following features:" />
  <meta name="description" content="This document specifies version 1.0 of the Lightweight Machine-to-Machine (LwM2M) protocol. This Lightweight M2M 1.0 enabler introduces the following features:" />

</head>

<body>

  <table class="header">
    <tbody>
    
    	<tr>
<td class="left">OMA</td>
<td class="right">J. Jimenez, Ed.</td>
</tr>
<tr>
<td class="left">Internet-Draft</td>
<td class="right">Ericsson</td>
</tr>
<tr>
<td class="left">Intended status: Standards Track</td>
<td class="right">A. One</td>
</tr>
<tr>
<td class="left">Expires: June 20, 2018</td>
<td class="right">A. Two</td>
</tr>
<tr>
<td class="left"></td>
<td class="right">A. Three</td>
</tr>
<tr>
<td class="left"></td>
<td class="right">Company</td>
</tr>
<tr>
<td class="left"></td>
<td class="right">December 17, 2017</td>
</tr>

    	
    </tbody>
  </table>

  <p class="title">Lightweight Machine to Machine Technical Specification - Transport Bindings<br />
  <span class="filename">draft-omadm-lwm2m-ts</span></p>
  
  <h1 id="rfc.abstract"><a href="#rfc.abstract">Abstract</a></h1>
<p>This document specifies version 1.0 of the Lightweight Machine-to-Machine (LwM2M) protocol. This Lightweight M2M 1.0 enabler introduces the following features:</p>
<p></p>

<ul>
<li>Simple resource model with the core set of objects and resources defined in this specification. The full list of registered objects can be found at [OMNA].</li>
<li>Operations for creation, update, deletion, and retrieval of resources.</li>
<li>Asynchronous notifications of resource changes.</li>
<li>Support for several serialization formats, namely TLV, JSON, Plain Text and binary data formats and the core set of LightweightM2M Objects.</li>
<li>UDP and SMS transport support.</li>
<li>Communication security based on the DTLS protocol supporting different types of credentials.</li>
<li>Queue Mode offers functionality for a LwM2M Client to inform the LwM2M Server that it may be disconnected for an extended period and when it becomes reachable again.</li>
<li>Support for use of multiple LwM2M Servers.</li>
<li>Provisioning of security credentials and access control lists by a dedicated LwM2M bootstrap-server.</li>
</ul>
<h1><a>Note</a></h1>
<p>Discussion and suggestions for improvement are requested, and should be sent to omaemail@oma.com.</p>
<h1 id="rfc.status"><a href="#rfc.status">Status of This Memo</a></h1>
<p>This Internet-Draft is submitted in full conformance with the provisions of BCP 78 and BCP 79.</p>
<p>Internet-Drafts are working documents of the Internet Engineering Task Force (IETF).  Note that other groups may also distribute working documents as Internet-Drafts.  The list of current Internet-Drafts is at https://datatracker.ietf.org/drafts/current/.</p>
<p>Internet-Drafts are draft documents valid for a maximum of six months and may be updated, replaced, or obsoleted by other documents at any time.  It is inappropriate to use Internet-Drafts as reference material or to cite them other than as "work in progress."</p>
<p>This Internet-Draft will expire on June 20, 2018.</p>
<h1 id="rfc.copyrightnotice"><a href="#rfc.copyrightnotice">Copyright Notice</a></h1>
<p>Copyright (c) 2017 IETF Trust and the persons identified as the document authors.  All rights reserved.</p>
<p>This document is subject to BCP 78 and the IETF Trust's Legal Provisions Relating to IETF Documents (https://trustee.ietf.org/license-info) in effect on the date of publication of this document.  Please review these documents carefully, as they describe your rights and restrictions with respect to this document.  Code Components extracted from this document must include Simplified BSD License text as described in Section 4.e of the Trust Legal Provisions and are provided without warranty as described in the Simplified BSD License.</p>

  
  <hr class="noprint" />
  <h1 class="np" id="rfc.toc"><a href="#rfc.toc">Table of Contents</a></h1>
  <ul class="toc">

  	<li>1.   <a href="#rfc.section.1">Introduction</a>
</li>
<ul><li>1.1.   <a href="#rfc.section.1.1">Terminology</a>
</li>
</ul><li>2.   <a href="#rfc.section.2">LwM2M Architecture</a>
</li>
<ul><li>2.1.   <a href="#rfc.section.2.1">Major differences between RESTCONF and CoMI</a>
</li>
<li>2.2.   <a href="#rfc.section.2.2">Compression of YANG identifiers</a>
</li>
<li>2.3.   <a href="#rfc.section.2.3">Instance identifier</a>
</li>
<li>2.4.   <a href="#rfc.section.2.4">CBOR ordered map schematic</a>
</li>
<li>2.5.   <a href="#rfc.section.2.5">Content-Formats</a>
</li>
</ul><li>3.   <a href="#rfc.section.3">Example syntax</a>
</li>
<li>4.   <a href="#rfc.section.4">CoAP Interface</a>
</li>
<li>5.   <a href="#rfc.section.5">CoMI Collection Interface</a>
</li>
<ul><li>5.1.   <a href="#rfc.section.5.1">Using the &#8216;k&#8217; Uri-Query option</a>
</li>
<li>5.2.   <a href="#rfc.section.5.2">Data Retrieval</a>
</li>
<ul><li>5.2.1.   <a href="#rfc.section.5.2.1">Using the &#8216;c&#8217; Uri-Query option</a>
</li>
<li>5.2.2.   <a href="#rfc.section.5.2.2">Using the &#8216;d&#8217; Uri-Query option</a>
</li>
<li>5.2.3.   <a href="#rfc.section.5.2.3">GET</a>
</li>
<li>5.2.4.   <a href="#rfc.section.5.2.4">FETCH</a>
</li>
</ul><li>5.3.   <a href="#rfc.section.5.3">Data Editing</a>
</li>
<ul><li>5.3.1.   <a href="#rfc.section.5.3.1">Data Ordering</a>
</li>
<li>5.3.2.   <a href="#rfc.section.5.3.2">POST</a>
</li>
<li>5.3.3.   <a href="#rfc.section.5.3.3">PUT</a>
</li>
<li>5.3.4.   <a href="#rfc.section.5.3.4">iPATCH</a>
</li>
<li>5.3.5.   <a href="#rfc.section.5.3.5">DELETE</a>
</li>
</ul><li>5.4.   <a href="#rfc.section.5.4">Full datastore access</a>
</li>
<ul><li>5.4.1.   <a href="#rfc.section.5.4.1">Full datastore examples</a>
</li>
</ul><li>5.5.   <a href="#rfc.section.5.5">Event stream</a>
</li>
<ul><li>5.5.1.   <a href="#rfc.section.5.5.1">Notify Examples</a>
</li>
</ul><li>5.6.   <a href="#rfc.section.5.6">RPC statements</a>
</li>
<ul><li>5.6.1.   <a href="#rfc.section.5.6.1">RPC Example</a>
</li>
</ul></ul><li>6.   <a href="#rfc.section.6">Access to MIB Data</a>
</li>
<li>7.   <a href="#rfc.section.7">Use of Block</a>
</li>
<li>8.   <a href="#rfc.section.8">Resource Discovery</a>
</li>
<li>9.   <a href="#rfc.section.9">Error Handling</a>
</li>
<li>10.   <a href="#rfc.section.10">Security Considerations</a>
</li>
<ul><li>10.1.   <a href="#rfc.section.10.1">DTLS Security</a>
</li>
<ul><li>10.1.1.   <a href="#rfc.section.10.1.1">DTLS Overview</a>
</li>
</ul></ul><li>11.   <a href="#rfc.section.11">IANA Considerations</a>
</li>
<ul><li>11.1.   <a href="#rfc.section.11.1">Resource Type (rt=) Link Target Attribute Values Registry</a>
</li>
<li>11.2.   <a href="#rfc.section.11.2">CoAP Content-Formats Registry</a>
</li>
<li>11.3.   <a href="#rfc.section.11.3">Media Types Registry</a>
</li>
<li>11.4.   <a href="#rfc.section.11.4">Concise Binary Object Representation (CBOR) Tags Registry</a>
</li>
</ul><li>12.   <a href="#rfc.section.12">Acknowledgements</a>
</li>
<li>13.   <a href="#rfc.references">References</a>
</li>
<ul><li>13.1.   <a href="#rfc.references.1">Normative References</a>
</li>
<li>13.2.   <a href="#rfc.references.2">Informative References</a>
</li>
</ul><li>Appendix A.   <a href="#rfc.appendix.A">ietf-comi YANG module</a>
</li>
<li>Appendix B.   <a href="#rfc.appendix.B">ietf-comi .sid file</a>
</li>
<li>Appendix C.   <a href="#rfc.appendix.C">YANG example specifications</a>
</li>
<ul><li>C.1.   <a href="#rfc.appendix.C.1">ietf-system</a>
</li>
<li>C.2.   <a href="#rfc.appendix.C.2">server list</a>
</li>
<li>C.3.   <a href="#rfc.appendix.C.3">interfaces</a>
</li>
<li>C.4.   <a href="#rfc.appendix.C.4">Example-port</a>
</li>
<li>C.5.   <a href="#rfc.appendix.C.5">IP-MIB</a>
</li>
</ul><li><a href="#rfc.authors">Authors' Addresses</a>
</li>


  </ul>

  <h1 id="rfc.section.1">
<a href="#rfc.section.1">1.</a> <a href="#introduction" id="introduction">Introduction</a>
</h1>
<p id="rfc.section.1.p.1">The Constrained Application Protocol (CoAP) <a href="#RFC7252" class="xref">[RFC7252]</a> is designed for Machine to Machine (M2M) applications such as smart energy, smart city and building control.  Constrained devices need to be managed in an automatic fashion to handle the large quantities of devices that are expected in future installations. Messages between devices need to be as small and infrequent as possible. The implementation complexity and runtime resources need to be as small as possible.</p>
<p id="rfc.section.1.p.2">This specification defines the transport bindings for the LwM2M messaging protocol used between the LwM2M Client, the LwM2M Bootstrap Server and with the LwM2M Server. Figure 1 shows the relationships between the transport bindings and the messaging protocol. In particular, this specification defines the following transport bindings.</p>
<p></p>

<ul>
<li>CoAP over UDP</li>
<li>CoAP over DTLS over UDP</li>
<li>CoAP over SMS</li>
<li>CoAP over DTLS over SMS</li>
</ul>
<h1 id="rfc.section.1.1">
<a href="#rfc.section.1.1">1.1.</a> <a href="#terminology" id="terminology">Terminology</a>
</h1>
<p id="rfc.section.1.1.p.1">The key words &#8220;MUST&#8221;, &#8220;MUST NOT&#8221;, &#8220;REQUIRED&#8221;, &#8220;SHALL&#8221;, &#8220;SHALL NOT&#8221;, &#8220;SHOULD&#8221;, &#8220;SHOULD NOT&#8221;, &#8220;RECOMMENDED&#8221;, &#8220;MAY&#8221;, and &#8220;OPTIONAL&#8221; in this document are to be interpreted as described in <a href="#RFC2119" class="xref">[RFC2119]</a>.</p>
<h1 id="rfc.section.2">
<a href="#rfc.section.2">2.</a> <a href="#lwm2m-architecture" id="lwm2m-architecture">LwM2M Architecture</a>
</h1>
<p id="rfc.section.2.p.1">A general architecture can be seen below <a href="#archit" class="xref">Figure 1</a>.</p>
<div id="rfc.figure.1"></div>
<div id="archit"></div>
<pre>
+----------------------------------+  +---------+
|              LWM2M               |  | Objects |
+----------------------------------+  +---------+
+----------------------------------+
|              CoAP                |
+----------------------------------+
+----------------+ +---------------+
|      DTLS      | |    SMS        |
+----------------+ |               |
+-------+ +------+ |  on Smartcard |
|  UDP  | |SMS on| |               |
|       | |device| |               |
+-------+ +------+ +---------------+
</pre>
<p class="figure">Figure 1: The Protocol Stack of the LwM2M Enabler</p>
<h1 id="rfc.section.2.1">
<a href="#rfc.section.2.1">2.1.</a> <a href="#major-differences" id="major-differences">Major differences between RESTCONF and CoMI</a>
</h1>
<p id="rfc.section.2.1.p.1">CoMI is a RESTful protocol for small devices where saving bytes to transport counts. Contrary to RESTCONF, many design decisions are motivated by the saving of bytes. Consequently, CoMI is not a RESTCONF over CoAP protocol, but differs more significantly from RESTCONF. Some major differences are cited below:</p>
<p></p>

<ul>
<li>CoMI uses CoAP/UDP as transport protocol and CBOR as payload format <a href="#I-D.ietf-core-yang-cbor" class="xref">[I-D.ietf-core-yang-cbor]</a>. RESTCONF uses HTTP/TCP as transport protocol and JSON <a href="#RFC7159" class="xref">[RFC7159]</a> or XML <a href="#XML" class="xref">[XML]</a> as payload formats.</li>
<li>CoMI encodes YANG identifier strings as numbers, where RESTCONF does not.</li>
<li>CoMI uses the methods FETCH and iPATCH, not used by RESTCONF.  RESTCONF uses the HTTP methods HEAD, and OPTIONS, which are not used by CoMI.</li>
<li>CoMI does not support &#8220;insert&#8221; query parameter (first, last, before, after) and the &#8220;point&#8221; query parameter which are supported by RESTCONF.</li>
<li>CoMI does not support the &#8220;start-time&#8221; and &#8220;stop-time&#8221; query parameters to retrieve past notifications.</li>
<li>CoMI and RESTCONF also differ in the handling of:  <ul>
<li>notifications.</li>
<li>default values.</li>
</ul>
</li>
</ul>
<h1 id="rfc.section.2.2">
<a href="#rfc.section.2.2">2.2.</a> <a href="#id-compression" id="id-compression">Compression of YANG identifiers</a>
</h1>
<p id="rfc.section.2.2.p.1">In the YANG specification, items are identified with a name string. In order to significantly reduce the size of identifiers used in CoMI, numeric identifiers are used instead of these strings.  YANG Schema Item iDentifier (SID) is defined in <a href="#I-D.ietf-core-yang-cbor" class="xref">[I-D.ietf-core-yang-cbor]</a> section 2.1.</p>
<p id="rfc.section.2.2.p.2">When used in a URI, SIDs are encoded in based64 using the URL and Filename safe alphabet as defined by <a href="#RFC4648" class="xref">[RFC4648]</a> section 5. The last 6 bits encoded is always aligned with the least significant 6 bits of the SID represented using an unsigned integer.  &#8216;A&#8217; characters (value 0) at the start of the resulting string are removed.</p>
<pre>
SID in basae64 = URLsafeChar[SID &gt;&gt; 60 &amp; 0x3F] |
                 URLsafeChar[SID &gt;&gt; 54 &amp; 0x3F] |
                 URLsafeChar[SID &gt;&gt; 48 &amp; 0x3F] |
                 URLsafeChar[SID &gt;&gt; 42 &amp; 0x3F] |  
                 URLsafeChar[SID &gt;&gt; 36 &amp; 0x3F] |
                 URLsafeChar[SID &gt;&gt; 30 &amp; 0x3F] |
                 URLsafeChar[SID &gt;&gt; 24 &amp; 0x3F] |  
                 URLsafeChar[SID &gt;&gt; 18 &amp; 0x3F] |
                 URLsafeChar[SID &gt;&gt; 12 &amp; 0x3F] |
                 URLsafeChar[SID &gt;&gt; 6 &amp; 0x3F] |
                 URLsafeChar[SID &amp; 0x3F]
</pre>
<p id="rfc.section.2.2.p.3">For example, SID 1721 is encoded as follow.</p>
<pre>
URLsafeChar[1721 &gt;&gt; 60 &amp; 0x3F] = URLsafeChar[0] = 'A'
URLsafeChar[1721 &gt;&gt; 54 &amp; 0x3F] = URLsafeChar[0] = 'A'
URLsafeChar[1721 &gt;&gt; 48 &amp; 0x3F] = URLsafeChar[0] = 'A'
URLsafeChar[1721 &gt;&gt; 42 &amp; 0x3F] = URLsafeChar[0] = 'A'
URLsafeChar[1721 &gt;&gt; 36 &amp; 0x3F] = URLsafeChar[0] = 'A'
URLsafeChar[1721 &gt;&gt; 30 &amp; 0x3F] = URLsafeChar[0] = 'A'
URLsafeChar[1721 &gt;&gt; 24 &amp; 0x3F] = URLsafeChar[0] = 'A'
URLsafeChar[1721 &gt;&gt; 18 &amp; 0x3F] = URLsafeChar[0] = 'A'
URLsafeChar[1721 &gt;&gt; 12 &amp; 0x3F] = URLsafeChar[0] = 'A'
URLsafeChar[1721 &gt;&gt; 6 &amp; 0x3F]  = URLsafeChar[26] = 'a'
URLsafeChar[1721 &amp; 0x3F]       = URLsafeChar[57] = '5'
</pre>
<p id="rfc.section.2.2.p.4">The resulting base64 representation of SID 1721 is &#8220;a5&#8221;</p>
<h1 id="rfc.section.2.3">
<a href="#rfc.section.2.3">2.3.</a> <a href="#instance-identifier" id="instance-identifier">Instance identifier</a>
</h1>
<p id="rfc.section.2.3.p.1">Instance identifiers are used to uniquely identify data node instances within a datastore. This YANG built-in type is defined in <a href="#RFC7950" class="xref">[RFC7950]</a> section 9.13. An instance identifier is composed of the data node identifier (i.e. a SID) and for data nodes within list(s) the keys used to index within these list(s).</p>
<p id="rfc.section.2.3.p.2">When part of a payload, instance identifiers are encoded in CBOR based on the rules defined in <a href="#I-D.ietf-core-yang-cbor" class="xref">[I-D.ietf-core-yang-cbor]</a> section 5.13.1. When part of a URI, the SID is appended to the URI of the targeted datastore, the keys are specified using the &#8216;k&#8217; URI-Query as defined in <a href="#query" class="xref">Section 5.1</a>.</p>
<h1 id="rfc.section.2.4">
<a href="#rfc.section.2.4">2.4.</a> <a href="#ordered-map" id="ordered-map">CBOR ordered map schematic</a>
</h1>
<p id="rfc.section.2.4.p.1">An ordered map is used as a root container of the application/yang-tree+cbor Content-Format. This datatype share the same functionalities as a CBOR map without the following limitations:</p>
<p></p>

<ul>
<li>The ordering of the pairs of data items is preserved from serialization to deserialization.</li>
<li>Duplicate keys are allowed</li>
</ul>
<p id="rfc.section.2.4.p.3">This schematic is constructed using a CBOR array comprising pairs of data items, each pair consisting of a key that is immediately followed by a value. Unlike a CBOR map for which the length denotes the number of pairs, the length of the ordered map denotes the number of items (i.e. number of keys plus number of values).</p>
<p id="rfc.section.2.4.p.4">The use of this schematic can be inferred from its context or by the presence of a preceding tag. The tag assigned to the Ordered map is defined in <a href="#tags-registry" class="xref">Section 11.4</a>.</p>
<p id="rfc.section.2.4.p.5">In the case of CoMI, the use of the ordered map as the root container of the application/yang-tree+cbor Content-Format is inferred, the Ordered map tag is not used.</p>
<h1 id="rfc.section.2.5">
<a href="#rfc.section.2.5">2.5.</a> <a href="#content-format" id="content-format">Content-Formats</a>
</h1>
<p id="rfc.section.2.5.p.1">ComI uses Content-Formats based on the YANG to CBOR mapping specified in <a href="#I-D.ietf-core-yang-cbor" class="xref">[I-D.ietf-core-yang-cbor]</a>. All Content-Formats defined hereafter are constructed using one or both of these constructs:</p>
<p></p>

<ul>
<li>YANG data node value, encoded based on the rules defined in <a href="#I-D.ietf-core-yang-cbor" class="xref">[I-D.ietf-core-yang-cbor]</a> section 4.</li>
<li>YANG instance identifier, encoded based on the rules defined in <a href="#I-D.ietf-core-yang-cbor" class="xref">[I-D.ietf-core-yang-cbor]</a> section 5.13.1.</li>
</ul>
<p id="rfc.section.2.5.p.3">The following Content-formats are defined:</p>
<p></p>

<dl>
<dt>application/yang-value+cbor:</dt>
<dd style="margin-left: 8">represents a CBOR YANG document containing one YANG data node value.  The YANG data node instance can be a leaf, a container, a list, a list instance, a RPC input, a RPC output, an action input, an action output, a leaf-list, an anydata or an anyxml. The CBOR encoding for each of these YANG data node instances are defined in <a href="#I-D.ietf-core-yang-cbor" class="xref">[I-D.ietf-core-yang-cbor]</a> section 4.</dd>
<dt></dt>
<dd style="margin-left: 8">FORMAT: data-node-value</dd>
<dt></dt>
<dd style="margin-left: 8">DELTA ENCODING: SIDs included in a YANG container, a list instance, a RPC input, a RPC output, an action input, an actions output and an anydata are encoded using a delta value equal to the SID of the current schema node minus the SID of the parent. The parent SID of root data nodes is defined by the URI carried in the associated request (i.e. GET, PUT, POST).</dd>
<dt>application/yang-values+cbor:</dt>
<dd style="margin-left: 8">represents a YANG document containing a list of data node values.</dd>
<dt></dt>
<dd style="margin-left: 8">FORMAT: CBOR array of data-node-value</dd>
<dt></dt>
<dd style="margin-left: 8">DELTA ENCODING: SIDs included in a YANG container, a list instance and an anydata are encoded using a delta value equal to the SID of the current schema node minus the SID of the parent.  The parent SID of root data nodes is defined by the corresponding instance-identifier carried in the FETCH request.</dd>
<dt>application/yang-tree+cbor:</dt>
<dd style="margin-left: 8">represents a CBOR YANG document containing a YANG data tree.</dd>
<dt></dt>
<dd style="margin-left: 8">FORMAT: ordered map of single-instance-identifier, data-node-value</dd>
<dt></dt>
<dd style="margin-left: 8">DELTA ENCODING: The SID part of the first instance-identifier within the ordered map is encoded using its absolute value. Subsequent instance-identifiers are encoded using a delta value equal to the SID of the current instance-identifiers minus the SID of the previous instance-identifier.</dd>
<dt>application/yang-selectors+cbor:</dt>
<dd style="margin-left: 8">represents a CBOR YANG document containing a list of data node selectors (i.e. instance identifier).</dd>
<dt></dt>
<dd style="margin-left: 8">FORMAT: CBOR array of instance-identifier</dd>
<dt></dt>
<dd style="margin-left: 8">DELTA ENCODING: The SID part of the first instance-identifier within the CBOR array is encoded using its absolute value. Subsequent instance-identifiers are encoded using a delta value equal to the SID of the current instance-identifiers minus the SID of the previous instance-identifier.</dd>
<dt>application/yang-patch+cbor:</dt>
<dd style="margin-left: 8">represents a CBOR YANG document containing a list of data nodes to be replaced, created, or deleted.</dd>
<dt></dt>
<dd style="margin-left: 8">For each data node instance, D, for which the instance identifier is the same as for a data node instance, I, in the targeted resource: the data node value of D replaces the data node value of I. When the data node value of D is null, the data node instance I is removed. When the targeted resource does not contain a data node instance with the same instance identifier as D, a new data node instance is created in the targeted resource with the same instance identifier and data node value as D.</dd>
<dt></dt>
<dd style="margin-left: 8">FORMAT: ordered map of instance-identifier, data-node-value</dd>
<dt></dt>
<dd style="margin-left: 8">DELTA ENCODING: Same as Content-Format application/yang-tree+cbor</dd>
</dl>
<p id="rfc.section.2.5.p.5">The different Content-formats usage is  summarized in the table below:</p>
<table cellpadding="3" cellspacing="0" class="tt full left">
<thead><tr>
<th class="left">Method</th>
<th class="left">Resource</th>
<th class="left">Content-Format</th>
</tr></thead>
<tbody>
<tr>
<td class="left">GET response</td>
<td class="left">data node</td>
<td class="left">/application/yang-value+cbor</td>
</tr>
<tr>
<td class="left">PUT request</td>
<td class="left">data node</td>
<td class="left">/application/yang-value+cbor</td>
</tr>
<tr>
<td class="left">POST request</td>
<td class="left">data node</td>
<td class="left">/application/yang-value+cbor</td>
</tr>
<tr>
<td class="left">DELETE</td>
<td class="left">data node</td>
<td class="left">n/a</td>
</tr>
<tr>
<td class="left">GET response</td>
<td class="left">datastore</td>
<td class="left">/application/yang-tree+cbor</td>
</tr>
<tr>
<td class="left">PUT request</td>
<td class="left">datastore</td>
<td class="left">/application/yang-tree+cbor</td>
</tr>
<tr>
<td class="left">POST request</td>
<td class="left">datastore</td>
<td class="left">/application/yang-tree+cbor</td>
</tr>
<tr>
<td class="left">FETCH request</td>
<td class="left">datastore</td>
<td class="left">/application/yang-selectors+cbor</td>
</tr>
<tr>
<td class="left">FETCH response</td>
<td class="left">datastore</td>
<td class="left">/application/yang-values+cbor</td>
</tr>
<tr>
<td class="left">iPATCH request</td>
<td class="left">datastore</td>
<td class="left">/application/yang-patch+cbor</td>
</tr>
<tr>
<td class="left">GET response</td>
<td class="left">event stream</td>
<td class="left">/application/yang-tree+cbor</td>
</tr>
<tr>
<td class="left">POST request</td>
<td class="left">rpc, action</td>
<td class="left">/application/yang-value+cbor</td>
</tr>
<tr>
<td class="left">POST response</td>
<td class="left">rpc, action</td>
<td class="left">/application/yang-value+cbor</td>
</tr>
</tbody>
</table>
<h1 id="rfc.section.3">
<a href="#rfc.section.3">3.</a> <a href="#example-syntax" id="example-syntax">Example syntax</a>
</h1>
<p id="rfc.section.3.p.1">This section presents the notation used for the examples. The YANG modules that are used throughout this document are shown in <a href="#example-specifications" class="xref">Appendix C</a>.  The example modules are copied from existing modules and annotated with SIDs. The values of the SIDs are taken over from <a href="#yang-cbor" class="xref">[yang-cbor]</a>.</p>
<p id="rfc.section.3.p.2">CBOR is used to encode CoMI request and response payloads. The CBOR syntax of the YANG payloads is specified in <a href="#RFC7049" class="xref">[RFC7049]</a>. The payload examples are notated in Diagnostic notation (defined in section 6 of <a href="#RFC7049" class="xref">[RFC7049]</a>) that can be automatically converted to CBOR.</p>
<p id="rfc.section.3.p.3">SIDs in URIs are represented as a base64 number, SIDs in the payload are represented as decimal numbers.</p>
<h1 id="rfc.section.4">
<a href="#rfc.section.4">4.</a> <a href="#coap-interface" id="coap-interface">CoAP Interface</a>
</h1>
<p id="rfc.section.4.p.1">The format of the links is specified in <a href="#I-D.ietf-core-interfaces" class="xref">[I-D.ietf-core-interfaces]</a>.  This note specifies a Management Collection Interface. CoMI end-points that implement the CoMI management protocol, support at least one discoverable management resource of resource type (rt): core.c.datastore, with example path: /c, where c is short-hand for CoMI. The path /c is recommended but not compulsory (see <a href="#discovery" class="xref">Section 8</a>).</p>
<p id="rfc.section.4.p.2">Three CoMI resources are accessible with the following three example paths:</p>
<p></p>

<dl>
<dt>/c:</dt>
<dd style="margin-left: 8">Datastore resource with path &#8220;/c&#8221; and using CBOR content encoding format.  Sub-resouces of format /c/instance-identifier may be available to access directly each data node resource for this datastore.</dd>
<dt>/mod.uri:</dt>
<dd style="margin-left: 8">URI identifying the location of the YANG module library used by this server, with path &#8220;/mod.uri&#8221; and Content-Format &#8220;text/plain; charset=utf-8&#8221;. An ETag MUST be maintained for this resource by the server, which MUST be changed to a new value when the set of YANG modules in use by the server changes.</dd>
<dt>/s:</dt>
<dd style="margin-left: 8">Event stream resource to which YANG notification instances are reported.  Notification support is optional, so this resource will not exist if the server does not support any notifications.</dd>
</dl>
<p id="rfc.section.4.p.4">The mapping of YANG data node instances to CoMI resources is as follows.  Every data node of the YANG modules loaded in the CoMI server represents a sub-resource of the datastore resource (e.g. /c/instance-identifier).</p>
<p id="rfc.section.4.p.5">When multiple instances of a list exist, instance selection is possible as described in <a href="#query" class="xref">Section 5.1</a>, <a href="#fetch" class="xref">Section 5.2.4</a>, and <a href="#get-example" class="xref">Section 5.2.3.1</a>.</p>
<p id="rfc.section.4.p.6">The description of the management collection interface, with if=core.c, is shown in the table below, following the guidelines of <a href="#I-D.ietf-core-interfaces" class="xref">[I-D.ietf-core-interfaces]</a>:</p>
<table cellpadding="3" cellspacing="0" class="tt full left">
<thead><tr>
<th class="left">Function</th>
<th class="left">Recommended path</th>
<th class="left">rt</th>
</tr></thead>
<tbody>
<tr>
<td class="left">Datastore</td>
<td class="left">/c</td>
<td class="left">core.c.datastore</td>
</tr>
<tr>
<td class="left">Data node</td>
<td class="left">/c/instance-identifier</td>
<td class="left">core.c.datanode</td>
</tr>
<tr>
<td class="left">YANG module library</td>
<td class="left">/mod.uri</td>
<td class="left">core.c.moduri</td>
</tr>
<tr>
<td class="left">Event steam</td>
<td class="left">/s</td>
<td class="left">core.c.eventstream</td>
</tr>
</tbody>
</table>
<p id="rfc.section.4.p.7">The path values are example values. On discovery, the server makes the actual path values known for these four resources.</p>
<h1 id="rfc.section.5">
<a href="#rfc.section.5">5.</a> <a href="#collection-interface" id="collection-interface">CoMI Collection Interface</a>
</h1>
<p id="rfc.section.5.p.1">The CoMI Collection Interface provides a CoAP interface to manage YANG servers.</p>
<p id="rfc.section.5.p.2">The methods used by CoMI are:</p>
<table cellpadding="3" cellspacing="0" class="tt full left">
<thead><tr>
<th class="left">Operation</th>
<th class="left">Description</th>
</tr></thead>
<tbody>
<tr>
<td class="left">GET</td>
<td class="left">Retrieve the datastore resource or a data node resource</td>
</tr>
<tr>
<td class="left">FETCH</td>
<td class="left">Retrieve specific data nodes within a datastore resource</td>
</tr>
<tr>
<td class="left">POST</td>
<td class="left">Create a datastore resource or a data node resource, invoke an RPC or action</td>
</tr>
<tr>
<td class="left">PUT</td>
<td class="left">Create or replace a datastore resource or a data node resource</td>
</tr>
<tr>
<td class="left">iPATCH</td>
<td class="left">Idem-potently create, replace, and delete data node resource(s) within a datastore resource</td>
</tr>
<tr>
<td class="left">DELETE</td>
<td class="left">Delete a datastore resource or a data node resource</td>
</tr>
</tbody>
</table>
<p id="rfc.section.5.p.3">There is one Uri-Query option for the GET, PUT, POST, and DELETE methods.</p>
<table cellpadding="3" cellspacing="0" class="tt full left">
<thead><tr>
<th class="left">Uri-Query option</th>
<th class="left">Description</th>
</tr></thead>
<tbody><tr>
<td class="left">k</td>
<td class="left">Select an instance within YANG list(s)</td>
</tr></tbody>
</table>
<p id="rfc.section.5.p.4">This parameter is not used for FETCH and iPATCH, because their request payloads support list instance selection.</p>
<h1 id="rfc.section.5.1">
<a href="#rfc.section.5.1">5.1.</a> <a href="#query" id="query">Using the &#8216;k&#8217; Uri-Query option</a>
</h1>
<p id="rfc.section.5.1.p.1">The &#8220;k&#8221; (key) parameter specifies a specific instance of a data node.  The SID in the URI is followed by the (?k=key1, key2,..). Where SID identifies a data node, and key1, key2 are the values of the key leaves that specify an instance. Lists can have multiple keys, and lists can be part of lists. The order of key value generation is given recursively by:</p>
<p></p>

<ul>
<li>For a given list, if a parent data node is a list, generate the keys for the parent list first.</li>
<li>For a given list, generate key values in the order specified in the YANG module.</li>
</ul>
<p id="rfc.section.5.1.p.3">Key values are encoded using the rules defined in the following table.</p>
<table cellpadding="3" cellspacing="0" class="tt full left">
<thead><tr>
<th class="left">YANG datatype</th>
<th class="left">Uri-Query text content</th>
</tr></thead>
<tbody>
<tr>
<td class="left">uint8,uint16,unit32, uint64</td>
<td class="left">int2str(key)</td>
</tr>
<tr>
<td class="left">int8, int16,int32, int64</td>
<td class="left">urlSafeBase64(CBORencode(key))</td>
</tr>
<tr>
<td class="left">decimal64</td>
<td class="left">urlSafeBase64(CBOR key)</td>
</tr>
<tr>
<td class="left">string</td>
<td class="left">key</td>
</tr>
<tr>
<td class="left">boolean</td>
<td class="left">&#8220;0&#8221; or &#8220;1&#8221;</td>
</tr>
<tr>
<td class="left">enumeration</td>
<td class="left">int2str(key)</td>
</tr>
<tr>
<td class="left">bits</td>
<td class="left">urlSafeBase64(CBORencode(key))</td>
</tr>
<tr>
<td class="left">binary</td>
<td class="left">urlSafeBase64(key)</td>
</tr>
<tr>
<td class="left">identityref</td>
<td class="left">int2str(key)</td>
</tr>
<tr>
<td class="left">union</td>
<td class="left">urlSafeBase64(CBORencode(key))</td>
</tr>
<tr>
<td class="left">instance-identifier</td>
<td class="left">urlSafeBase64(CBORencode(key))</td>
</tr>
</tbody>
</table>
<p id="rfc.section.5.1.p.4">In this table:</p>
<p></p>

<ul>
<li>The method int2str() is used to convert an integer value to a string. For example, int2str(0x0123) return  the string &#8220;291&#8221;.</li>
<li>The method urlSafeBase64() is used to convert a binary string to base64 using the URL and Filename safe alphabet as defined by <a href="#RFC4648" class="xref">[RFC4648]</a> section 5. For example, urlSafeBase64(\xF9\x56\xA1\x3C) return the string &#8220;-VahPA&#8221;.</li>
<li>The method CBORencode() is used to convert a YANG value to CBOR as specified in <a href="#I-D.ietf-core-yang-cbor" class="xref">[I-D.ietf-core-yang-cbor]</a> section 5, item 8.</li>
</ul>
<p id="rfc.section.5.1.p.6">The resulting key string is encoded in a Uri-Query as specified in <a href="#RFC7252" class="xref">[RFC7252]</a> section 6.5.</p>
<h1 id="rfc.section.5.2">
<a href="#rfc.section.5.2">5.2.</a> <a href="#data-retrieval" id="data-retrieval">Data Retrieval</a>
</h1>
<p id="rfc.section.5.2.p.1">One or more data nodes can be retrieved by the client.  The operation is mapped to the GET method defined in section 5.8.1 of <a href="#RFC7252" class="xref">[RFC7252]</a> and to the FETCH method defined in section 2 of <a href="#RFC8132" class="xref">[RFC8132]</a>.</p>
<p id="rfc.section.5.2.p.2">It is possible that the size of the payload is too large to fit in a single message. In the case that management data is bigger than the maximum supported payload size, the Block mechanism from <a href="#RFC7959" class="xref">[RFC7959]</a> may be used, as explained in more detail in <a href="#block" class="xref">Section 7</a>.</p>
<p id="rfc.section.5.2.p.3">There are two additional Uri-Query options for the GET and FETCH methods.</p>
<table cellpadding="3" cellspacing="0" class="tt full left">
<thead><tr>
<th class="left">Uri-Query option</th>
<th class="left">Description</th>
</tr></thead>
<tbody>
<tr>
<td class="left">c</td>
<td class="left">Control selection of configuration and non-configuration data nodes (GET and FETCH)</td>
</tr>
<tr>
<td class="left">d</td>
<td class="left">Control retrieval of default values.</td>
</tr>
</tbody>
</table>
<h1 id="rfc.section.5.2.1">
<a href="#rfc.section.5.2.1">5.2.1.</a> <a href="#content" id="content">Using the &#8216;c&#8217; Uri-Query option</a>
</h1>
<p id="rfc.section.5.2.1.p.1">The &#8216;c&#8217; (content) parameter controls how descendant nodes of the requested data nodes will be processed in the reply.</p>
<p id="rfc.section.5.2.1.p.2">The allowed values are:</p>
<table cellpadding="3" cellspacing="0" class="tt full left">
<thead><tr>
<th class="left">Value</th>
<th class="left">Description</th>
</tr></thead>
<tbody>
<tr>
<td class="left">c</td>
<td class="left">Return only configuration descendant data nodes</td>
</tr>
<tr>
<td class="left">n</td>
<td class="left">Return only non-configuration descendant data nodes</td>
</tr>
<tr>
<td class="left">a</td>
<td class="left">Return all descendant data nodes</td>
</tr>
</tbody>
</table>
<p id="rfc.section.5.2.1.p.3">This parameter is only allowed for GET and FETCH methods on datastore and data node resources.  A 4.02 (Bad Option) error is returned if used for other methods or resource types.</p>
<p id="rfc.section.5.2.1.p.4">If this Uri-Query option is not present, the default value is &#8220;a&#8221;.</p>
<h1 id="rfc.section.5.2.2">
<a href="#rfc.section.5.2.2">5.2.2.</a> <a href="#dquery" id="dquery">Using the &#8216;d&#8217; Uri-Query option</a>
</h1>
<p id="rfc.section.5.2.2.p.1">The &#8220;d&#8221; (with-defaults) parameter controls how the default values of the descendant nodes of the requested data nodes will be processed.</p>
<p id="rfc.section.5.2.2.p.2">The allowed values are:</p>
<table cellpadding="3" cellspacing="0" class="tt full left">
<thead><tr>
<th class="left">Value</th>
<th class="left">Description</th>
</tr></thead>
<tbody>
<tr>
<td class="left">a</td>
<td class="left">All data nodes are reported. Defined as &#8216;report-all&#8217; in section 3.1 of <a href="#RFC6243" class="xref">[RFC6243]</a>.</td>
</tr>
<tr>
<td class="left">t</td>
<td class="left">Data nodes set to the YANG default are not reported. Defined as &#8216;trim&#8217; in section 3.2 of <a href="#RFC6243" class="xref">[RFC6243]</a>.</td>
</tr>
</tbody>
</table>
<p id="rfc.section.5.2.2.p.3">If the target of a GET or FETCH method is a data node that represents a leaf that has a default value, and the leaf has not been given a value by any client yet, the server MUST return the default value of the leaf.</p>
<p id="rfc.section.5.2.2.p.4">If the target of a GET method is a data node that represents a container or list that has child resources with default values, and these have not been given value yet,</p>
<p></p>

<ul class="empty"><li>The server MUST not return the child resource if d= &#8216;t&#8217;</li></ul>
<p></p>

<ul class="empty"><li>The server MUST return the child resource if d= &#8216;a&#8217;.</li></ul>
<p id="rfc.section.5.2.2.p.7">If this Uri-Query option is not present, the default value is &#8216;t&#8217;.</p>
<h1 id="rfc.section.5.2.3">
<a href="#rfc.section.5.2.3">5.2.3.</a> <a href="#get-operation" id="get-operation">GET</a>
</h1>
<p id="rfc.section.5.2.3.p.1">A request to read the values of a data node instance is sent with a confirmable CoAP GET message. An instance identifier is specified in the URI path prefixed with the example path /c.</p>
<pre>
FORMAT:
  GET /c/instance-identifier

  2.05 Content (Content-Format: application/yang-value+cbor)
  data-node-value
</pre>
<p id="rfc.section.5.2.3.p.2">The returned payload contains the CBOR encoding of the specified data node instance value.</p>
<h1 id="rfc.section.5.2.3.1">
<a href="#rfc.section.5.2.3.1">5.2.3.1.</a> <a href="#get-example" id="get-example">GET Examples</a>
</h1>
<p id="rfc.section.5.2.3.1.p.1">Using for example the current-datetime leaf from <a href="#ietf-system" class="xref">Appendix C.1</a>, a request is sent to retrieve the value of system-state/clock/current-datetime specified in container system-state.  The SID of system-state/clock/current-datetime is 1723, encoded in octal 3273, yields two 6 bit decimal numbers 32 and 73, encoded in base64, (according to table 2 of <a href="#RFC4648" class="xref">[RFC4648]</a>) yields a7. The response to the request returns the CBOR encoding of this leaf of type &#8216;string&#8217; as defined in <a href="#I-D.ietf-core-yang-cbor" class="xref">[I-D.ietf-core-yang-cbor]</a> section 5.4.</p>
<pre>
REQ: GET example.com/c/a3

RES: 2.05 Content (Content-Format: application/yang-value+cbor)
"2014-10-26T12:16:31Z"
</pre>
<p id="rfc.section.5.2.3.1.p.2">The next example represents the retrieval of a YANG container. In this case, the CoMI client performs a GET request on the clock container (SID = 1721; base64: a5). The container returned is encoded using a CBOR map as specified by <a href="#I-D.ietf-core-yang-cbor" class="xref">[I-D.ietf-core-yang-cbor]</a> section 4.2.</p>
<pre>
REQ: GET example.com/c/a5

RES: 2.05 Content (Content-Format: application/yang-value+cbor)
{
  +2 : "2014-10-26T12:16:51Z",   / current-datetime SID 1723 /
  +1 : "2014-10-21T03:00:00Z"    / boot-datetime SID 1722 /
}
</pre>
<p id="rfc.section.5.2.3.1.p.3">This example shows the retrieval of the /interfaces/interface YANG list accessed using SID 1533 (base64: X9). The return payload is encoded using a CBOR array as specified by <a href="#I-D.ietf-core-yang-cbor" class="xref">[I-D.ietf-core-yang-cbor]</a> section 4.4.1 containing 2 instances.</p>
<pre>
REQ: GET example.com/c/X9

RES: 2.05 Content (Content-Format: application/yang-value+cbor)
[
  {
    +4 : "eth0",                / name  (SID 1537) /
    +1 : "Ethernet adaptor",    / description (SID 1534) /
    +5 : 1880,                  / type, (SID 1538) identity /
                                / ethernetCsmacd (SID 1880) /
    +2 : true                   / enabled ( SID 1535) /
  },
  {
    +4 : "eth1",                / name (SID 1537) /
    +1 : "Ethernet adaptor",    / description (SID 1534) /
    +5 : 1880,                  / type, (SID 1538) identity /
                                / ethernetCsmacd (SID 1880) /
    +2 : false                  / enabled /
  }
]
</pre>
<p id="rfc.section.5.2.3.1.p.4">It is equally possible to select a leaf of a specific instance of a list.  The example below requests the description leaf (SID=1534, base64: X-) within the interface list corresponding to the list key &#8220;eth0&#8221;.  The returned value is encoded in CBOR based on the rules specified by <a href="#I-D.ietf-core-yang-cbor" class="xref">[I-D.ietf-core-yang-cbor]</a> section 5.4.</p>
<pre>
REQ: GET example.com/c/X-?k="eth0"

RES: 2.05 Content (Content-Format: application/yang-value+cbor)
"Ethernet adaptor"
</pre>
<h1 id="rfc.section.5.2.4">
<a href="#rfc.section.5.2.4">5.2.4.</a> <a href="#fetch" id="fetch">FETCH</a>
</h1>
<p id="rfc.section.5.2.4.p.1">The FETCH is used to retrieve multiple data node values. The FETCH request payload contains a list of instance-identifier encoded based on the rules defined by Content-Format application/yang-selectors+cbor in <a href="#content-format" class="xref">Section 2.5</a>.  The return response payload contains a list of values encoded based on the rules defined by Content-Format application/yang-values+cbor in <a href="#content-format" class="xref">Section 2.5</a>.  A value MUST be returned for each instance-identifier specified in the request.  A CBOR null is returned for each data node requested by the client, not supported by the server or not currently instantiated.</p>
<pre>
FORMAT:
  FETCH /c (Content-Format :application/yang-selectors+cbor)
  CBOR array of instance-identifier

  2.05 Content (Content-Format: application/yang-values+cbor)
  CBOR array of data-node-value
</pre>
<h1 id="rfc.section.5.2.4.1">
<a href="#rfc.section.5.2.4.1">5.2.4.1.</a> <a href="#fetch-example" id="fetch-example">FETCH examples</a>
</h1>
<p id="rfc.section.5.2.4.1.p.1">The example uses the current-datetime leaf and the interface list from <a href="#ietf-system" class="xref">Appendix C.1</a>.  In the following example the value of current-datetime (SID 1723 and the interface list (SID 1533) instance identified with name=&#8221;eth0&#8221; are queried.</p>
<pre>
REQ:  FETCH /c (Content-Format :application/yang-selectors+cbor)
[
  1723,            / current-datetime SID 1723 /
  [-190, "eth0"]   / interface SID 1533 with name = "eth0" /
]

RES:  2.05 Content (Content-Format :application/yang-value+cbor)
[
  "2014-10-26T12:16:31Z",       / current-datetime (SID 1723) /
  {
    +4 : "eth0",                / name (SID 1537) /
    +1 : "Ethernet adaptor",    / description (SID 1534) /
    +5 : 1880,                  / type (SID 1538), identity /
                                / ethernetCsmacd (SID 1880) /
    +2 : true                   / enabled (SID 1535) /
  }
]
</pre>
<h1 id="rfc.section.5.3">
<a href="#rfc.section.5.3">5.3.</a> <a href="#data-editing" id="data-editing">Data Editing</a>
</h1>
<p id="rfc.section.5.3.p.1">CoMI allows datastore contents to be created, modified and deleted using CoAP methods.</p>
<h1 id="rfc.section.5.3.1">
<a href="#rfc.section.5.3.1">5.3.1.</a> <a href="#DataOrdering" id="DataOrdering">Data Ordering</a>
</h1>
<p id="rfc.section.5.3.1.p.1">A CoMI server SHOULD preserve the relative order of all user-ordered list and leaf-list entries that are received in a single edit request.  These YANG data node types are encoded as CBOR arrays so messages will preserve their order.</p>
<h1 id="rfc.section.5.3.2">
<a href="#rfc.section.5.3.2">5.3.2.</a> <a href="#post-operation" id="post-operation">POST</a>
</h1>
<p id="rfc.section.5.3.2.p.1">The CoAP POST operation is used in CoMI for creation of data node resources and the invocation of &#8220;ACTION&#8221; and &#8220;RPC&#8221; resources.  Refer to <a href="#rpc" class="xref">Section 5.6</a> for details on &#8220;ACTION&#8221; and &#8220;RPC&#8221; resources.</p>
<p id="rfc.section.5.3.2.p.2">A request to create a data node resource is sent with a confirmable CoAP POST message.  The URI specifies the data node to be instantiated at the exception of list intances.  In this case, for compactness, the URI specifies the list for which an instance is created.</p>
<pre>
FORMAT:
  POST /c/&lt;instance identifier&gt;
  (Content-Format :application/yang-value+cbor)
  data-node-value

  2.01 Created
</pre>
<p id="rfc.section.5.3.2.p.3">If the data node resource already exists, then the POST request MUST fail and a &#8220;4.09 Conflict&#8221; response code MUST be returned</p>
<h1 id="rfc.section.5.3.2.1">
<a href="#rfc.section.5.3.2.1">5.3.2.1.</a> <a href="#post-example" id="post-example">Post example</a>
</h1>
<p id="rfc.section.5.3.2.1.p.1">The example uses the interface list from <a href="#ietf-system" class="xref">Appendix C.1</a>.  Example is creating a new list instance within the interface list (SID = 1533):</p>
<pre>
REQ: POST /c/X9 (Content-Format :application/yang-value+cbor)
{
  +4 : "eth5",              / name (SID 1537) /
  +1 : "Ethernet adaptor",  / description (SID 1534) /
  +5 : 1880,                / type (SID 1538), identity /
                            / ethernetCsmacd (SID 1880) /
  +2 : true                 / enabled (SID 1535) /
}


RES: 2.01 Created
</pre>
<h1 id="rfc.section.5.3.3">
<a href="#rfc.section.5.3.3">5.3.3.</a> <a href="#put-operation" id="put-operation">PUT</a>
</h1>
<p id="rfc.section.5.3.3.p.1">A data node resource instance is created or replaced with the PUT method.  A request to set the value of a data node instance is sent with a confirmable CoAP PUT message.</p>
<pre>
FORMAT:
  PUT /c/&lt;instanceidentifier&gt;
           (Content-Format :application/yang-value+cbor)
  data-node-value

  2.01 Created
</pre>
<h1 id="rfc.section.5.3.3.1">
<a href="#rfc.section.5.3.3.1">5.3.3.1.</a> <a href="#put-example" id="put-example">PUT example</a>
</h1>
<p id="rfc.section.5.3.3.1.p.1">The example uses the interface list from <a href="#ietf-system" class="xref">Appendix C.1</a>.  Example is renewing an instance of the list interface (SID = 1533) with key name=&#8221;eth0&#8221;:</p>
<pre>
REQ: PUT /c/X9?k="eth0"
(Content-Format :application/yang-value+cbor)
{
  +4 : "eth0",             / name (SID 1537) /
  +1 : "Ethernet adaptor", / description (SID 1534) /
  +5 : 1880,               / type (SID 1538), identity /
                           / ethernetCsmacd (SID 1880) /
  +2 : true                / enabled (SID 1535) /
}

RES:  2.04 Changed
</pre>
<h1 id="rfc.section.5.3.4">
<a href="#rfc.section.5.3.4">5.3.4.</a> <a href="#ipatch-operation" id="ipatch-operation">iPATCH</a>
</h1>
<p id="rfc.section.5.3.4.p.1">One or multiple data node instances are replaced with the idempotent iPATCH method <a href="#RFC8132" class="xref">[RFC8132]</a>. A request is sent with a confirmable CoAP iPATCH message.</p>
<p id="rfc.section.5.3.4.p.2">There are no Uri-Query options for the iPATCH method.</p>
<p id="rfc.section.5.3.4.p.3">The processing of the iPATCH command is specified by Content-Format application/yang-patch+cbor.  In summary, if the CBOR patch payload contains a data node instance that is not present in the target, this instance is added. If the target contains the specified instance, the content of this instance is replaced with the value of the payload.  A null value indicates the removal of an existing data node instance.</p>
<pre>
FORMAT:
  iPATCH /c (Content-Format :application/yang-patch+cbor)
  ordered map of instance-identifier, data-node-value

  2.04 Changed
</pre>
<h1 id="rfc.section.5.3.4.1">
<a href="#rfc.section.5.3.4.1">5.3.4.1.</a> <a href="#ipatch-example" id="ipatch-example">iPATCH example</a>
</h1>
<p id="rfc.section.5.3.4.1.p.1">In this example, a CoMI client requests the following operations:</p>
<p></p>

<ul>
<li>Set &#8220;/system/ntp/enabled&#8221; (SID 1755) to true.</li>
<li>Remove the server &#8220;tac.nrc.ca&#8221; from the&#8221;/system/ntp/server&#8221; (SID 1756) list.</li>
<li>Add the server &#8220;NTP Pool server 2&#8221; to the list &#8220;/system/ntp/server&#8221; (SID 1756).</li>
</ul>
<pre>
REQ: iPATCH /c (Content-Format :application/yang-patch+cbor)
[
  1751 , true,                          / enabled (1755) /
  [+1, "tac.nrc.ca"], null,             / server (SID 1756) /
  +0,                                   / server (SID 1756) /
    {
      +3 : "tic.nrc.ca",                / name (SID 1759) /
      +4 : true,                        / prefer (SID 1760) /
      +5 : {                            / udp (SID 1761) /
        +1 : "132.246.11.231"           / address (SID 1762) /
      }
    }
]

RES: 2.04 Changed
</pre>
<h1 id="rfc.section.5.3.5">
<a href="#rfc.section.5.3.5">5.3.5.</a> <a href="#delete-operation" id="delete-operation">DELETE</a>
</h1>
<p id="rfc.section.5.3.5.p.1">A data node resource is deleted with the DELETE method.</p>
<pre>
FORMAT:
  Delete /c/&lt;instance identifier&gt;

  2.02 Deleted
</pre>
<h1 id="rfc.section.5.3.5.1">
<a href="#rfc.section.5.3.5.1">5.3.5.1.</a> <a href="#delete-example" id="delete-example">DELETE example</a>
</h1>
<p id="rfc.section.5.3.5.1.p.1">The example uses the interface list from <a href="#interfaces" class="xref">Appendix C.3</a>.  Example is deleting an instance of the interface list (SID = 1533):</p>
<pre>
REQ:   DELETE /c/X9?k="eth0"

RES:   2.02 Deleted
</pre>
<h1 id="rfc.section.5.4">
<a href="#rfc.section.5.4">5.4.</a> <a href="#datastore-access" id="datastore-access">Full datastore access</a>
</h1>
<p id="rfc.section.5.4.p.1">The methods GET, PUT, POST, and DELETE can be used to request, replace, create, and delete a whole datastore respectively.</p>
<pre>
FORMAT:
  GET /c

  2.05 Content (Content-Format: application/yang-tree+cbor)
  ordered map of single-instance-identifier, data-node-value
</pre>
<pre>
FORMAT:
  PUT /c (Content-Format: application/yang-tree+cbor)
  ordered map of single-instance-identifier, data-node-value

  2.04 Changed
</pre>
<pre>
FORMAT:
  POST /c (Content-Format: application/yang-tree+cbor)
  ordered map of single-instance-identifier, data-node-value

  2.01 Created
</pre>
<pre>
FORMAT:
   DELETE /c

  2.02 Deleted
</pre>
<p id="rfc.section.5.4.p.2">The content of the ordered map represents the complete datastore of the server at the GET indication of after a successful processing of a PUT or POST request.  When an Ordered map is used to carry a whole datastore, all data nodes MUST be identified using single instance identifiers (i.e. a SID), list instance identifiers are not allowed.</p>
<h1 id="rfc.section.5.4.1">
<a href="#rfc.section.5.4.1">5.4.1.</a> <a href="#datastore-example" id="datastore-example">Full datastore examples</a>
</h1>
<p id="rfc.section.5.4.1.p.1">The example uses the interface list and the clock container from <a href="#interfaces" class="xref">Appendix C.3</a>.  Assume that the datastore contains two modules ietf-system (SID 1700) and ietf-interfaces (SID 1500); they contain the list interface (SID 1533) with one instance and the container Clock (SID 1721). After invocation of GET, a map with these two modules is returned:</p>
<pre>
REQ:  GET /c

RES: 2.05 Content (Content-Format :application/yang-tree+cbor)
[
  1721,                           / Clock (SID 1721) /
    {
      +2: "2016-10-26T12:16:31Z", / current-datetime (SID 1723) /
      +1: "2014-10-05T09:00:00Z"  / boot-datetime (SID 1722) /
    },
  -188,                            / clock (SID 1533) /
    {
      +4 : "eth0",                / name (SID 1537) /
      +1 : "Ethernet adaptor",    / description (SID 1534) /
      +5 : 1880,                  / type (SID 1538), identity: /
                                  / ethernetCsmacd (SID 1880) /
      +2 : true                   / enabled (SID 1535) /
    }
]
</pre>
<h1 id="rfc.section.5.5">
<a href="#rfc.section.5.5">5.5.</a> <a href="#event-stream" id="event-stream">Event stream</a>
</h1>
<p id="rfc.section.5.5.p.1">Event notification is an essential function for the management of servers.  CoMI allows notifications specified in YANG <a href="#RFC5277" class="xref">[RFC5277]</a> to be reported to a list of clients. The recommended path of the default event stream is /s.  The server MAY support additional event stream resources to address different notification needs.</p>
<p id="rfc.section.5.5.p.2">Reception of notification instances is enabled with the CoAP Observe <a href="#RFC7641" class="xref">[RFC7641]</a> function. Clients subscribe to the notifications by sending a GET request with an &#8220;Observe&#8221; option, specifying the /s resource when the default stream is selected.</p>
<p id="rfc.section.5.5.p.3">Each response payload carries one or multiple notifications. The number of notification reported and the conditions used to remove notifications from the reported list is left to the implementers.  When multiple notifications are reported, they MUST be ordered starting from the newest notification at index zero.</p>
<p id="rfc.section.5.5.p.4">An example implementation is:</p>
<p></p>

<ul class="empty"><li>Every time an event is generated, the generated notification instance is appended to the chosen stream(s). After appending the instance, the content of the instance is sent to all clients observing the modified stream.</li></ul>
<p></p>

<ul class="empty"><li>Dependending on the storage space allocated to the notification stream, the oldest notifications that do not fit inside the notification stream storage space are removed.</li></ul>
<pre>
FORMAT:
  Get /&lt;stream-resource&gt; Observe(0)

  2.05 Content (Content-Format :application/yang-tree+cbor)
  ordered map of instance-identifier, data-node-value
</pre>
<p id="rfc.section.5.5.p.7">The array of data node instances may contain identical entries which have been generated at different times.</p>
<h1 id="rfc.section.5.5.1">
<a href="#rfc.section.5.5.1">5.5.1.</a> <a href="#event-stream-example" id="event-stream-example">Notify Examples</a>
</h1>
<p id="rfc.section.5.5.1.p.1">Suppose the server generates the event specified in <a href="#notify-ex" class="xref">Appendix C.4</a>.  By executing a GET on the /s resource the client receives the following response:</p>
<pre>
REQ:  GET /s Observe(0) Token(0x93)

RES:  2.05 Content (Content-Format :application/yang-tree+cbor)
                        Observe(12) Token(0x93)
[
  60010,                  / example-port-fault (SID 60010) /
    {
      +1 : "0/4/21",      / port-name (SID 60011) /
      +2 : "Open pin 2"   / port-fault (SID 60012) /
    },
  +0,                     / example-port-fault (SID 60010) /
    {
      +1 : "1/4/21",      / port-name (SID 60011) /
      +2 : "Open pin 5"   / port-fault (SID 60012) /
    }
]

</pre>
<p id="rfc.section.5.5.1.p.2">In the example, the request returns a success response with the contents of the last two generated events. Consecutively the server will regularly notify the client when a new event is generated.</p>
<p id="rfc.section.5.5.1.p.3">To check that the client is still alive, the server MUST send confirmable notifications periodically. When the client does not confirm the notification from the server, the server will remove the client from the list of observers <a href="#RFC7641" class="xref">[RFC7641]</a>.</p>
<h1 id="rfc.section.5.6">
<a href="#rfc.section.5.6">5.6.</a> <a href="#rpc" id="rpc">RPC statements</a>
</h1>
<p id="rfc.section.5.6.p.1">The YANG &#8220;action&#8221; and &#8220;RPC&#8221; statements specify the execution of a Remote procedure Call (RPC) in the server.  It is invoked using a POST method to an &#8220;Action&#8221; or &#8220;RPC&#8221; resource instance. The request payload contains the values assigned to the input container when specified. The response payload contains the values of the output container when specified. Both the input and output containers are encoded in CBOR using the rules defined in <a href="#I-D.ietf-core-yang-cbor" class="xref">[I-D.ietf-core-yang-cbor]</a> section 4.2.1. Root data nodes are encoded using the delta between the current SID and the SID of the invoked instance identifier a specified by the URI.</p>
<p id="rfc.section.5.6.p.2">The returned success response code is 2.05 Content.</p>
<pre>
FORMAT:
  POST /c/&lt;instance identifier&gt;
           (Content-Format :application/yang-value+cbor)
  data-node-value

  2.05 Content (Content-Format :application/yang-value+cbor)
  data-node-value

</pre>
<h1 id="rfc.section.5.6.1">
<a href="#rfc.section.5.6.1">5.6.1.</a> <a href="#rpc-example" id="rpc-example">RPC Example</a>
</h1>
<p id="rfc.section.5.6.1.p.1">The example is based on the YANG action specification of <a href="#server" class="xref">Appendix C.2</a>.  A server list is specified and the action &#8220;reset&#8221; (SID 60002, base64: Opq), that is part of a &#8220;server instance&#8221; with key value &#8220;myserver&#8221;, is invoked.</p>
<pre>
REQ:  POST /c/Opq?k="myserver"
              (Content-Format :application/yang-value+cbor)
{
  +1 : "2016-02-08T14:10:08Z09:00" / reset-at (SID 60003) /
}

RES:  2.05 Content (Content-Format :application/yang-value+cbor)
{
  +2 : "2016-02-08T14:10:08Z09:18" / reset-finished-at (SID 60004)/
}
</pre>
<h1 id="rfc.section.6">
<a href="#rfc.section.6">6.</a> <a href="#mib" id="mib">Access to MIB Data</a>
</h1>
<p><a href="#smi" class="xref">Appendix C.5</a> shows a YANG module mapped from the SMI specification &#8220;IP-MIB&#8221; <a href="#RFC4293" class="xref">[RFC4293]</a>.  The following example shows the &#8220;ipNetToPhysicalEntry&#8221; list with 2 instances, using diagnostic notation without delta encoding.</p>
<pre>
{
   60021 :                     / list ipNetToPhysicalEntry /
   [
     {
       60022 : 1,              / ipNetToPhysicalIfIndex /
       60023 : 1,              / ipNetToPhysicalNetAddressType /
       60024 : h'0A000033',    / ipNetToPhysicalNetAddress /
       60025 : h'00000A01172D',/ ipNetToPhysicalPhysAddress /
       60026 : 2333943,        / ipNetToPhysicalLastUpdated /
       60027 : 4,              / ipNetToPhysicalType /
       60028 : 1,              / ipNetToPhysicalState /
       60029 : 1               / ipNetToPhysicalRowStatus /
     },
     {
       60022 : 1,              / ipNetToPhysicalIfIndex /
       60023 : 1,              / ipNetToPhysicalNetAddressType /
       60024 : h'09020304',    / ipNetToPhysicalNetAddress  /
       60025 : h'00000A36200A',/ ipNetToPhysicalPhysAddress /
       60026 : 2329836,        / ipNetToPhysicalLastUpdated /
       60027 : 3,              / ipNetToPhysicalType /
       60028 : 6,              / ipNetToPhysicalState /
       60029 : 1               / ipNetToPhysicalRowStatus /
     }
   ]
}
</pre>
<p id="rfc.section.6.p.2">In this example one instance of /ip/ipNetToPhysicalEntry (SID 60021, base64: Oz1) that matches the keys ipNetToPhysicalIfIndex = 1, ipNetToPhysicalNetAddressType = ipv4 and ipNetToPhysicalNetAddress = 9.2.3.4 (h&#8217;09020304&#8217;, base64: CQIDBA) is requested.</p>
<pre>
REQ: GET example.com/c/Oz1?k="1,1,CQIDBA"

RES: 2.05 Content (Content-Format: application/yang-value+cbor)
{
  +1 : 1,                  / ( SID 60022 ) /
  +2 : 1,                  / ( SID 60023 ) /
  +3 : h'09020304',        / ( SID 60024 ) /
  +4 : h'00000A36200A',    / ( SID 60025 ) /
  +5 : 2329836,            / ( SID 60026 ) /
  +6 : 3,                  / ( SID 60027 ) /
  +7 : 6,                  / ( SID 60028 ) /
  +8 : 1                   / ( SID 60029 ) /
}
</pre>
<h1 id="rfc.section.7">
<a href="#rfc.section.7">7.</a> <a href="#block" id="block">Use of Block</a>
</h1>
<p id="rfc.section.7.p.1">The CoAP protocol provides reliability by acknowledging the UDP datagrams.  However, when large pieces of data need to be transported, datagrams get fragmented, thus creating constraints on the resources in the client, server and intermediate routers. The block option <a href="#RFC7959" class="xref">[RFC7959]</a> allows the transport of the total payload in individual blocks of which the size can be adapted to the underlying transport sizes such as: (UDP datagram size ~64KiB, IPv6 MTU of 1280, IEEE 802.15.4 payload of 60-80 bytes). Each block is individually acknowledged to guarantee reliability.</p>
<p id="rfc.section.7.p.2">Notice that the Block mechanism splits the data at fixed positions, such that individual data fields may become fragmented. Therefore, assembly of multiple blocks may be required to process the complete data field.</p>
<p id="rfc.section.7.p.3">Beware of race conditions. Blocks are filled one at a time and care should be taken that the whole data representation is sent in multiple blocks sequentially without interruption. On the server, values are changed, lists are re-ordered, extended or reduced. When these actions happen during the serialization of the contents of the resource, the transported results do not correspond with a state having occurred in the server; or worse the returned values are inconsistent.  For example: array length does not correspond with the actual number of items.  It may be advisable to use CBOR maps or CBOR arrays of undefined length, which are foreseen for data streaming purposes.</p>
<h1 id="rfc.section.8">
<a href="#rfc.section.8">8.</a> <a href="#discovery" id="discovery">Resource Discovery</a>
</h1>
<p id="rfc.section.8.p.1">The presence and location of (path to) the management data are discovered by sending a GET request to &#8220;/.well-known/core&#8221; including a resource type (RT) parameter with the value &#8220;core.c.datastore&#8221; <a href="#RFC6690" class="xref">[RFC6690]</a>.  Upon success, the return payload will contain the root resource of the management data. It is up to the implementation to choose its root resource, the value &#8220;/c&#8221; is used as an example. The example below shows the discovery of the presence and location of management data.</p>
<pre>
REQ: GET /.well-known/core?rt=core.c.datastore

RES: 2.05 Content
&lt;/c&gt;; rt="core.c.datastore"
</pre>
<p id="rfc.section.8.p.2">Implemented data nodes MAY be discovered using the standard CoAP resource discovery.  The implementation can add the data node identifiers (SID) supported to /.well-known/core with rt=&#8221;core.c.datanode&#8221;. The available SIDs can be discovered by sending a GET request to &#8220;/.well-known/core&#8221; including a resource type (rt) parameter with the value &#8220;core.c.datanode&#8221;. Upon success, the return payload will contain the registered SIDs and their location.</p>
<p id="rfc.section.8.p.3">The example below shows the discovery of the presence and location of data nodes.</p>
<pre>
REQ: GET /.well-known/core?rt=core.c.datanode

RES: 2.05 Content
&lt;/c/BaAiN&gt;; rt="core.c.datanode",
&lt;/c/CF_fA&gt;; rt="core.c.datanode"

</pre>
<p id="rfc.section.8.p.4">The list of data nodes may become prohibitively long. Therefore, it is recommended to discover the details about the YANG modules implemented by reading a YANG module library (e.g. &#8220;ietf-comi-yang-library&#8221; ad defined by <a href="#I-D.veillette-core-yang-library" class="xref">[I-D.veillette-core-yang-library]</a>).</p>
<p id="rfc.section.8.p.5">The resource &#8220;/mod.uri&#8221; is used to retrieve the location of the YANG module library.  This library can be stored locally on each server, or remotely on a different server. The latter is advised when the deployment of many servers are identical.</p>
<p id="rfc.section.8.p.6">The following example shows the URI of a local instance of container modules-state (SID=1802) as defined in <a href="#I-D.veillette-core-yang-library" class="xref">[I-D.veillette-core-yang-library]</a>.</p>
<pre>
REQ: GET example.com/mod.uri

RES: 2.05 Content (Content-Format: text/plain; charset=utf-8)
example.com/c/cK
</pre>
<p id="rfc.section.8.p.7">The following example shows the URI of a remote instance of same container.</p>
<pre>
REQ: GET example.com/mod.uri

RES: 2.05 Content (Content-Format: text/plain; charset=utf-8)
example-remote-server.com/group17/cK
</pre>
<p id="rfc.section.8.p.8">Within the YANG module library all information about the module is stored such as: module identifier, identifier hierarchy, grouping, features and revision numbers.</p>
<h1 id="rfc.section.9">
<a href="#rfc.section.9">9.</a> <a href="#error-handling" id="error-handling">Error Handling</a>
</h1>
<p id="rfc.section.9.p.1">In case a request is received which cannot be processed properly, the CoMI server MUST return an error message. This error message MUST contain a CoAP 4.xx or 5.xx response code.</p>
<p id="rfc.section.9.p.2">Errors returned by a CoMI server can be broken into two categories, those associated to the CoAP protocol itself and those generated during the validation of the YANG data model constrains as described in <a href="#RFC7950" class="xref">[RFC7950]</a> section 8.</p>
<p id="rfc.section.9.p.3">The following list of common CoAP errors should be implemented by CoMI servers. This list is not exhaustive, other errors defined by CoAP and associated RFCs may be applicable.</p>
<p></p>

<ul>
<li>Error 4.01 (Unauthorized) is returned by the CoMI server when the CoMI client is not authorized to perform the requested action on the targeted resource (i.e. data node, datastore, rpc, action or event stream).</li>
<li>Error 4.02 (Bad Option) is returned by the CoMI server when one or more CoAP options are unknown or malformed.</li>
<li>Error 4.04 (Not Found) is returned by the CoMI server when the CoMI client is requesting a non-instantiated resource (i.e. data node, datastore, rpc, action or event stream).</li>
<li>Error 4.05 (Method Not Allowed) is returned by the CoMI server when the CoMI client is requesting a method not supported on the targeted resource. (e.g. GET on an rpc, PUT or POST on a data node with &#8220;config&#8221; set to false).</li>
<li>Error 4.08 (Request Entity Incomplete) is returned by the CoMI server if one or multiple blocks of a block transfer request is missing, see <a href="#RFC7959" class="xref">[RFC7959]</a> for more details.</li>
<li>Error 4.13 (Request Entity Too Large) may be returned by the CoMI server during a block transfer request, see <a href="#RFC7959" class="xref">[RFC7959]</a> for more details.</li>
<li>Error 4.15 (Unsupported Content-Format) is returned by the CoMI server when the Content-Format used in the request don&#8217;t match those specified in section 2.3.</li>
</ul>
<p id="rfc.section.9.p.5">CoMI server MUST also enforce the different constraints associated to the YANG data models implemented. These constraints are described in <a href="#RFC7950" class="xref">[RFC7950]</a> section 8. These errors are reported using the CoAP error code 4.00 (Bad Request) and may have the following error container as payload. The YANG definition and associated .sid file are available in <a href="#ietf-comi-yang" class="xref">Appendix A</a> and <a href="#ietf-comi-sid" class="xref">Appendix B</a>. The error container is encoded using delta value equal to the SID of the current schema node minus the SID of the parent container (i.e 1024).</p>
<pre>
+--rw error!
   +--rw error-tag             identityref
   +--rw error-app-tag?        identityref
   +--rw error-data-node?      instance-identifier
   +--rw error-message?        string
</pre>
<p id="rfc.section.9.p.6">The following error-tag and error-app-tag are defined by the ietf-comi YANG module, these tags are implemented as YANG identity and can be extended as needed.</p>
<p></p>

<ul>
<li>error-tag operation-failed is returned by the CoMI server when the operation request cannot be processed successfully.  <ul>
<li>error-app-tag malformed-message is returned by the CoMI server when the payload received from the CoMI client don&#8217;t contain a well-formed CBOR content as defined in <a href="#RFC7049" class="xref">[RFC7049]</a> section 3.3 or don&#8217;t comply with the CBOR structure defined within this document.</li>
<li>error-app-tag data-not-unique is returned by the CoMI server when the validation of the &#8216;unique&#8217; constraint of a list or leaf-list fails.</li>
<li>error-app-tag too-many-elements is returned by the CoMI server when the validation of the &#8216;max-elements&#8217; constraint of a list or leaf-list fails.</li>
<li>error-app-tag too-few-elements is returned by the CoMI server when the validation of the &#8216;min-elements&#8217; constraint of a list or leaf-list fails.</li>
<li>error-app-tag must-violation is returned by the CoMI server when the restrictions imposed by a &#8216;must&#8217; statement are violated.</li>
<li>error-app-tag duplicate is returned by the CoMI server when a client tries to create a duplicate list or leaf-list entry.</li>
</ul>
</li>
<li>error-tag invalid-value is returned by the CoMI server when the CoMI client tries to update or create a leaf with a value encoded using an invalid CBOR datatype or if the &#8216;range&#8217;, &#8216;length&#8217;, &#8216;pattern&#8217; or &#8216;require-instance&#8217; constrain is not fulfilled.  <ul>
<li>error-app-tag invalid-datatype is returned by the CoMI server when CBOR encoding don&#8217;t follow the rules set by or when the value is incompatible with the YANG Built-In type. (e.g. a value greater than 127 for an int8, undefined enumeration)</li>
<li>error-app-tag not-in-range is returned by the CoMI server when the validation of the &#8216;range&#8217; property fails.</li>
<li>error-app-tag invalid-length is returned by the CoMI server when the validation of the &#8216;length&#8217; property fails.</li>
<li>error-app-tag pattern-test-failed is returned by the CoMI server when the validation of the &#8216;pattern&#8217; property fails.</li>
</ul>
</li>
<li>error-tag missing-element is returned by the CoMI server when the operation requested by a CoMI client fail to comply with the &#8216;mandatory&#8217; constraint defined. The &#8216;mandatory&#8217; constraint is enforced for leafs and choices, unless the node or any of its ancestors have a &#8216;when&#8217; condition or &#8216;if-feature&#8217; expression that evaluates to &#8216;false&#8217;.  <ul>
<li>error-app-tag missing-key is returned by the CoMI server to further qualify an missing-element error. This error is returned when the CoMI client  tries to create or list instance, without all the &#8216;key&#8217; specified or when the CoMI client  tries to delete a leaf listed as a &#8216;key&#8217;.</li>
<li>error-app-tag missing-input-parameter is returned by the CoMI server when the input parameters of an RPC or action are incomplete.</li>
</ul>
</li>
<li>error-tag unknown-element is returned by the CoMI server when the CoMI client  tries to access a data node of a YANG module not supported, of a data node associated to an &#8216;if-feature&#8217; expression evaluated to &#8216;false&#8217; or to a &#8216;when&#8217; condition evaluated to &#8216;false&#8217;.</li>
<li>error-tag bad-element is returned by the CoMI server when the CoMI client  tries to create data nodes for more than one case in a choice.</li>
<li>error-tag data-missing is returned by the CoMI server when a data node required to accept the request is not present.  <ul>
<li>error-app-tag instance-required is returned by the CoMI server when a leaf of type &#8216;instance-identifier&#8217; or &#8216;leafref&#8217; marked with require-instance set to &#8216;true&#8217; refers to an instance that does not exist.</li>
<li>error-app-tag missing-choice is returned by the CoMI server when no nodes exist in a mandatory choice.</li>
</ul>
</li>
<li>error-tag error is returned by the CoMI server when an unspecified error has occurred.</li>
</ul>
<p id="rfc.section.9.p.8">For example, the CoMI server might return the following error.</p>
<pre>
RES:  4.00 Bad Request (Content-Format :application/yang-value+cbor)
{
  +4 : 1011,       / error-tag (SID 1028) /
                   /   = invalid-value (SID 1011) /
  +1 : 1018,       / error-app-tag (SID 1025) /
                   /   = not-in-range (SID 1018) /
  +2 : 1740,       / error-data-node (SID 1026) /
                   /   = timezone-utc-offset (SID 1740) /
  +3 : "maximum value exceeded" / error-message (SID 1027) /
}
</pre>
<h1 id="rfc.section.10">
<a href="#rfc.section.10">10.</a> <a href="#security-considerations" id="security-considerations">Security Considerations</a>
</h1>
<p id="rfc.section.10.p.1">For secure network management, it is important to restrict access to configuration variables only to authorized parties. LwM2M re-uses the security mechanisms already available to CoAP, this includes DTLS <a href="#RFC6347" class="xref">[RFC6347]</a> for protected access to resources, as well suitable authentication and authorization mechanisms.</p>
<p id="rfc.section.10.p.2">The LwM2M protocol supports various transport bindings and credentials for securely communicating with LwM2M Servers. This configuration information can be provisioned during manufacturing or through the use of the bootstrap mechanism.</p>
<p id="rfc.section.10.p.3">LwM2M supports three different types of credentials, namely</p>
<p></p>

<ul>
<li>Certificates.</li>
<li>Raw public keys.</li>
<li>Pre-shared secrets.</li>
</ul>
<p id="rfc.section.10.p.5">Since these credential types offer different properties the LwM2M specification offers support for all of them. <a href="#RFC7925" class="xref">[RFC7925]</a> provides the necessary details about the use of each of these credentials with DTLS.</p>
<p id="rfc.section.10.p.6">The LwM2M protocol specifies that authorization of LwM2M Servers to access Object Instances and Resources within the LwM2M Client is provided through Access Control Object Instances within the LwM2M Client.</p>
<h1 id="rfc.section.10.1">
<a href="#rfc.section.10.1">10.1.</a> <a href="#dtls-security" id="dtls-security">DTLS Security</a>
</h1>
<p><strong>Requirements</strong></p>
<p id="rfc.section.10.1.p.2">For authentication of communicating LwM2M entities, the LwM2M protocol requires that all communication between LwM2M Clients and LwM2M Servers as well as LwM2M Clients and LwM2M Bootstrap-Servers are authenticated using mutual authentication. This means that a:</p>
<p></p>

<ul>
<li>LwM2M Client MUST authenticate a LwM2M Server prior to exchange of any information.</li>
<li>LwM2M Server MUST authenticate a LwM2M Client prior to exchange of any information.</li>
<li>LwM2M Client MUST authenticate a LwM2M Bootstrap-Server prior to exchange of any information.</li>
<li>LwM2M Bootstrap-Server MUST authenticate a LwM2M Client prior to exchange of any information.</li>
</ul>
<p id="rfc.section.10.1.p.4">For confidentiality and data integrity of information between communicating LwM2M entities, the LwM2M protocol requires that all communication between LwM2M Clients and LwM2M Servers as well as LwM2M Clients and LwM2M Bootstrap-Servers are encrypted and integrity protected. This means that a:</p>
<p></p>

<ul>
<li>LwM2M Client MUST encrypt and integrity protect data communicated to a LwM2M Server.</li>
<li>LwM2M Server MUST encrypt and integrity protect data communicated to a LwM2M Client.</li>
<li>LwM2M Client MUST encrypt and integrity protect data communicated to a LwM2M Bootstrap-Server.</li>
<li>LwM2M Bootstrap-Server MUST encrypt and integrity protect data communicated to a LwM2M Client.</li>
</ul>
<p id="rfc.section.10.1.p.6">Due the sensitive nature of bootstrap information, a particular care has to be taken to ensure protection of that data.</p>
<p id="rfc.section.10.1.p.7">The use of DTLS fulfils these requirements.</p>
<h1 id="rfc.section.10.1.1">
<a href="#rfc.section.10.1.1">10.1.1.</a> <a href="#dtls-overview" id="dtls-overview">DTLS Overview</a>
</h1>
<p id="rfc.section.10.1.1.p.1">CoAP <a href="#RFC7252" class="xref">[RFC7252]</a> is secured using the Datagram Transport Layer Security (DTLS) 1.2 protocol <a href="#RFC6347" class="xref">[RFC6347]</a>, which is based on TLS v1.2 <a href="#RFC5246" class="xref">[RFC5246]</a>. The DTLS binding for CoAP is defined in Section 9 of <a href="#RFC7252" class="xref">[RFC7252]</a>. DTLS is a communication security solution for datagram based protocols (such as UDP). It provides a secure handshake with session key generation, mutual authentication, data integrity and confidentiality.</p>
<p id="rfc.section.10.1.1.p.2">This section provides information related to the use of DTLS for use with CoAP over DTLS over UDP as well as for use with CoAP over DTLS over SMS. Section &#8220;SMS Channel Security&#8221; provides additional information regarding the use of DTLS in an SMS context. This document uses the profiles defined in <a href="#RFC7925" class="xref">[RFC7925]</a>, which includes not only ciphersuites but also extensions.</p>
<p id="rfc.section.10.1.1.p.3">The DTLS client and the DTLS server SHOULD keep security state, such as session keys, sequence numbers, and initialization vectors, and other security parameters, established with DTLS for as long a period as can be safely achieved without risking compromise to the security context. If such state persists across sleep cycles where the RAM is powered off, secure storage SHOULD be used for the security context.</p>
<p id="rfc.section.10.1.1.p.4">The credentials used for authenticating the DTLS client and the DTLS server to secure the communication between the LwM2M Client and the LwM2M Server are obtained using one of the bootstrap modes defined in Section 5.2.2. Appendix E.1.1 of (TODO add Link to LWM2M-CORE) defines the format of the keying material stored in the LwM2M Security Object Instances.</p>
<p id="rfc.section.10.1.1.p.5">LwM2M Bootstrap-Servers, LwM2M Servers and LwM2M Clients MUST use different key pairs. LwM2M Clients MUST use keys, which are unique to each LwM2M Client. When a LwM2M Client is configured to utilize multiple LwM2M Servers then the LwM2M Bootstrap-Server may configure different credentials with these LwM2Ms Servers. Such configuration provides better unlinkability properties since each individual LwM2M Server cannot correlate request based on the credentials used by the LwM2M Client. Deployment and application specific considerations dictate what approach to use.</p>
<p><strong>DTLS Overview</strong></p>
<h1 id="rfc.section.11">
<a href="#rfc.section.11">11.</a> <a href="#iana-considerations" id="iana-considerations">IANA Considerations</a>
</h1>
<h1 id="rfc.section.11.1">
<a href="#rfc.section.11.1">11.1.</a> <a href="#resource-type-rt-link-target-attribute-values-registry" id="resource-type-rt-link-target-attribute-values-registry">Resource Type (rt=) Link Target Attribute Values Registry</a>
</h1>
<p id="rfc.section.11.1.p.1">This document adds the following resource type to the &#8220;Resource Type (rt=) Link Target Attribute Values&#8221;, within the &#8220;Constrained RESTful Environments (CoRE) Parameters&#8221; registry.</p>
<table cellpadding="3" cellspacing="0" class="tt full left">
<thead><tr>
<th class="left">Value</th>
<th class="left">Description</th>
<th class="left">Reference</th>
</tr></thead>
<tbody>
<tr>
<td class="left">core.c.datastore</td>
<td class="left">YANG datastore</td>
<td class="left">RFC XXXX</td>
</tr>
<tr>
<td class="left">core.c.datanode</td>
<td class="left">YANG data node</td>
<td class="left">RFC XXXX</td>
</tr>
<tr>
<td class="left">core.c.liburi</td>
<td class="left">YANG module library</td>
<td class="left">RFC XXXX</td>
</tr>
<tr>
<td class="left">core.c.eventstream</td>
<td class="left">YANG event stream</td>
<td class="left">RFC XXXX</td>
</tr>
</tbody>
</table>
<p id="rfc.section.11.1.p.2">// RFC Ed.: replace RFC XXXX with this RFC number and remove this note.</p>
<h1 id="rfc.section.11.2">
<a href="#rfc.section.11.2">11.2.</a> <a href="#coap-content-formats-registry" id="coap-content-formats-registry">CoAP Content-Formats Registry</a>
</h1>
<p id="rfc.section.11.2.p.1">This document adds the following Content-Format to the &#8220;CoAP Content-Formats&#8221;, within the &#8220;Constrained RESTful Environments (CoRE) Parameters&#8221; registry.</p>
<table cellpadding="3" cellspacing="0" class="tt full left">
<thead><tr>
<th class="left">Media Type</th>
<th class="left">Excoding ID</th>
<th class="left">Reference</th>
</tr></thead>
<tbody>
<tr>
<td class="left">application/yang-value+cbor</td>
<td class="left">XXX</td>
<td class="left">RFC XXXX</td>
</tr>
<tr>
<td class="left">application/yang-values+cbor</td>
<td class="left">XXX</td>
<td class="left">RFC XXXX</td>
</tr>
<tr>
<td class="left">application/yang-selectors+cbor</td>
<td class="left">XXX</td>
<td class="left">RFC XXXX</td>
</tr>
<tr>
<td class="left">application/yang-tree+cbor</td>
<td class="left">XXX</td>
<td class="left">RFC XXXX</td>
</tr>
<tr>
<td class="left">application/yang-ipatch+cbor</td>
<td class="left">XXX</td>
<td class="left">RFC XXXX</td>
</tr>
</tbody>
</table>
<p id="rfc.section.11.2.p.2">// RFC Ed.: replace XXX with assigned IDs and remove this note.  // RFC Ed.: replace RFC XXXX with this RFC number and remove this note.</p>
<h1 id="rfc.section.11.3">
<a href="#rfc.section.11.3">11.3.</a> <a href="#media-types-registry" id="media-types-registry">Media Types Registry</a>
</h1>
<p id="rfc.section.11.3.p.1">This document adds the following media types to the &#8220;Media Types&#8221; registry.</p>
<table cellpadding="3" cellspacing="0" class="tt full left">
<thead><tr>
<th class="left">Name</th>
<th class="left">Template</th>
<th class="left">Reference</th>
</tr></thead>
<tbody>
<tr>
<td class="left">yang-value+cbor</td>
<td class="left">application/yang-value+cbor</td>
<td class="left">RFC XXXX</td>
</tr>
<tr>
<td class="left">yang-values+cbor</td>
<td class="left">application/yang-values+cbor</td>
<td class="left">RFC XXXX</td>
</tr>
<tr>
<td class="left">yang-selectors+cbor</td>
<td class="left">application/yang-selectors+cbor</td>
<td class="left">RFC XXXX</td>
</tr>
<tr>
<td class="left">yang-tree+cbor</td>
<td class="left">application/yang-tree+cbor</td>
<td class="left">RFC XXXX</td>
</tr>
<tr>
<td class="left">yang-ipatch+cbor</td>
<td class="left">application/yang-ipatch+cbor</td>
<td class="left">RFC XXXX</td>
</tr>
</tbody>
</table>
<p id="rfc.section.11.3.p.2">Each of these media types share the following information:</p>
<p></p>

<ul>
<li>Subtype name: &lt;as listed in table&gt;</li>
<li>Required parameters: N/A</li>
<li>Optional parameters: N/A</li>
<li>Encoding considerations: binary</li>
<li>Security considerations: See the Security Considerations section of RFC XXXX</li>
<li>Interoperability considerations: N/A</li>
<li>Published specification: RFC XXXX</li>
<li>Applications that use this media type: CoMI</li>
<li>Fragment identifier considerations: N/A</li>
<li>Additional information:</li>
</ul>
<pre>
*  Deprecated alias names for this type: N/A

*  Magic number(s): N/A

*  File extension(s): N/A

*  Macintosh file type code(s): N/A
</pre>
<p></p>

<ul>
<li>Person &amp; email address to contact for further information: iesg&amp;ietf.org</li>
<li>Intended usage: COMMON</li>
<li>Restrictions on usage: N/A</li>
<li>Author: Michel Veillette, ietf&amp;augustcellars.com</li>
<li>Change Controller: IESG</li>
<li>Provisional registration?  No</li>
</ul>
<p id="rfc.section.11.3.p.5">// RFC Ed.: replace RFC XXXX with this RFC number and remove this note.</p>
<h1 id="rfc.section.11.4">
<a href="#rfc.section.11.4">11.4.</a> <a href="#tags-registry" id="tags-registry">Concise Binary Object Representation (CBOR) Tags Registry</a>
</h1>
<p id="rfc.section.11.4.p.1">This document adds the following tags to the &#8220;Concise Binary Object Representation (CBOR) Tags&#8221;  registry.</p>
<table cellpadding="3" cellspacing="0" class="tt full left">
<thead><tr>
<th class="left">Tag</th>
<th class="left">Data Item</th>
<th class="left">Semantics</th>
<th class="left">Reference</th>
</tr></thead>
<tbody><tr>
<td class="left">xxx</td>
<td class="left">array</td>
<td class="left">Oedered map</td>
<td class="left">RFC XXXX</td>
</tr></tbody>
</table>
<p id="rfc.section.11.4.p.2">// RFC Ed.: replace xxx by the assigned Tag and remove this note.  // RFC Ed.: replace RFC XXXX with this RFC number and remove this note.</p>
<h1 id="rfc.section.12">
<a href="#rfc.section.12">12.</a> <a href="#acknowledgements" id="acknowledgements">Acknowledgements</a>
</h1>
<p id="rfc.section.12.p.1">We are very grateful to Bert Greevenbosch who was one of the original authors of the CoMI specification and specified CBOR encoding and use of hashes.</p>
<p id="rfc.section.12.p.2">Mehmet Ersue and Bert Wijnen explained the encoding aspects of PDUs transported under SNMP. Carsten Bormann has given feedback on the use of CBOR.</p>
<p id="rfc.section.12.p.3">The draft has benefited from comments (alphabetical order) by Rodney Cummings, Dee Denteneer, Esko Dijk, Michael van Hartskamp, Tanguy Ropitault, Juergen Schoenwaelder, Anuj Sehgal, Zach Shelby, Hannes Tschofenig, Michael Verschoor, and Thomas Watteyne.</p>
<h1 id="rfc.references">
<a href="#rfc.references">13.</a> References</h1>
<h1 id="rfc.references.1">
<a href="#rfc.references.1">13.1.</a> Normative References</h1>
<table><tbody>
<tr>
<td class="reference"><b id="I-D.ietf-core-sid">[I-D.ietf-core-sid]</b></td>
<td class="top">
<a>Veillette, M.</a> and <a>A. Pelov</a>, "<a href="https://tools.ietf.org/html/draft-ietf-core-sid-03">YANG Schema Item iDentifier (SID)</a>", Internet-Draft draft-ietf-core-sid-03, December 2017.</td>
</tr>
<tr>
<td class="reference"><b id="I-D.ietf-core-yang-cbor">[I-D.ietf-core-yang-cbor]</b></td>
<td class="top">
<a>Veillette, M.</a>, <a>Pelov, A.</a>, <a>Somaraju, A.</a>, <a>Turner, R.</a> and <a>A. Minaburo</a>, "<a href="https://tools.ietf.org/html/draft-ietf-core-yang-cbor-05">CBOR Encoding of Data Modeled with YANG</a>", Internet-Draft draft-ietf-core-yang-cbor-05, August 2017.</td>
</tr>
<tr>
<td class="reference"><b id="I-D.veillette-core-yang-library">[I-D.veillette-core-yang-library]</b></td>
<td class="top">
<a>Veillette, M.</a>, "<a href="https://tools.ietf.org/html/draft-veillette-core-yang-library-01">Constrained YANG Module Library</a>", Internet-Draft draft-veillette-core-yang-library-01, July 2017.</td>
</tr>
<tr>
<td class="reference"><b id="RFC2119">[RFC2119]</b></td>
<td class="top">
<a>Bradner, S.</a>, "<a href="https://tools.ietf.org/html/rfc2119">Key words for use in RFCs to Indicate Requirement Levels</a>", BCP 14, RFC 2119, DOI 10.17487/RFC2119, March 1997.</td>
</tr>
<tr>
<td class="reference"><b id="RFC4648">[RFC4648]</b></td>
<td class="top">
<a>Josefsson, S.</a>, "<a href="https://tools.ietf.org/html/rfc4648">The Base16, Base32, and Base64 Data Encodings</a>", RFC 4648, DOI 10.17487/RFC4648, October 2006.</td>
</tr>
<tr>
<td class="reference"><b id="RFC5246">[RFC5246]</b></td>
<td class="top">
<a>Dierks, T.</a> and <a>E. Rescorla</a>, "<a href="https://tools.ietf.org/html/rfc5246">The Transport Layer Security (TLS) Protocol Version 1.2</a>", RFC 5246, DOI 10.17487/RFC5246, August 2008.</td>
</tr>
<tr>
<td class="reference"><b id="RFC5277">[RFC5277]</b></td>
<td class="top">
<a>Chisholm, S.</a> and <a>H. Trevino</a>, "<a href="https://tools.ietf.org/html/rfc5277">NETCONF Event Notifications</a>", RFC 5277, DOI 10.17487/RFC5277, July 2008.</td>
</tr>
<tr>
<td class="reference"><b id="RFC6243">[RFC6243]</b></td>
<td class="top">
<a>Bierman, A.</a> and <a>B. Lengyel</a>, "<a href="https://tools.ietf.org/html/rfc6243">With-defaults Capability for NETCONF</a>", RFC 6243, DOI 10.17487/RFC6243, June 2011.</td>
</tr>
<tr>
<td class="reference"><b id="RFC7049">[RFC7049]</b></td>
<td class="top">
<a>Bormann, C.</a> and <a>P. Hoffman</a>, "<a href="https://tools.ietf.org/html/rfc7049">Concise Binary Object Representation (CBOR)</a>", RFC 7049, DOI 10.17487/RFC7049, October 2013.</td>
</tr>
<tr>
<td class="reference"><b id="RFC7252">[RFC7252]</b></td>
<td class="top">
<a>Shelby, Z.</a>, <a>Hartke, K.</a> and <a>C. Bormann</a>, "<a href="https://tools.ietf.org/html/rfc7252">The Constrained Application Protocol (CoAP)</a>", RFC 7252, DOI 10.17487/RFC7252, June 2014.</td>
</tr>
<tr>
<td class="reference"><b id="RFC7641">[RFC7641]</b></td>
<td class="top">
<a>Hartke, K.</a>, "<a href="https://tools.ietf.org/html/rfc7641">Observing Resources in the Constrained Application Protocol (CoAP)</a>", RFC 7641, DOI 10.17487/RFC7641, September 2015.</td>
</tr>
<tr>
<td class="reference"><b id="RFC7950">[RFC7950]</b></td>
<td class="top">
<a>Bjorklund, M.</a>, "<a href="https://tools.ietf.org/html/rfc7950">The YANG 1.1 Data Modeling Language</a>", RFC 7950, DOI 10.17487/RFC7950, August 2016.</td>
</tr>
<tr>
<td class="reference"><b id="RFC7959">[RFC7959]</b></td>
<td class="top">
<a>Bormann, C.</a> and <a>Z. Shelby</a>, "<a href="https://tools.ietf.org/html/rfc7959">Block-Wise Transfers in the Constrained Application Protocol (CoAP)</a>", RFC 7959, DOI 10.17487/RFC7959, August 2016.</td>
</tr>
<tr>
<td class="reference"><b id="RFC8040">[RFC8040]</b></td>
<td class="top">
<a>Bierman, A.</a>, <a>Bjorklund, M.</a> and <a>K. Watsen</a>, "<a href="https://tools.ietf.org/html/rfc8040">RESTCONF Protocol</a>", RFC 8040, DOI 10.17487/RFC8040, January 2017.</td>
</tr>
<tr>
<td class="reference"><b id="RFC8132">[RFC8132]</b></td>
<td class="top">
<a>van der Stok, P.</a>, <a>Bormann, C.</a> and <a>A. Sehgal</a>, "<a href="https://tools.ietf.org/html/rfc8132">PATCH and FETCH Methods for the Constrained Application Protocol (CoAP)</a>", RFC 8132, DOI 10.17487/RFC8132, April 2017.</td>
</tr>
</tbody></table>
<h1 id="rfc.references.2">
<a href="#rfc.references.2">13.2.</a> Informative References</h1>
<table><tbody>
<tr>
<td class="reference"><b id="I-D.ietf-core-interfaces">[I-D.ietf-core-interfaces]</b></td>
<td class="top">
<a>Shelby, Z.</a>, <a>Vial, M.</a>, <a>Koster, M.</a>, <a>Groves, C.</a>, <a>Zhu, J.</a> and <a>B. Silverajan</a>, "<a href="https://tools.ietf.org/html/draft-ietf-core-interfaces-10">Reusable Interface Definitions for Constrained RESTful Environments</a>", Internet-Draft draft-ietf-core-interfaces-10, September 2017.</td>
</tr>
<tr>
<td class="reference"><b id="netconfcentral">[netconfcentral]</b></td>
<td class="top">
<a>YUMAworks</a>, "<a>NETCONF Central: library of YANG modules</a>", Web http://www.netconfcentral.org/modulelist</td>
</tr>
<tr>
<td class="reference"><b id="RFC4293">[RFC4293]</b></td>
<td class="top">
<a>Routhier, S.</a>, "<a href="https://tools.ietf.org/html/rfc4293">Management Information Base for the Internet Protocol (IP)</a>", RFC 4293, DOI 10.17487/RFC4293, April 2006.</td>
</tr>
<tr>
<td class="reference"><b id="RFC6347">[RFC6347]</b></td>
<td class="top">
<a>Rescorla, E.</a> and <a>N. Modadugu</a>, "<a href="https://tools.ietf.org/html/rfc6347">Datagram Transport Layer Security Version 1.2</a>", RFC 6347, DOI 10.17487/RFC6347, January 2012.</td>
</tr>
<tr>
<td class="reference"><b id="RFC6690">[RFC6690]</b></td>
<td class="top">
<a>Shelby, Z.</a>, "<a href="https://tools.ietf.org/html/rfc6690">Constrained RESTful Environments (CoRE) Link Format</a>", RFC 6690, DOI 10.17487/RFC6690, August 2012.</td>
</tr>
<tr>
<td class="reference"><b id="RFC7159">[RFC7159]</b></td>
<td class="top">
<a>Bray, T.</a>, "<a href="https://tools.ietf.org/html/rfc7159">The JavaScript Object Notation (JSON) Data Interchange Format</a>", RFC 7159, DOI 10.17487/RFC7159, March 2014.</td>
</tr>
<tr>
<td class="reference"><b id="RFC7223">[RFC7223]</b></td>
<td class="top">
<a>Bjorklund, M.</a>, "<a href="https://tools.ietf.org/html/rfc7223">A YANG Data Model for Interface Management</a>", RFC 7223, DOI 10.17487/RFC7223, May 2014.</td>
</tr>
<tr>
<td class="reference"><b id="RFC7317">[RFC7317]</b></td>
<td class="top">
<a>Bierman, A.</a> and <a>M. Bjorklund</a>, "<a href="https://tools.ietf.org/html/rfc7317">A YANG Data Model for System Management</a>", RFC 7317, DOI 10.17487/RFC7317, August 2014.</td>
</tr>
<tr>
<td class="reference"><b id="RFC7925">[RFC7925]</b></td>
<td class="top">
<a>Tschofenig, H.</a> and <a>T. Fossati</a>, "<a href="https://tools.ietf.org/html/rfc7925">Transport Layer Security (TLS) / Datagram Transport Layer Security (DTLS) Profiles for the Internet of Things</a>", RFC 7925, DOI 10.17487/RFC7925, July 2016.</td>
</tr>
<tr>
<td class="reference"><b id="XML">[XML]</b></td>
<td class="top">
<a>W3C</a>, "<a>Extensible Markup Language (XML)</a>", Web http://www.w3.org/xml</td>
</tr>
<tr>
<td class="reference"><b id="yang-cbor">[yang-cbor]</b></td>
<td class="top">
<a>Veillette, M.</a>, "<a>yang-cbor Registry</a>", Web https://github.com/core-wg/yang-cbor/tree/master/registry/</td>
</tr>
</tbody></table>
<h1 id="rfc.appendix.A">
<a href="#rfc.appendix.A">Appendix A.</a> <a href="#ietf-comi-yang" id="ietf-comi-yang">ietf-comi YANG module</a>
</h1>
<pre>
&lt;CODE BEGINS&gt; file "ietf-comi@2017-07-01.yang"
module ietf-comi {
  yang-version 1.1;

  namespace "urn:ietf:params:xml:ns:yang:ietf-comi";
  prefix comi;

  organization
    "IETF Core Working Group";

  contact
    "Michel Veillette
     &lt;mailto:michel.veillette@trilliantinc.com&gt;

     Alexander Pelov
     &lt;mailto:alexander@ackl.io&gt;

     Peter van der Stok
     &lt;mailto:consultancy@vanderstok.org&gt;

     Andy Bierman
     &lt;mailto:andy@yumaworks.com&gt;";

  description
    "This module contains the different definitions required
     by the CoMI protocol.";

  revision 2017-07-01 {
     description
      "Initial revision.";
    reference
      "[I-D.ietf-core-comi] CoAP Management Interface";
  }

  typedef sid {
    type uint64;
    description
      "YANG Schema Item iDentifier";
    reference
      "[I-D.ietf-core-sid] YANG Schema Item iDentifier (SID)";
  }

  typedef date_and_time_b {
    type int64;
    description
      "Binary representation of a date and time. This value is
       encoded using a positive or negative value representing
       a number of seconds relative to 1970-01-01T00:00Z in UTC
       time (i.e. the epoch). Negative values represent a date
       and time before the epoch, positive values represent a
       date and time after the epoch.
       This representation is defined in [RFC 7049] section
       2.4.1. When implemented using CoMI, tag 0 is assumed
       and not encoded.";
    reference
      "[RFC 7049] Concise Binary Object Representation (CBOR)";
  }

  identity error-tag {
    description
      "Base identity for error-tag.";
  }

  identity operation-failed {
    base error-tag;
    description
      "Returned by the CoMI server when the operation request
       can't be processed successfully.";
  }

  identity invalid-value {
    base error-tag;
    description
      "Returned by the CoMI server when the CoMI client tries to
       update or create a leaf with a value encoded using an
       invalid CBOR datatype or if the 'range', 'length',
       'pattern' or 'require-instance' constrain is not
       fulfilled.";
  }

  identity missing-element {
    base error-tag;
    description
      "Returned by the CoMI server when the operation requested
       by a CoMI client fails to comply with the 'mandatory'
       constraint defined. The 'mandatory' constraint is
       enforced for leafs and choices, unless the node or any of
       its ancestors have a 'when' condition or 'if-feature'
       expression that evaluates to 'false'.";
  }

  identity unknown-element {
    base error-tag;
    description
      "Returned by the CoMI server when the CoMI client tries to
       access a data node of a YANG module not supported, of a
       data node associated with an 'if-feature' expression
       evaluated to 'false' or to a 'when' condition evaluated
       to 'false'.";
  }

  identity bad-element {
    base error-tag;
    description
      "Returned by the CoMI server when the CoMI client tries to
       create data nodes for more than one case in a choice.";
  }

  identity data-missing {
    base error-tag;
    description
      "Returned by the CoMI server when a data node required to
       accept the request is not present.";
  }

  identity error {
    base error-tag;
    description
      "Returned by the CoMI server when an unspecified error has
      occurred.";
  }

  identity error-app-tag {
    description
      "Base identity for error-app-tag.";
  }


  identity malformed-message {
    base error-app-tag;
    description
      "Returned by the CoMI server when the payload received
       from the CoMI client don't contain a well-formed CBOR
       content as defined in [RFC7049] section 3.3 or don't
       comply with the CBOR structure defined within this
       document.";
  }

  identity data-not-unique {
    base error-app-tag;
    description
      "Returned by the CoMI server when the validation of the
       'unique' constraint of a list or leaf-list fails.";
  }

  identity too-many-elements {
    base error-app-tag;
    description
      "Returned by the CoMI server when the validation of the
       'max-elements' constraint of a list or leaf-list fails.";
  }

  identity too-few-elements {
    base error-app-tag;
    description
      "Returned by the CoMI server when the validation of the
       'min-elements' constraint of a list or leaf-list fails.";
  }

  identity must-violation {
    base error-app-tag;
    description
      "Returned by the CoMI server when the restrictions
       imposed by a 'must' statement are violated.";
  }

  identity duplicate {
    base error-app-tag;
    description
      "Returned by the CoMI server when a client tries to create
       a duplicate list or leaf-list entry.";
  }

  identity invalid-datatype {
    base error-app-tag;
    description
      "Returned by the CoMI server when CBOR encoding is
       incorect or when the value encoded is incompatible with
       the YANG Built-In type. (e.g. value greater than 127
       for an int8, undefined enumeration).";
  }

  identity not-in-range {
    base error-app-tag;
    description
      "Returned by the CoMI server when the validation of the
       'range' property fails.";
  }

  identity invalid-length {
    base error-app-tag;
    description
      "Returned by the CoMI server when the validation of the
       'length' property fails.";
  }

  identity pattern-test-failed {
    base error-app-tag;
    description
      "Returned by the CoMI server when the validation of the
       'pattern' property fails.";
  }

  identity missing-key {
    base error-app-tag;
    description
      "Returned by the CoMI server to further qualify a
       missing-element error. This error is returned when the
       CoMI client tries to create or list instance, without all
       the 'key' specified or when the CoMI client tries to
       delete a leaf listed as a 'key'.";
  }

  identity missing-input-parameter {
    base error-app-tag;
    description
      "Returned by the CoMI server when the input parameters
       of a RPC or action are incomplete.";
  }

  identity instance-required {
    base error-app-tag;
    description
      "Returned by the CoMI server when a leaf of type
       'instance-identifier' or 'leafref' marked with
       require-instance set to 'true' refers to an instance
       that does not exist.";
  }

  identity missing-choice {
    base error-app-tag;
    description
      "Returned by the CoMI server when no nodes exist in a
       mandatory choice.";
  }

  container error {
    presence "Error paylaod";

    description
      "Optional payload of a 4.00 Bad Request CoAP error.";

    leaf error-tag {
      type identityref {
        base error-tag;
      }
      mandatory true;
      description
        "The enumerated error-tag.";
    }

    leaf error-app-tag {
      type identityref {
        base error-app-tag;
      }
      description
        "The application-specific error-tag.";
    }   

    leaf error-data-node {
      type instance-identifier;
      description
        "When the error reported is caused by a specific data node,
         this leaf identifies the data node in error.";
    }

    leaf error-message {
      type string;
      description
        "A message describing the error.";
    }
  }
}
&lt;CODE ENDS&gt;
</pre>
<h1 id="rfc.appendix.B">
<a href="#rfc.appendix.B">Appendix B.</a> <a href="#ietf-comi-sid" id="ietf-comi-sid">ietf-comi .sid file</a>
</h1>
<pre>
{
  "assignment-ranges": [
    {
      "entry-point": 1000,
      "size": 100
    }
  ],
  "module-name": "ietf-comi",
  "module-revision": "2017-07-01",
  "items": [
    {
      "namespace": "module",
      "identifier": "ietf-comi",
      "sid": 1000
    },
    {
      "namespace": "identity",
      "identifier": "bad-element",
      "sid": 1001
    },
    {
      "namespace": "identity",
      "identifier": "data-missing",
      "sid": 1002
    },
    {
      "namespace": "identity",
      "identifier": "data-not-unique",
      "sid": 1003
    },
    {
      "namespace": "identity",
      "identifier": "duplicate",
      "sid": 1004
    },
    {
      "namespace": "identity",
      "identifier": "error",
      "sid": 1005
    },
    {
      "namespace": "identity",
      "identifier": "error-app-tag",
      "sid": 1006
    },
    {
      "namespace": "identity",
      "identifier": "error-tag",
      "sid": 1007
    },
    {
      "namespace": "identity",
      "identifier": "instance-required",
      "sid": 1008
    },
    {
      "namespace": "identity",
      "identifier": "invalid-datatype",
      "sid": 1009
    },
    {
      "namespace": "identity",
      "identifier": "invalid-length",
      "sid": 1010
    },
    {
      "namespace": "identity",
      "identifier": "invalid-value",
      "sid": 1011
    },
    {
      "namespace": "identity",
      "identifier": "malformed-message",
      "sid": 1012
    },
    {
      "namespace": "identity",
      "identifier": "missing-choice",
      "sid": 1013
    },
    {
      "namespace": "identity",
      "identifier": "missing-element",
      "sid": 1014
    },
    {
      "namespace": "identity",
      "identifier": "missing-input-parameter",
      "sid": 1015
    },
    {
      "namespace": "identity",
      "identifier": "missing-key",
      "sid": 1016
    },
    {
      "namespace": "identity",
      "identifier": "must-violation",
      "sid": 1017
    },
    {
      "namespace": "identity",
      "identifier": "not-in-range",
      "sid": 1018
    },
    {
      "namespace": "identity",
      "identifier": "operation-failed",
      "sid": 1019
    },
    {
      "namespace": "identity",
      "identifier": "pattern-test-failed",
      "sid": 1020
    },
    {
      "namespace": "identity",
      "identifier": "too-few-elements",
      "sid": 1021
    },
    {
      "namespace": "identity",
      "identifier": "too-many-elements",
      "sid": 1022
    },
    {
      "namespace": "identity",
      "identifier": "unknown-element",
      "sid": 1023
    },
    {
      "namespace": "data",
      "identifier": "/ietf-comi:error",
      "sid": 1024
    },
    {
      "namespace": "data",
      "identifier": "/ietf-comi:error/error-app-tag",
      "sid": 1025
    },
    {
      "namespace": "data",
      "identifier": "/ietf-comi:error/error-data-node",
      "sid": 1026
    },
    {
      "namespace": "data",
      "identifier": "/ietf-comi:error/error-message",
      "sid": 1027
    },
    {
      "namespace": "data",
      "identifier": "/ietf-comi:error/error-tag",
      "sid": 1028
    }
  ]
}
</pre>
<h1 id="rfc.appendix.C">
<a href="#rfc.appendix.C">Appendix C.</a> <a href="#example-specifications" id="example-specifications">YANG example specifications</a>
</h1>
<p id="rfc.section.C.p.1">This appendix shows five YANG example specifications taken over from as many existing YANG modules. The YANG modules are available from <a href="#netconfcentral" class="xref">[netconfcentral]</a>.  Each YANG item identifier is accompanied by its SID shown after the &#8220;//&#8221; comment sign.</p>
<h1 id="rfc.appendix.C.1">
<a href="#rfc.appendix.C.1">C.1.</a> <a href="#ietf-system" id="ietf-system">ietf-system</a>
</h1>
<p id="rfc.section.C.1.p.1">Excerpt of the YANG module ietf-system <a href="#RFC7317" class="xref">[RFC7317]</a>.</p>
<pre>
module ietf-system {                   // SID 1700
  container system {                   // SID 1717
    container clock {                  // SID 1738
      choice timezone {
        case timezone-name {
          leaf timezone-name {         // SID 1739
            type timezone-name;
          }
        }
        case timezone-utc-offset {
          leaf timezone-utc-offset {   // SID 1740
            type int16 {
            }
          }
        }
      }
    }
    container ntp {                    // SID 1754
      leaf enabled {                   // SID 1755
        type boolean;
        default true;
      }
      list server {                    // SID 1756
        key name;
        leaf name {                    // SID 1759
          type string;
        }
        choice transport {
          case udp {
            container udp {            // SID 1761
              leaf address {           // SID 1762
                type inet:host;
              }
              leaf port {              // SID 1763
                type inet:port-number;
              }
            }
          }
        }
        leaf association-type {        // SID 1757
          type enumeration {
            enum server {
            }
            enum peer {
            }
            enum pool {
            }
          }
        }
        leaf iburst {                  // SID 1758
          type boolean;
        }
        leaf prefer {                  // SID 1760
          type boolean;
          default false;
        }
      }
    }
  container system-state {             // SID 1720
    container clock {                  // SID 1721
      leaf current-datetime {          // SID 1723
        type yang:date-and-time;
      }
      leaf boot-datetime {             // SID 1722
        type yang:date-and-time;
      }
    }
  }
}
</pre>
<h1 id="rfc.appendix.C.2">
<a href="#rfc.appendix.C.2">C.2.</a> <a href="#server" id="server">server list</a>
</h1>
<p id="rfc.section.C.2.p.1">Taken over from <a href="#RFC7950" class="xref">[RFC7950]</a> section 7.15.3.</p>
<pre>
module example-server-farm {
  yang-version 1.1;
  namespace "urn:example:server-farm";
  prefix "sfarm";

  import ietf-yang-types {
    prefix "yang";
  }

  list server {                        // SID 60000
    key name;
    leaf name {                        // SID 60001
      type string;
    }
    action reset {                     // SID 60002
      input {
        leaf reset-at {                // SID 60003
          type yang:date-and-time;
          mandatory true;
         }
       }
       output {
         leaf reset-finished-at {      // SID 60004
           type yang:date-and-time;
           mandatory true;
         }
       }
     }
   }
}

</pre>
<h1 id="rfc.appendix.C.3">
<a href="#rfc.appendix.C.3">C.3.</a> <a href="#interfaces" id="interfaces">interfaces</a>
</h1>
<p id="rfc.section.C.3.p.1">Excerpt of the YANG module ietf-interfaces <a href="#RFC7223" class="xref">[RFC7223]</a>.</p>
<pre>
module ietf-interfaces {               // SID 1500
  container interfaces {               // SID 1505
    list interface {                   // SID 1533
      key "name";
      leaf name {                      // SID 1537
        type string;
      }
      leaf description {               // SID 1534
        type string;
      }
      leaf type {                      // SID 1538
        type identityref {
          base interface-type;
        }
        mandatory true;
      }

      leaf enabled {                   // SID 1535
        type boolean;
        default "true";
      }

      leaf link-up-down-trap-enable {  // SID 1536
        if-feature if-mib;
        type enumeration {
          enum enabled {
            value 1;
          }
          enum disabled {
            value 2;
          }
        }
      }
    }
  }
}
</pre>
<h1 id="rfc.appendix.C.4">
<a href="#rfc.appendix.C.4">C.4.</a> <a href="#notify-ex" id="notify-ex">Example-port</a>
</h1>
<p id="rfc.section.C.4.p.1">Notification example defined within this document.</p>
<pre>
module example-port {
        ...
        notification example-port-fault {   // SID 60010
          description
            "Event generated if a hardware fault on a
             line card port is detected";
          leaf port-name {                  // SID 60011
            type string;
            description "Port name";
          }
          leaf port-fault {                 // SID 60012
            type string;
            description "Error condition detected";
          }
        }
      }
</pre>
<h1 id="rfc.appendix.C.5">
<a href="#rfc.appendix.C.5">C.5.</a> <a href="#smi" id="smi">IP-MIB</a>
</h1>
<p id="rfc.section.C.5.p.1">The YANG translation of the SMI specifying the IP-MIB <a href="#RFC4293" class="xref">[RFC4293]</a>, extended with example SID numbers, yields:</p>
<pre>
module IP-MIB {
  import IF-MIB {
    prefix if-mib;
  }
  import INET-ADDRESS-MIB {
    prefix inet-address;
  }
  import SNMPv2-TC {
    prefix smiv2;
  }
  import ietf-inet-types {
    prefix inet;
  }
  import yang-smi {
    prefix smi;
  }
  import ietf-yang-types {
    prefix yang;
  }

  container ip {                            // SID 60020
    list ipNetToPhysicalEntry {             // SID 60021
      key "ipNetToPhysicalIfIndex
           ipNetToPhysicalNetAddressType
           ipNetToPhysicalNetAddress";
      leaf ipNetToPhysicalIfIndex {         // SID 60022
        type if-mib:InterfaceIndex;
      }
      leaf ipNetToPhysicalNetAddressType {  // SID 60023
        type inet-address:InetAddressType;
      }
      leaf ipNetToPhysicalNetAddress {      // SID 60024
        type inet-address:InetAddress;
      }
      leaf ipNetToPhysicalPhysAddress {     // SID 60025
        type yang:phys-address {
          length "0..65535";
        }
      }
      leaf ipNetToPhysicalLastUpdated {     // SID 60026
        type yang:timestamp;
      }
      leaf ipNetToPhysicalType {            // SID 60027
        type enumeration {
          enum "other" {
            value 1;
          }
          enum "invalid" {
            value 2;
          }
          enum "dynamic" {
            value 3;
          }
          enum "static" {
            value 4;
          }
          enum "local" {
            value 5;
          }
        }
      }
      leaf ipNetToPhysicalState {           // SID 60028
        type enumeration {
          enum "reachable" {
            value 1;
          }
          enum "stale" {
            value 2;
          }
          enum "delay" {
            value 3;
          }
          enum "probe" {
            value 4;
          }
          enum "invalid" {
            value 5;
          }
          enum "unknown" {
            value 6;
          }
          enum "incomplete" {
            value 7;
          }
        }
      }
      leaf ipNetToPhysicalRowStatus {       // SID 60029
        type smiv2:RowStatus;
    }  // list ipNetToPhysicalEntry
  }  // container ip
}  // module IP-MIB
</pre>
<h1 id="rfc.authors"><a href="#rfc.authors">Authors' Addresses</a></h1>
<div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">Jaime Jimenez</span> (editor)
	  <span class="n hidden">
		<span class="family-name">Jimenez</span>
	  </span>
	</span>
	<span class="org vcardline">Ericsson</span>
	<span class="adr">
	  <span class="vcardline">My Great Street</span>

	  <span class="vcardline">
		<span class="locality">Madrid</span>,  
		<span class="region">Spain</span> 
		<span class="code"></span>
	  </span>
	  <span class="country-name vcardline"></span>
	</span>
	
  </address>
</div><div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">Author One</span> 
	  <span class="n hidden">
		<span class="family-name">One</span>
	  </span>
	</span>
	<span class="org vcardline">Company</span>
	<span class="adr">
	  
	  <span class="vcardline">
		<span class="locality"></span> 
		<span class="region"></span>
		<span class="code"></span>
	  </span>
	  <span class="country-name vcardline"></span>
	</span>
	<span class="vcardline">EMail: <a href="mailto:author@company.org">author@company.org</a></span>

  </address>
</div><div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">Author Two</span> 
	  <span class="n hidden">
		<span class="family-name">Two</span>
	  </span>
	</span>
	<span class="org vcardline">Company</span>
	<span class="adr">
	  
	  <span class="vcardline">
		<span class="locality"></span> 
		<span class="region"></span>
		<span class="code"></span>
	  </span>
	  <span class="country-name vcardline"></span>
	</span>
	<span class="vcardline">EMail: <a href="mailto:author@company.org">author@company.org</a></span>

  </address>
</div><div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">Author Three</span> 
	  <span class="n hidden">
		<span class="family-name">Three</span>
	  </span>
	</span>
	<span class="org vcardline">Company</span>
	<span class="adr">
	  
	  <span class="vcardline">
		<span class="locality"></span> 
		<span class="region"></span>
		<span class="code"></span>
	  </span>
	  <span class="country-name vcardline"></span>
	</span>
	<span class="vcardline">EMail: <a href="mailto:author@company.org">author@company.org</a></span>

  </address>
</div>

  <div class="github-fork-ribbon-wrapper"><div class="github-fork-ribbon"><a href="https://github.com/omadm/comi">Fork me on GitHub</a></div></div>
</body>
</html>
