<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" 
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">

<html lang="en" xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head profile="http://www.w3.org/2006/03/hcard http://dublincore.org/documents/2008/08/04/dc-html/">
  <meta http-equiv="Content-Type" content="text/html; charset=us-ascii" />

  <title>Lightweight Machine to Machine Technical Specification - Transport Bindings</title>

  
<style type="text/css">/*<![CDATA[*/
@viewport {
  zoom: 1.0;
  width: extend-to-zoom;
}
@-ms-viewport {
  width: extend-to-zoom;
  zoom: 1.0;
}

@media screen and (min-width: 1024px) {
  ul.toc, #rfc\.toc {
    position: fixed;
    bottom: 0;
    right: 0;
    right: calc(50vw - 525px);
    width: 300px;
    z-index: 1;
  }
  #rfc\.toc {
    top: 15px;
  }
  ul.toc {
    top: 80px;
    overflow: auto;
    overscroll-behavior: contain;
  }

  body {
    padding-right: 350px;
  }
}

body {
  font: 15px "Helvetica Neue",Helvetica,Arial,sans-serif;
  color: #333;
  font-size-adjust: 0.5;
  line-height: 130%;
  margin: 25px auto;
  max-width: 724px;
}

.title, .filename, h1, h2, h3, h4 {
  font-family: "Helvetica Neue",Helvetica,Arial,sans-serif;
  font-size-adjust: 0.5;
  font-weight: 500;
  color: #333;
  line-height: 100%;
  margin: 0.8em 0 0.3em;
}
.title { font-size: 36px; }
h1 { font-size: 30px; }
h2 { font-size: 24px; }
h3, h4 { font-size: 18px; }
h1 a[href], h2 a[href], h3 a[href], h4 a[href] {
  color: #333;
}

ul.toc li {
  list-style: none;
  text-indent: -2.5em;
  padding-left: 2.5em;
  padding-bottom: 5px;
  margin: 0;
}
ul.toc ul {
  margin: 0;
}
/* xml2rfc nests ul directly inside ul which messes with the style badly */
ul.toc, ul.toc>ul, ul.toc ul>ul {
  margin: 0 0 0 1.5em;
}

table {
  margin-left: 0em;
  border-collapse: collapse;
}
th {
  text-align: left;
  border-bottom: 2px solid #ddd;
}
td {
  border-top: 1px solid #ddd;
  vertical-align: top;
}
tr:nth-child(2n+1) > td,
tr:nth-child(2n+1) > th {
  background-color: #f9f9f9;
}
td.reference {
  max-width: 200px;
  border-top: none;
  padding-right: 1em;
}
.right {
  text-align: right;
}


table.header {
  width: 100%;
}
table.header td {
  border: none;
  background-color: transparent;
  color: black;
}
.filename {
  color: rgb(119, 119, 119);
  font-size: 23px;
  font-weight: normal;
  height: auto;
  line-height: 100%;
}
#rfc\.abstract+p {
  font-size: 20px;
  font-weight: 300;
  line-height: 130%;
}

samp, tt, code, pre {
  font: 11pt consolas, monospace;
  font-size-adjust: none;
}
pre {
  background-color: #eee;
  border: 1px solid #ddd;
  overflow-x: auto;
  padding: 5px;
  margin: 5px;
}
.figure {
  font-style: italic;
  margin: 0 1.5em;
}

address {
  margin: 10px 0 0;
}
.vcard {
  font-style: normal;
}
.vcardline {
  display: block;
}
.vcardline .fn {
  font-weight: bold;
}
.vcardline .hidden {
  display: none;
}

dl {
  margin-left: 1em;
}
dl.dl-horizontal: {
  margin-left: 0;
}
dl > dt {
  float: left;
  margin-right: 1em;
}
dl.nohang > dt {
  float: none;
}
dl > dd {
  margin-bottom: .5em;
}
dl.compact > dd {
  margin-bottom: 0em;
}
dl > dd > dl {
  margin-top: 0.5em;
  margin-bottom: 0em;
}
ul.empty {
  list-style-type: none;
}
ul.empty li {
  margin-top: .5em;
}

hr {
  border: 0;
  border-top: 1px solid #eee;
}

a {
  text-decoration: none;
}
a[href] {
  color: #2a6496;
}
a[href]:hover {
  background-color: #eee;
}

ol, ul, li, p {
  padding: 0;
  margin: 0.5em 0 0.5em 2em;
}
li, p {
  margin-left: 0;
}
address {
  font-style: normal;
}

.github-fork-ribbon-wrapper {
  display: none;
}
@media screen and (min-width: 800px) {
  /* "Fork me on GitHub" CSS ribbon based on
   * https://github.com/simonwhitaker/github-fork-ribbon-css
   */
  .github-fork-ribbon {
    position: absolute;
    padding: 2px 0;
    background-color: #a00;
    background-image: linear-gradient(to bottom, rgba(0, 0, 0, 0), rgba(0, 0, 0, 0.15));
    box-shadow: 0 2px 3px 0 rgba(0, 0, 0, 0.5);
    font: 700 12px "Helvetica Neue", Helvetica, Arial, sans-serif;

    pointer-events: auto;

    top: 38px;
    right: -45px;

    transform: rotate(45deg);
  }

  .github-fork-ribbon a[href],
  .github-fork-ribbon a[href]:hover {
    color: #fff;
    background-color: transparent;
    text-decoration: none;
    text-shadow: 0 -1px rgba(0, 0, 0, 0.5);
    text-align: center;

    width: 190px;
    line-height: 18px;

    display: inline-block;
    padding: 2px 0;

    border: 1.5px dotted #fff;
    border-color: rgba(255, 255, 255, 0.6);
  }

  .github-fork-ribbon-wrapper {
    display: block;
    width: 130px;
    height: 130px;
    position: absolute;
    overflow: hidden;
    top: 0; right: 0;
    z-index: 2;
    pointer-events: none;
  }
}
@media screen and (min-width: 1000px) {
  .github-fork-ribbon-wrapper {
    position: fixed;
  }
  /*]]>*/</style>


  <link href="#rfc.toc" rel="Contents">
<link href="#rfc.section.1" rel="Chapter" title="1 Copyright Notice">
<link href="#rfc.section.2" rel="Chapter" title="2 Introduction">
<link href="#rfc.section.2.1" rel="Chapter" title="2.1 Terminology">
<link href="#rfc.section.3" rel="Chapter" title="3 LwM2M Architecture">
<link href="#rfc.section.4" rel="Chapter" title="4 Transport Layer Binding and Encodings">
<link href="#rfc.section.4.1" rel="Chapter" title="4.1 Required Features">
<link href="#rfc.section.4.2" rel="Chapter" title="4.2 URI Identifier &amp; Operation Mapping">
<link href="#rfc.section.4.2.1" rel="Chapter" title="4.2.1 Firewall/NAT">
<link href="#rfc.section.4.2.2" rel="Chapter" title="4.2.2 Alternate Path">
<link href="#rfc.section.4.3" rel="Chapter" title="4.3 Bootstrap Interface">
<link href="#rfc.section.4.4" rel="Chapter" title="4.4 Registration Interface">
<link href="#rfc.section.4.5" rel="Chapter" title="4.5 Device Management and Service Enablement Interface">
<link href="#rfc.section.4.6" rel="Chapter" title="4.6 Information Reporting Interface">
<link href="#rfc.section.4.6.1" rel="Chapter" title="4.6.1 Queue Mode Operation">
<link href="#rfc.section.4.6.2" rel="Chapter" title="4.6.2 Update Trigger Mechanism">
<link href="#rfc.section.4.7" rel="Chapter" title="4.7 Response Codes">
<link href="#rfc.section.5" rel="Chapter" title="5 Security Considerations">
<link href="#rfc.section.5.1" rel="Chapter" title="5.1 DTLS Security">
<link href="#rfc.section.5.1.1" rel="Chapter" title="5.1.1 DTLS Overview">
<link href="#rfc.section.5.1.2" rel="Chapter" title="5.1.2 Ciphersuites">
<link href="#rfc.section.5.1.3" rel="Chapter" title="5.1.3 Bootstrapping">
<link href="#rfc.section.5.1.4" rel="Chapter" title="5.1.4 Endpoint Client Name">
<link href="#rfc.section.5.1.5" rel="Chapter" title="5.1.5 LwM2M and DTLS Roles">
<link href="#rfc.section.5.1.6" rel="Chapter" title="5.1.6 Pre-Shared Keys">
<link href="#rfc.section.5.1.7" rel="Chapter" title="5.1.7 Raw Public Keys">
<link href="#rfc.section.5.1.8" rel="Chapter" title="5.1.8 X.509 Certificates">
<link href="#rfc.section.5.1.9" rel="Chapter" title="5.1.9 &#8220;NoSec&#8221; mode">
<link href="#rfc.section.5.1.10" rel="Chapter" title="5.1.10 Certificate mode with EST">
<link href="#rfc.section.5.2" rel="Chapter" title="5.2 SMS Channel Security">
<link href="#rfc.section.5.2.1" rel="Chapter" title="5.2.1 SMS &#8220;NoSec&#8221; Mode">
<link href="#rfc.section.5.2.2" rel="Chapter" title="5.2.2 SMS Secured Mode">
<link href="#rfc.section.5.2.3" rel="Chapter" title="5.2.3 Device End-Point">
<link href="#rfc.section.5.2.4" rel="Chapter" title="5.2.4 Smartcard End-Point">
<link href="#rfc.section.5.2.5" rel="Chapter" title="5.2.5 SMS Secured Packet Binding for CoAP messages">
<link href="#rfc.section.5.3" rel="Chapter" title="5.3 LPWA Security">
<link href="#rfc.section.6" rel="Chapter" title="6 IANA Considerations">
<link href="#rfc.section.6.1" rel="Chapter" title="6.1 Resource Type (rt=) Link Target Attribute Values Registry">
<link href="#rfc.section.6.2" rel="Chapter" title="6.2 CoAP Content-Formats Registry">
<link href="#rfc.section.7" rel="Chapter" title="7 Acknowledgements">
<link href="#rfc.references" rel="Chapter" title="8 References">
<link href="#rfc.references.1" rel="Chapter" title="8.1 Normative References">
<link href="#rfc.references.2" rel="Chapter" title="8.2 Informative References">
<link href="#rfc.appendix.A" rel="Chapter" title="A Appendix 1: TITLE">
<link href="#rfc.appendix.B" rel="Chapter" title="B OMA DM example Objects">
<link href="#rfc.authors" rel="Chapter">


  <meta name="generator" content="xml2rfc version 2.8.2 - https://tools.ietf.org/tools/xml2rfc" />
  <link rel="schema.dct" href="http://purl.org/dc/terms/" />

  <meta name="dct.creator" content="Jimenez, J., Ed., One, A., Two, A., and A. Three" />
  <meta name="dct.identifier" content="urn:ietf:id:draft-omadm-lwm2m-ts" />
  <meta name="dct.issued" scheme="ISO8601" content="2017-12-18" />
  <meta name="dct.abstract" content="This document specifies version 1.0 of the Lightweight Machine-to-Machine (LwM2M) protocol. This Lightweight M2M 1.0 enabler introduces the following features:" />
  <meta name="description" content="This document specifies version 1.0 of the Lightweight Machine-to-Machine (LwM2M) protocol. This Lightweight M2M 1.0 enabler introduces the following features:" />

</head>

<body>

  <table class="header">
    <tbody>
    
    	<tr>
<td class="left">OMA</td>
<td class="right">J. Jimenez, Ed.</td>
</tr>
<tr>
<td class="left">Internet-Draft</td>
<td class="right">Ericsson</td>
</tr>
<tr>
<td class="left">Intended status: Standards Track</td>
<td class="right">A. One</td>
</tr>
<tr>
<td class="left">Expires: June 21, 2018</td>
<td class="right">A. Two</td>
</tr>
<tr>
<td class="left"></td>
<td class="right">A. Three</td>
</tr>
<tr>
<td class="left"></td>
<td class="right">Company</td>
</tr>
<tr>
<td class="left"></td>
<td class="right">December 18, 2017</td>
</tr>

    	
    </tbody>
  </table>

  <p class="title">Lightweight Machine to Machine Technical Specification - Transport Bindings<br />
  <span class="filename">draft-omadm-lwm2m-ts</span></p>
  
  <h1 id="rfc.abstract"><a href="#rfc.abstract">Abstract</a></h1>
<p>This document specifies version 1.0 of the Lightweight Machine-to-Machine (LwM2M) protocol. This Lightweight M2M 1.0 enabler introduces the following features:</p>
<p></p>

<ul>
<li>Simple resource model with the core set of objects and resources defined in this specification. The full list of registered objects can be found at (TODO OMNA).</li>
<li>Operations for creation, update, deletion, and retrieval of resources.</li>
<li>Asynchronous notifications of resource changes.</li>
<li>Support for several serialization formats, namely TLV, JSON, Plain Text and binary data formats and the core set of LightweightM2M Objects.</li>
<li>UDP and SMS transport support.</li>
<li>Communication security based on the DTLS protocol supporting different types of credentials.</li>
<li>Queue Mode offers functionality for a LwM2M Client to inform the LwM2M Server that it may be disconnected for an extended period and when it becomes reachable again.</li>
<li>Support for use of multiple LwM2M Servers.</li>
<li>Provisioning of security credentials and access control lists by a dedicated LwM2M bootstrap-server.</li>
</ul>
<h1><a>Note</a></h1>
<p>Discussion and suggestions for improvement are requested, and should be sent to omaemail@oma.com.</p>
<h1 id="rfc.status"><a href="#rfc.status">Status of This Memo</a></h1>
<p>This Internet-Draft is submitted in full conformance with the provisions of BCP 78 and BCP 79.</p>
<p>Internet-Drafts are working documents of the Internet Engineering Task Force (IETF).  Note that other groups may also distribute working documents as Internet-Drafts.  The list of current Internet-Drafts is at https://datatracker.ietf.org/drafts/current/.</p>
<p>Internet-Drafts are draft documents valid for a maximum of six months and may be updated, replaced, or obsoleted by other documents at any time.  It is inappropriate to use Internet-Drafts as reference material or to cite them other than as "work in progress."</p>
<p>This Internet-Draft will expire on June 21, 2018.</p>
<h1 id="rfc.copyrightnotice"><a href="#rfc.copyrightnotice">Copyright Notice</a></h1>
<p>Copyright (c) 2017 IETF Trust and the persons identified as the document authors.  All rights reserved.</p>
<p>This document is subject to BCP 78 and the IETF Trust's Legal Provisions Relating to IETF Documents (https://trustee.ietf.org/license-info) in effect on the date of publication of this document.  Please review these documents carefully, as they describe your rights and restrictions with respect to this document.  Code Components extracted from this document must include Simplified BSD License text as described in Section 4.e of the Trust Legal Provisions and are provided without warranty as described in the Simplified BSD License.</p>

  
  <hr class="noprint" />
  <h1 class="np" id="rfc.toc"><a href="#rfc.toc">Table of Contents</a></h1>
  <ul class="toc">

  	<li>1.   <a href="#rfc.section.1">Copyright Notice</a>
</li>
<li>2.   <a href="#rfc.section.2">Introduction</a>
</li>
<ul><li>2.1.   <a href="#rfc.section.2.1">Terminology</a>
</li>
</ul><li>3.   <a href="#rfc.section.3">LwM2M Architecture</a>
</li>
<li>4.   <a href="#rfc.section.4">Transport Layer Binding and Encodings</a>
</li>
<ul><li>4.1.   <a href="#rfc.section.4.1">Required Features</a>
</li>
<li>4.2.   <a href="#rfc.section.4.2">URI Identifier &amp; Operation Mapping</a>
</li>
<ul><li>4.2.1.   <a href="#rfc.section.4.2.1">Firewall/NAT</a>
</li>
<li>4.2.2.   <a href="#rfc.section.4.2.2">Alternate Path</a>
</li>
</ul><li>4.3.   <a href="#rfc.section.4.3">Bootstrap Interface</a>
</li>
<li>4.4.   <a href="#rfc.section.4.4">Registration Interface</a>
</li>
<li>4.5.   <a href="#rfc.section.4.5">Device Management and Service Enablement Interface</a>
</li>
<li>4.6.   <a href="#rfc.section.4.6">Information Reporting Interface</a>
</li>
<ul><li>4.6.1.   <a href="#rfc.section.4.6.1">Queue Mode Operation</a>
</li>
<li>4.6.2.   <a href="#rfc.section.4.6.2">Update Trigger Mechanism</a>
</li>
</ul><li>4.7.   <a href="#rfc.section.4.7">Response Codes</a>
</li>
</ul><li>5.   <a href="#rfc.section.5">Security Considerations</a>
</li>
<ul><li>5.1.   <a href="#rfc.section.5.1">DTLS Security</a>
</li>
<ul><li>5.1.1.   <a href="#rfc.section.5.1.1">DTLS Overview</a>
</li>
<li>5.1.2.   <a href="#rfc.section.5.1.2">Ciphersuites</a>
</li>
<li>5.1.3.   <a href="#rfc.section.5.1.3">Bootstrapping</a>
</li>
<li>5.1.4.   <a href="#rfc.section.5.1.4">Endpoint Client Name</a>
</li>
<li>5.1.5.   <a href="#rfc.section.5.1.5">LwM2M and DTLS Roles</a>
</li>
<li>5.1.6.   <a href="#rfc.section.5.1.6">Pre-Shared Keys</a>
</li>
<li>5.1.7.   <a href="#rfc.section.5.1.7">Raw Public Keys</a>
</li>
<li>5.1.8.   <a href="#rfc.section.5.1.8">X.509 Certificates</a>
</li>
<li>5.1.9.   <a href="#rfc.section.5.1.9">&#8220;NoSec&#8221; mode</a>
</li>
<li>5.1.10.   <a href="#rfc.section.5.1.10">Certificate mode with EST</a>
</li>
</ul><li>5.2.   <a href="#rfc.section.5.2">SMS Channel Security</a>
</li>
<ul><li>5.2.1.   <a href="#rfc.section.5.2.1">SMS &#8220;NoSec&#8221; Mode</a>
</li>
<li>5.2.2.   <a href="#rfc.section.5.2.2">SMS Secured Mode</a>
</li>
<li>5.2.3.   <a href="#rfc.section.5.2.3">Device End-Point</a>
</li>
<li>5.2.4.   <a href="#rfc.section.5.2.4">Smartcard End-Point</a>
</li>
<li>5.2.5.   <a href="#rfc.section.5.2.5">SMS Secured Packet Binding for CoAP messages</a>
</li>
</ul><li>5.3.   <a href="#rfc.section.5.3">LPWA Security</a>
</li>
</ul><li>6.   <a href="#rfc.section.6">IANA Considerations</a>
</li>
<ul><li>6.1.   <a href="#rfc.section.6.1">Resource Type (rt=) Link Target Attribute Values Registry</a>
</li>
<li>6.2.   <a href="#rfc.section.6.2">CoAP Content-Formats Registry</a>
</li>
</ul><li>7.   <a href="#rfc.section.7">Acknowledgements</a>
</li>
<li>8.   <a href="#rfc.references">References</a>
</li>
<ul><li>8.1.   <a href="#rfc.references.1">Normative References</a>
</li>
<li>8.2.   <a href="#rfc.references.2">Informative References</a>
</li>
</ul><li>Appendix A.   <a href="#rfc.appendix.A">Appendix 1: TITLE</a>
</li>
<li>Appendix B.   <a href="#rfc.appendix.B">OMA DM example Objects</a>
</li>
<li><a href="#rfc.authors">Authors' Addresses</a>
</li>


  </ul>

  <h1 id="rfc.section.1">
<a href="#rfc.section.1">1.</a> <a href="#copyright" id="copyright">Copyright Notice</a>
</h1>
<p id="rfc.section.1.p.1">Use of this document is subject to all of the terms and conditions of the Use Agreement located at http://www.openmobilealliance.org/UseAgreement.html.</p>
<p id="rfc.section.1.p.2">Unless this document is clearly designated as an approved specification, this document is a work in process, is not an approved Open Mobile Alliance&#8482; specification, and is subject to revision or removal without notice.</p>
<p id="rfc.section.1.p.3">You may use this document or any part of the document for internal or educational purposes only, provided you do not modify, edit or take out of context the information in this document in any manner. Information contained in this document may be used, at your sole risk, for any purposes. You may not use this document in any other manner without the prior written permission of the Open Mobile Alliance. The Open Mobile Alliance authorizes you to copy this document, provided that you retain all copyright and other proprietary notices contained in the original materials on any copies of the materials and that you comply strictly with these terms. This copyright permission does not constitute an endorsement of the products or services. The Open Mobile Alliance assumes no responsibility for errors or omissions in this document.</p>
<p id="rfc.section.1.p.4">Each Open Mobile Alliance member has agreed to use reasonable endeavors to inform the Open Mobile Alliance in a timely manner of Essential IPR as it becomes aware that the Essential IPR is related to the prepared or published specification. However, the members do not have an obligation to conduct IPR searches. The declared Essential IPR is publicly available to members and non-members of the Open Mobile Alliance and may be found on the &#8220;OMA IPR Declarations&#8221; list at http://www.openmobilealliance.org/ipr.html. The Open Mobile Alliance has not conducted an independent IPR review of this document and the information contained herein, and makes no representations or warranties regarding third party IPR, including without limitation patents, copyrights or trade secret rights. This document may contain inventions for which you must obtain licenses from third parties before making, using or selling the inventions. Defined terms above are set forth in the schedule to the Open Mobile Alliance Application Form.</p>
<p id="rfc.section.1.p.5">NO REPRESENTATIONS OR WARRANTIES (WHETHER EXPRESS OR IMPLIED) ARE MADE BY THE OPEN MOBILE ALLIANCE OR ANY OPEN MOBILE ALLIANCE MEMBER OR ITS AFFILIATES REGARDING ANY OF THE IPR&#8217;S REPRESENTED ON THE &#8220;OMA IPR DECLARATIONS&#8221; LIST, INCLUDING, BUT NOT LIMITED TO THE ACCURACY, COMPLETENESS, VALIDITY OR RELEVANCE OF THE INFORMATION OR WHETHER OR NOT SUCH RIGHTS ARE ESSENTIAL OR NON-ESSENTIAL.</p>
<p id="rfc.section.1.p.6">THE OPEN MOBILE ALLIANCE IS NOT LIABLE FOR AND HEREBY DISCLAIMS ANY DIRECT, INDIRECT, PUNITIVE, SPECIAL, INCIDENTAL, CONSEQUENTIAL, OR EXEMPLARY DAMAGES ARISING OUT OF OR IN CONNECTION WITH THE USE OF DOCUMENTS AND THE INFORMATION CONTAINED IN THE DOCUMENTS.</p>
<p id="rfc.section.1.p.7">&#169; 2017 Open Mobile Alliance All Rights Reserved. Used with the permission of the Open Mobile Alliance under the terms set forth above.</p>
<h1 id="rfc.section.2">
<a href="#rfc.section.2">2.</a> <a href="#introduction" id="introduction">Introduction</a>
</h1>
<p id="rfc.section.2.p.1">The Constrained Application Protocol (CoAP) <a href="#RFC7252" class="xref">[RFC7252]</a> is designed for Machine to Machine (M2M) applications such as smart energy, smart city and building control.  Constrained devices need to be managed in an automatic fashion to handle the large quantities of devices that are expected in future installations. Messages between devices need to be as small and infrequent as possible. The implementation complexity and runtime resources need to be as small as possible.</p>
<p id="rfc.section.2.p.2">This specification defines the transport bindings for the LwM2M messaging protocol used between the LwM2M Client, the LwM2M Bootstrap Server and with the LwM2M Server. Figure 1 shows the relationships between the transport bindings and the messaging protocol. In particular, this specification defines the following transport bindings.</p>
<p></p>

<ul>
<li>CoAP over UDP</li>
<li>CoAP over DTLS over UDP</li>
<li>CoAP over SMS</li>
<li>CoAP over DTLS over SMS</li>
</ul>
<h1 id="rfc.section.2.1">
<a href="#rfc.section.2.1">2.1.</a> <a href="#terminology" id="terminology">Terminology</a>
</h1>
<p id="rfc.section.2.1.p.1">The key words &#8220;MUST&#8221;, &#8220;MUST NOT&#8221;, &#8220;REQUIRED&#8221;, &#8220;SHALL&#8221;, &#8220;SHALL NOT&#8221;, &#8220;SHOULD&#8221;, &#8220;SHOULD NOT&#8221;, &#8220;RECOMMENDED&#8221;, &#8220;MAY&#8221;, and &#8220;OPTIONAL&#8221; in this document are to be interpreted as described in <a href="#RFC2119" class="xref">[RFC2119]</a>.</p>
<h1 id="rfc.section.3">
<a href="#rfc.section.3">3.</a> <a href="#lwm2m-architecture" id="lwm2m-architecture">LwM2M Architecture</a>
</h1>
<p id="rfc.section.3.p.1">A general architecture can be seen below <a href="#archit" class="xref">Figure 1</a>.</p>
<div id="rfc.figure.1"></div>
<div id="archit"></div>
<pre>
    +----------------------------------+  +---------+
    |              LWM2M               |  | Objects |
    +----------------------------------+  +---------+
    +----------------------------------+
    |              CoAP                |
    +----------------------------------+
    +----------------+ +---------------+
    |      DTLS      | |    SMS        |
    +----------------+ |               |
    +-------+ +------+ |  on Smartcard |
    |  UDP  | |SMS on| |               |
    |       | |device| |               |
    +-------+ +------+ +---------------+
</pre>
<p class="figure">Figure 1: The Protocol Stack of the LwM2M Enabler</p>
<h1 id="rfc.section.4">
<a href="#rfc.section.4">4.</a> <a href="#transport-layer-binding-and-encodings" id="transport-layer-binding-and-encodings">Transport Layer Binding and Encodings</a>
</h1>
<p id="rfc.section.4.p.1">This section defines the CoAP transport binding used by LwM2M interfaces.</p>
<h1 id="rfc.section.4.1">
<a href="#rfc.section.4.1">4.1.</a> <a href="#required-features" id="required-features">Required Features</a>
</h1>
<p id="rfc.section.4.1.p.1">For realization of the LwM2M interfaces, only the basic binary CoAP message header, and a small subset of options are required. This section explicitly defines the features of the CoAP standard that are required for LwM2M.</p>
<p></p>

<ul>
<li>The 4-byte binary CoAP message header is defined in Section 3 of <a href="#RFC7252" class="xref">[RFC7252]</a>. This same base message is used for Request and Response interactions.</li>
<li>Confirmable, Acknowledgement and Reset messages MUST be supported. The Reset message is used as a message layer error message in response to a malformed Confirmable message. Non-Confirmable messages MAY be used by a Client for sending Information Reporting notifications as per (TODO Observe).</li>
<li>GET, PUT, POST and DELETE methods MUST be supported. LwM2M Operations map to these methods.</li>
<li>A subset of Response Codes MUST be supported for LwM2M response message mapping.</li>
<li>The Uri-Path Option MUST be supported to indicate the identifier of the interface, Object Instance and Resource being requested.</li>
<li>The Location-Path Option MUST be supported to indicate the handle of a registration for future update and delete operations.</li>
<li>The Uri-Query Option MUST be supported.</li>
<li>The Content-Format Option MUST be used to indicate the data format of the payload.</li>
<li>The Accept Option MAY be included in a LwM2M Server data request, to specify the payload Content-Format this Server prefers to receive. The Client returns the preferred Content-Format if available. If this Accept option is not given or if the LwM2M Client doesn&#8217;t support that option, the LwM2M Client will use its own preferred data format reported in the Content-Format of the response message. If the preferred Content-Format cannot be returned, then a 4.06 &#8220;Not Acceptable&#8221; value MUST be sent as a response.</li>
<li>The Token Option MAY be used to enable multiple requests in parallel with an endpoint, and MUST be supported for the Information Reporting interface.</li>
<li>CoAP Blockwise transfer (TODO add REF) for CoAP MUST be supported by the LwM2M Client when the Firmware Update Object (ID:5) is implemented by the client and MUST be supported by the LwM2M Server. This functionality is motivated by limitations of CoAP, as defined in <a href="#RFC7252" class="xref">[RFC7252]</a> since CoAP was not designed for transmission of large payloads. Because the CoAP header itself does not contain length information the UDP length header is used instead. The maximum UDP datagram size is limited to ~64 KiB and transmitting data beyond the (path) maximum transmission (MTU) size will additionally lead to inefficiency because of fragmentation at lower layers (IP layer, adaptation layer, and link layer). Blockwise Transfer for CoAP (TODO CoAP_Blockwise) was specifically designed to lift this limitation in order to transfer large payloads larger than ~64 KiB via CoAP, such as firmware images. Note: (TODO CoAP_Blockwise) is also beneficial for use with firmware images smaller than 64 KiB since the block-wise transmission allows the server to deliver firmware images in chunks suitable to the MTU and thereby avoiding fragmentation at lower layers. A LwM2M client may choose to support block-wise transfer for objects other than the Firmware Update object. This may, for example, be useful with objects that are larger in size, such as the security object which may contain certificates. The specifics of how this functionality is utilized by a LwM2M Server are out of scope for this release of LwM2M.</li>
</ul>
<h1 id="rfc.section.4.2">
<a href="#rfc.section.4.2">4.2.</a> <a href="#uri-identifier-operation-mapping" id="uri-identifier-operation-mapping">URI Identifier &amp; Operation Mapping</a>
</h1>
<p id="rfc.section.4.2.p.1">Although CoAP supports a URI in requests, it is not used in the same way as in HTTP. The URI in CoAP is broken down into binary parts, minimizing overhead and complexity. In LwM2M only path segment and query string URI components are needed. The URI path is used to simply identify the interface, Object Instance or Resource that the request is for, and is encoded in Uri-Path options. The LwM2M Registration interface also makes use of query string parameters to pass on meta-data with the request separately from the payload. Each query parameter is encoded in a Uri-Query Option. Likewise, the LwM2M operations for each interface are mapped to CoAP Methods. All the LwM2M operations using CoAP layer MUST be Confirmable CoAP messages, except as follows:</p>
<p></p>

<ul>
<li>&#8220;Notify&#8221; which may be a Non-Confirmable CoAP message.</li>
<li>UQT mode triggering an execution on a resource can be a Non-Confirmable CoAP message.</li>
</ul>
<h1 id="rfc.section.4.2.1">
<a href="#rfc.section.4.2.1">4.2.1.</a> <a href="#firewallnat" id="firewallnat">Firewall/NAT</a>
</h1>
<p id="rfc.section.4.2.1.p.1">For a firewall to support LwM2M, it should be configured to allow outgoing UDP packets to destination port 5683 (other ports can be configured), and allow incoming UDP packets back to the source address/port of the outgoing UDP packet for a period of at least 240 seconds. These UDP packets may contain DTLS or CoAP payloads. When a firewall is configured as such any LwM2M Clients behind it should use Queue Mode.</p>
<p id="rfc.section.4.2.1.p.2">For a firewall to support LwM2M it can be configured to allow both outgoing and incoming UDP packets to destination port 5683 (other ports can be configured). These UDP packets may contain DTLS or CoAP payloads. When a firewall is configured as such any LwM2M Clients behind it are not required to use Queued Mode, but may use it for other reasons (e.g., a battery powered sleeping device).</p>
<p id="rfc.section.4.2.1.p.3">Any LwM2M Clients behind a NAT can use Queued Mode. There are other mechanisms to transverse a NAT, however they are out of scope for the LwM2M Enabler.</p>
<h1 id="rfc.section.4.2.2">
<a href="#rfc.section.4.2.2">4.2.2.</a> <a href="#alternate-path" id="alternate-path">Alternate Path</a>
</h1>
<p id="rfc.section.4.2.2.p.1">By default, the LwM2M Objects are located under the root path. However, devices might be hosting other CoAP Resources on an endpoint, and there may be the need to place LwM2M Objects under an alternate path.</p>
<p id="rfc.section.4.2.2.p.2">When registering, or updating its registration, a LwM2M Client MAY include an OMA LwM2M link in addition to the Object links in the registration payload. The link is identified by <a href="#RFC6690" class="xref">[RFC6690]</a> Resource Type parameter &#8220;oma.lwm2m&#8221;.</p>
<p id="rfc.section.4.2.2.p.3">This link MUST NOT contain numerical URI segment.</p>
<p id="rfc.section.4.2.2.p.4">For instance, the Example Client from Appendix F may place Objects under the &#8220;/lwm2m&#8221; path. The registration payload would be as follows:</p>
<div id="rfc.figure.2"></div>
<div id="sampletext"></div>
<pre>
&lt;/lwm2m&gt;;rt="oma.lwm2m",
&lt;/lwm2m /1/0&gt;,&lt;/lwm2m /1/1&gt;,
&lt;/lwm2m /2/0&gt;,&lt;/lwm2m /2/1&gt;,&lt;/lwm2m /2/2&gt;,&lt;/lwm2m /2/3&gt;,&lt;/lwm2m /2/4&gt;,
&lt;/lwm2m /3/0&gt;,
&lt;/lwm2m /4/0&gt;,
&lt;/lwm2m /5&gt;
</pre>
<p class="figure">Figure 2</p>
<p id="rfc.section.4.2.2.p.5">When using the Device Management &amp; Service Enablement Interface and the Information Reporting Interface, the LwM2M Server MUST prepend the OMA LwM2M link to the path in the CoAP messages. Example: &#8220;GET /lwm2m/3/0/0.&#8221;</p>
<p id="rfc.section.4.2.2.p.6"><a name="sampletext2"></a>When using the Bootstrap Interface, the LwM2M Bootstrap-Server MUST use CoAP paths only in the form: ~~~~ /{Object ID}/{Object Instance ID}/{Resource ID} ~~~~</p>
<p id="rfc.section.4.2.2.p.7">It is the responsibility of the LwM2M Client to map these paths to its alternate path.</p>
<p id="rfc.section.4.2.2.p.8">The Resource Type value &#8220;oma.lwm2m&#8221; is part of IANA registry.</p>
<p id="rfc.section.4.2.2.p.9">TODO Continue from Bootstrap Interface</p>
<h1 id="rfc.section.4.3">
<a href="#rfc.section.4.3">4.3.</a> <a href="#bootstrap-interface" id="bootstrap-interface">Bootstrap Interface</a>
</h1>
<h1 id="rfc.section.4.4">
<a href="#rfc.section.4.4">4.4.</a> <a href="#registration-interface" id="registration-interface">Registration Interface</a>
</h1>
<h1 id="rfc.section.4.5">
<a href="#rfc.section.4.5">4.5.</a> <a href="#device-management-and-service-enablement-interface" id="device-management-and-service-enablement-interface">Device Management and Service Enablement Interface</a>
</h1>
<h1 id="rfc.section.4.6">
<a href="#rfc.section.4.6">4.6.</a> <a href="#information-reporting-interface" id="information-reporting-interface">Information Reporting Interface</a>
</h1>
<h1 id="rfc.section.4.6.1">
<a href="#rfc.section.4.6.1">4.6.1.</a> <a href="#queue-mode-operation" id="queue-mode-operation">Queue Mode Operation</a>
</h1>
<h1 id="rfc.section.4.6.2">
<a href="#rfc.section.4.6.2">4.6.2.</a> <a href="#update-trigger-mechanism" id="update-trigger-mechanism">Update Trigger Mechanism</a>
</h1>
<h1 id="rfc.section.4.7">
<a href="#rfc.section.4.7">4.7.</a> <a href="#response-codes" id="response-codes">Response Codes</a>
</h1>
<p id="rfc.section.4.7.p.1">This section lists available response codes of each operation. The codes are divided into each interface. These are the only valid response codes defined in for the LwM2M Enabler.</p>
<p id="rfc.section.4.7.p.2">The different Content-formats usage is  summarized in the table below:</p>
<p id="rfc.section.4.7.p.3">Table 1 example: Formatted</p>
<table cellpadding="3" cellspacing="0" class="tt full left">
<thead><tr>
<th class="left">Operations</th>
<th class="left">CoAP Responses</th>
<th class="left">Reason Phrase</th>
</tr></thead>
<tbody>
<tr>
<td class="left">Bootstrap Request</td>
<td class="left">2.04 Changed</td>
<td class="left">Bootstrap-Request is completed successfully</td>
</tr>
<tr>
<td class="left"></td>
<td class="left">4.00 Bad Request</td>
<td class="left">Unknown Endpoint Client Name</td>
</tr>
<tr>
<td class="left">Write</td>
<td class="left">2.04 Changed</td>
<td class="left">Write operation is completed successfully</td>
</tr>
<tr>
<td class="left"></td>
<td class="left">4.00 Bad Request</td>
<td class="left">Data is malformed</td>
</tr>
<tr>
<td class="left"></td>
<td class="left">4.15 Unsupported Content Format</td>
<td class="left">The specified format is not supported</td>
</tr>
<tr>
<td class="left">Discover</td>
<td class="left">2.05 Content</td>
<td class="left">Discover operation is completed successfully</td>
</tr>
<tr>
<td class="left"></td>
<td class="left">4.00 Bad Request</td>
<td class="left">Undetermined error occurred</td>
</tr>
<tr>
<td class="left"></td>
<td class="left">4.04 Not Found</td>
<td class="left">URI of &#8220;Discover&#8221; operation is not found</td>
</tr>
<tr>
<td class="left">Delete</td>
<td class="left">2.02 Deleted</td>
<td class="left">Delete Operation is completed successfully</td>
</tr>
<tr>
<td class="left"></td>
<td class="left">4.00 Bad Request</td>
<td class="left">Bad or Unknown URI provided</td>
</tr>
<tr>
<td class="left">Bootstrap-Finish</td>
<td class="left">2.04 Changed</td>
<td class="left">Bootstrap-Finished is completed successfully</td>
</tr>
<tr>
<td class="left"></td>
<td class="left">4.00 Bad Request</td>
<td class="left">Bad URI provided</td>
</tr>
<tr>
<td class="left"></td>
<td class="left">4.04 Not Acceptable</td>
<td class="left">Inconsistent loaded configuration</td>
</tr>
</tbody>
</table>
<p id="rfc.section.4.7.p.4">Table 1 example: Raw</p>
<div id="rfc.figure.3"></div>
<div id="sampletable"></div>
<pre>
+--------------------------------------------------------------------------------+
| Operations  | CoAP Responses     | Reason Phrase                               |
+--------------------------------------------------------------------------------+
| Bootstrap   | 2.04 Changed       | Bootstrap-Request is completed successfully |
| Request     | 4.00 Bad Request   | Unknown Endpoint Client Name                |
+--------------------------------------------------------------------------------+
| Write       | 2.04 Changed       | Write operation is completed successfully   |
|             | 4.00 Bad Request   | Data is malformed                           |
|             | 4.15 Unsupported Content Format   | Unsupported Content Format   |
+--------------------------------------------------------------------------------+
| Discover    | 2.05 Content       | Discover operation is completed successfully|
|             | 4.00 Bad Request   | Undetermined error occurred                 |
|             | 4.04 Not Found     | URI of &#8220;Discover&#8221; operation is not found    |
+--------------------------------------------------------------------------------+
| Delete      | 2.02 Deleted       | Delete Operation is completed successfully  |
|             | 4.00 Bad Request   | Bad or Unknown URI provided                 |
+--------------------------------------------------------------------------------+
| Bootstrap   | 2.04 Changed       | Bootstrap-Finished is completed successfully|
| Finish      | 4.00 Bad Request   | Bad URI provided                            |
|             | 4.04 Not Acceptable| Inconsistent loaded configuration           |
+--------------------------------------------------------------------------------+
</pre>
<p class="figure">Figure 3: Sample Table</p>
<p id="rfc.section.4.7.p.5">Table 1 example Object:</p>
<div id="rfc.figure.4"></div>
<div id="sampletable2"></div>
<pre>
 OID: 3304
 +--ro IPSO-humidity* [instance_number]
 +--ro instance_number                  uint16
 +--ro 5700     Sensor_Value            decimal64
 +--ro 5701?    Units                   string
 +--ro 5601?    Min_Measured_Value?     decimal64
 +--ro 5602?    Max_Measured_Value?     decimal64
 +--ro 5603?    Min_Range_Value?        decimal64
 +--ro 5604?    Max_Range_Value?        decimal64
 +---x 5605?    Reset_Min_and_Max_measured_values
</pre>
<p class="figure">Figure 4</p>
<h1 id="rfc.section.5">
<a href="#rfc.section.5">5.</a> <a href="#security-considerations" id="security-considerations">Security Considerations</a>
</h1>
<p id="rfc.section.5.p.1">For secure network management, it is important to restrict access to configuration variables only to authorized parties. LwM2M re-uses the security mechanisms already available to CoAP, this includes DTLS <a href="#RFC6347" class="xref">[RFC6347]</a> for protected access to resources, as well suitable authentication and authorization mechanisms.</p>
<p id="rfc.section.5.p.2">The LwM2M protocol supports various transport bindings and credentials for securely communicating with LwM2M Servers. This configuration information can be provisioned during manufacturing or through the use of the bootstrap mechanism.</p>
<p id="rfc.section.5.p.3">LwM2M supports three different types of credentials, namely</p>
<p></p>

<ul>
<li>Certificates.</li>
<li>Raw public keys.</li>
<li>Pre-shared secrets.</li>
</ul>
<p id="rfc.section.5.p.5">Since these credential types offer different properties the LwM2M specification offers support for all of them. <a href="#RFC7925" class="xref">[RFC7925]</a> provides the necessary details about the use of each of these credentials with DTLS.</p>
<p id="rfc.section.5.p.6">The LwM2M protocol specifies that authorization of LwM2M Servers to access Object Instances and Resources within the LwM2M Client is provided through Access Control Object Instances within the LwM2M Client.</p>
<h1 id="rfc.section.5.1">
<a href="#rfc.section.5.1">5.1.</a> <a href="#dtls-security" id="dtls-security">DTLS Security</a>
</h1>
<p><strong>Requirements</strong></p>
<p id="rfc.section.5.1.p.2">For authentication of communicating LwM2M entities, the LwM2M protocol requires that all communication between LwM2M Clients and LwM2M Servers as well as LwM2M Clients and LwM2M Bootstrap-Servers are authenticated using mutual authentication. This means that a:</p>
<p></p>

<ul>
<li>LwM2M Client MUST authenticate a LwM2M Server prior to exchange of any information.</li>
<li>LwM2M Server MUST authenticate a LwM2M Client prior to exchange of any information.</li>
<li>LwM2M Client MUST authenticate a LwM2M Bootstrap-Server prior to exchange of any information.</li>
<li>LwM2M Bootstrap-Server MUST authenticate a LwM2M Client prior to exchange of any information.</li>
</ul>
<p id="rfc.section.5.1.p.4">For confidentiality and data integrity of information between communicating LwM2M entities, the LwM2M protocol requires that all communication between LwM2M Clients and LwM2M Servers as well as LwM2M Clients and LwM2M Bootstrap-Servers are encrypted and integrity protected. This means that a:</p>
<p></p>

<ul>
<li>LwM2M Client MUST encrypt and integrity protect data communicated to a LwM2M Server.</li>
<li>LwM2M Server MUST encrypt and integrity protect data communicated to a LwM2M Client.</li>
<li>LwM2M Client MUST encrypt and integrity protect data communicated to a LwM2M Bootstrap-Server.</li>
<li>LwM2M Bootstrap-Server MUST encrypt and integrity protect data communicated to a LwM2M Client.</li>
</ul>
<p id="rfc.section.5.1.p.6">Due the sensitive nature of bootstrap information, a particular care has to be taken to ensure protection of that data.</p>
<p id="rfc.section.5.1.p.7">The use of DTLS fulfils these requirements.</p>
<h1 id="rfc.section.5.1.1">
<a href="#rfc.section.5.1.1">5.1.1.</a> <a href="#dtls-overview" id="dtls-overview">DTLS Overview</a>
</h1>
<p id="rfc.section.5.1.1.p.1">CoAP <a href="#RFC7252" class="xref">[RFC7252]</a> is secured using the Datagram Transport Layer Security (DTLS) 1.2 protocol <a href="#RFC6347" class="xref">[RFC6347]</a>, which is based on TLS v1.2 <a href="#RFC5246" class="xref">[RFC5246]</a>. The DTLS binding for CoAP is defined in Section 9 of <a href="#RFC7252" class="xref">[RFC7252]</a>. DTLS is a communication security solution for datagram based protocols (such as UDP). It provides a secure handshake with session key generation, mutual authentication, data integrity and confidentiality.</p>
<p id="rfc.section.5.1.1.p.2">This section provides information related to the use of DTLS for use with CoAP over DTLS over UDP as well as for use with CoAP over DTLS over SMS. Section &#8220;SMS Channel Security&#8221; provides additional information regarding the use of DTLS in an SMS context. This document uses the profiles defined in <a href="#RFC7925" class="xref">[RFC7925]</a>, which includes not only ciphersuites but also extensions.</p>
<p id="rfc.section.5.1.1.p.3">The DTLS client and the DTLS server SHOULD keep security state, such as session keys, sequence numbers, and initialization vectors, and other security parameters, established with DTLS for as long a period as can be safely achieved without risking compromise to the security context. If such state persists across sleep cycles where the RAM is powered off, secure storage SHOULD be used for the security context.</p>
<p id="rfc.section.5.1.1.p.4">The credentials used for authenticating the DTLS client and the DTLS server to secure the communication between the LwM2M Client and the LwM2M Server are obtained using one of the bootstrap modes defined in Section 5.2.2. Appendix E.1.1 of (TODO add Link to LWM2M-CORE) defines the format of the keying material stored in the LwM2M Security Object Instances.</p>
<p id="rfc.section.5.1.1.p.5">LwM2M Bootstrap-Servers, LwM2M Servers and LwM2M Clients MUST use different key pairs. LwM2M Clients MUST use keys, which are unique to each LwM2M Client. When a LwM2M Client is configured to utilize multiple LwM2M Servers then the LwM2M Bootstrap-Server may configure different credentials with these LwM2Ms Servers. Such configuration provides better unlinkability properties since each individual LwM2M Server cannot correlate request based on the credentials used by the LwM2M Client. Deployment and application specific considerations dictate what approach to use.</p>
<h1 id="rfc.section.5.1.2">
<a href="#rfc.section.5.1.2">5.1.2.</a> <a href="#ciphersuites" id="ciphersuites">Ciphersuites</a>
</h1>
<p id="rfc.section.5.1.2.p.1">DTLS supports the concept of ciphersuites and they are securely negotiated during the DTLS handshake. This specification recommends a limited number of ciphersuites based on <a href="#RFC7925" class="xref">[RFC7925]</a>. The recommended ciphersuites have been chosen because of suitability for IoT devices, security reasons and to improve interoperability and depend on the type of credential being used since the ciphersuite concept also indicates the authentication and key exchange mechanism. LwM2M Clients and LwM2M Servers MAY support additional ciphersuites that conform to state-of-the-art security requirements.</p>
<h1 id="rfc.section.5.1.3">
<a href="#rfc.section.5.1.3">5.1.3.</a> <a href="#bootstrapping" id="bootstrapping">Bootstrapping</a>
</h1>
<p id="rfc.section.5.1.3.p.1">The Resources in the LwM2M Security Object (i.e., &#8220;Security Mode&#8221;, &#8220;Public Key or Identity&#8221;, &#8220;Server Public Key or Identity&#8221; and &#8220;Secret Key&#8221;) are used</p>
<p></p>

<ol>
<li>for providing UDP channel security in &#8220;Client Registration&#8221;, &#8220;Device Management &amp; Service Enablement&#8221;, and &#8220;Information Reporting&#8221; Interfaces if the LwM2M Security Object Instance relates to a LwM2M Server, or,</li>
<li>for providing channel security in Bootstrap Interface if the LwM2M Security Object instance relates to a LwM2M Bootstrap-Server.</li>
<li>for protecting the communication with a firmware repository server when the LwM2M Client receives a URI in the Package URI of the Firmware Update object.</li>
</ol>
<p id="rfc.section.5.1.3.p.3">The content and the interpretation of the Resources in the LwM2M Security Object depend on the type of credential being used.</p>
<p id="rfc.section.5.1.3.p.4">Concerning Bootstrap from Smartcard a secure channel between the Smartcard and the LwM2M Client SHOULD be established, as described in Appendix G and defined in (TODO add links GLOBALPLATFORM 3 , GP SCP03). Using Smartcard with pre-shared secrets, raw public keys, and with certificates needs no pre-existing trust relationship between LwM2M Server(s) and LwM2M Client(s). The pre-established trust relationship is between the LwM2M Server(s) and the SmartCard(s).</p>
<p id="rfc.section.5.1.3.p.5">LwM2M Clients MUST either be provisioned for use with a LwM2M Server (manufacturer pre-configuration bootstrap mode) or else be provisioned for use with an LwM2M Bootstrap-Server. Any LwM2M Client, which supports client or server initiated bootstrap mode, MUST support at least one of the following secure methods:</p>
<p></p>

<ol>
<li>Bootstrapping with a strong (high-entropy) pre-shared secret, as described in Section &#8220;Pre-Shared Keys&#8221;. The ciphersuites defined in Section 7.1.7 MUST NOT be used with a low-entropy secret or with a password.</li>
<li>Bootstrapping with a raw public key or certificate-based method (as described in TODO add links Section &#8220;Raw Public Keys&#8221; and Section &#8220;X509 Certificates&#8221;.</li>
</ol>
<p id="rfc.section.5.1.3.p.7">In either case, the LwM2M Client MUST be provisioned with a credential that is unique to a device. For full interoperability, a LwM2M Bootstrap-Server MUST support bootstrapping via pre-shared secrets, raw public keys, and certificates.</p>
<p id="rfc.section.5.1.3.p.8">NOTE: The above security methods can also be used by the LwM2M Bootstrap-Server to provision KIc and KID for the SMS Secured Packet Structure mode (see Section TODO add link 7.2.2 for SMS Secured Packet Structure mode).</p>
<p id="rfc.section.5.1.3.p.9">Security credential dynamically provisioned to the LwM2M Client and the LwM2M Server MAY change at any time, even during the lifetime of an ongoing DTLS session. Since the DTLS protocol verifies the credentials only at the beginning of the session establishment (unless the re-negotiation feature is used) it is possible that a change in credential (for example, credentials for the use of a PSK-based ciphersuite) occurs after a DTLS handshake has already been completed and the DTLS session setup is already finalized. Hence, from a DTLS protocol point of view such a change is not recognized and the already established record layer security associations are in use. It is a policy decision for a DTLS client as well as a DTLS server implementation to tear down an already existing session when the credentials change. Such a decision will depend on various factors, such as the application domain in which LwM2M is used. The LwM2M specification does not mandate a specific behaviour in such a case since DTLS allows both communication parties to tear down an established DTLS session for any number of reasons.</p>
<h1 id="rfc.section.5.1.4">
<a href="#rfc.section.5.1.4">5.1.4.</a> <a href="#endpoint-client-name" id="endpoint-client-name">Endpoint Client Name</a>
</h1>
<p id="rfc.section.5.1.4.p.1">The LwM2M specification defines the use of the endpoint client name in the Bootstrap-Request and in the Register messages. Since the endpoint client name is not authenticated at the application layer the LwM2M Server MUST compare the received endpoint client name identifier with the identifier used at the DTLS handshake. This comparison may either be an equality match or may involve a dedicated lookup table to ensure that LwM2M Clients cannot intentionally or due to misconfiguration impersonate other LwM2M Clients. The LwM2M Server MUST respond with a &#8220;4.00 Bad Request&#8221; to the LwM2M Client if these fields do not match.</p>
<h1 id="rfc.section.5.1.5">
<a href="#rfc.section.5.1.5">5.1.5.</a> <a href="#lwm2m-and-dtls-roles" id="lwm2m-and-dtls-roles">LwM2M and DTLS Roles</a>
</h1>
<p id="rfc.section.5.1.5.p.1">The client-server roles of DTLS, which indicate who initiates the DTLS handshake, are independent from the client-server relationship of LwM2M. In client-initiated bootstrapping the LwM2M Client is also the DTLS client and the LwM2M Bootstrap Server acts as the DTLS server. For server-initiated bootstrapping, however, the roles are reversed: the LwM2M Client acts in the role of a DTLS server and the LwM2M Bootstrap Server is the DTLS client. Note that using a DTLS server on a LwM2M Client requires additional resources, such as RAM, and flash memory.</p>
<p id="rfc.section.5.1.5.p.2">When the LwM2M Client acts in the role of a DTLS server then care has to be taken that the following four values are equal:</p>
<p></p>

<ol>
<li>Value in the Server Name Indication (SNI) extension used in the DTLS exchange,</li>
<li>Endpoint Client Name,</li>
<li>Identifier used with the credential, such as the identifier contained in the DTLS server certificate, and</li>
<li>Value in the LwM2M Server URI Resource.</li>
</ol>
<p id="rfc.section.5.1.5.p.4">Note that the DTLS client (acting as the LwM2M Server) for the server-initiated bootstrapping has to be configured with the IP address of the LwM2M Client, an FQDN, and the certificate, raw public key or PSK for use with the LwM2M Client.</p>
<h1 id="rfc.section.5.1.6">
<a href="#rfc.section.5.1.6">5.1.6.</a> <a href="#pre-shared-keys" id="pre-shared-keys">Pre-Shared Keys</a>
</h1>
<p id="rfc.section.5.1.6.p.1">If a LwM2M Server supports the pre-shared key credentials it MUST support TLS_PSK_WITH_AES_128_CCM_8, as defined in <a href="#RFC6655" class="xref">[RFC6655]</a> and mandated in <a href="#RFC7925" class="xref">[RFC7925]</a>.</p>
<p id="rfc.section.5.1.6.p.2">A LwM2M Client MUST support the Pre-Shared Key mode of DTLS with at least one of the ciphersuites specified for the LwM2M Server.</p>
<p id="rfc.section.5.1.6.p.3">This mode requires the following resources of the Security Object defined in Appendix E.1 of TODO add link LWM2M-CORE) to be populated:</p>
<p></p>

<ul>
<li>The &#8220;Security Mode&#8221; Resource MUST contain the value 0.</li>
<li>The &#8220;Public Key or Identity&#8221; Resource MUST be used to store the PSK identity, defined in <a href="#RFC4279" class="xref">[RFC4279]</a>.</li>
<li>The &#8220;Secret Key&#8221; Resource MUST be used to store the PSK, defined in <a href="#RFC4279" class="xref">[RFC4279]</a>.</li>
<li>The &#8220;Server Public Key&#8221; Resource MUST NOT be used in the Pre-Shared Key mode.</li>
</ul>
<h1 id="rfc.section.5.1.7">
<a href="#rfc.section.5.1.7">5.1.7.</a> <a href="#raw-public-keys" id="raw-public-keys">Raw Public Keys</a>
</h1>
<p id="rfc.section.5.1.7.p.1">If a LwM2M Server supports the raw public key credentials it MUST support TLS_ECDHE_ECDSA_WITH_AES_128_CCM_8, as defined in <a href="#RFC6655" class="xref">[RFC6655]</a> and mandated in <a href="#RFC7925" class="xref">[RFC7925]</a>.</p>
<p id="rfc.section.5.1.7.p.2">If a LwM2M Client supports the raw public key mode it MUST support at least one of the ciphersuites supported by the LwM2M Server.</p>
<p id="rfc.section.5.1.7.p.3">This mode requires the following resources of the Security Object defined in Appendix E.1 of (TODO add link LWM2M-CORE) to be populated:</p>
<p></p>

<ul>
<li>The &#8220;Security Mode&#8221; Resource MUST contain the value 1.</li>
<li>The &#8220;Public Key or Identity&#8221; Resource MUST be used to store the raw public key of the DTLS client.</li>
<li>The &#8220;Secret Key&#8221; Resource MUST be used to store the private key of the DTLS client.</li>
<li>The &#8220;Server Public Key&#8221; Resource MUST be used to store the raw public key of the DTLS server.</li>
</ul>
<p id="rfc.section.5.1.7.p.5">This security mode is appropriate for LwM2M deployments where the benefits of asymmetric cryptography are used but without the overhead of the public key infrastructure.</p>
<p id="rfc.section.5.1.7.p.6">The DTLS client MUST check that the raw public key presented by the DTLS server exactly matches this stored public key.</p>
<p id="rfc.section.5.1.7.p.7">The DTLS server MUST store its own private and public keys, and MUST have a stored copy of the expected client public key. The DTLS server MUST check that the raw public key presented by the DTLS client exactly matches this stored public key.</p>
<h1 id="rfc.section.5.1.8">
<a href="#rfc.section.5.1.8">5.1.8.</a> <a href="#x509-certificates" id="x509-certificates">X.509 Certificates</a>
</h1>
<p id="rfc.section.5.1.8.p.1">The X.509 Certificate mode requires the use of X.509v3 certificates <a href="#RFC5280" class="xref">[RFC5280]</a>.</p>
<p id="rfc.section.5.1.8.p.2">If a LwM2M Server supports X.509 Certificate mode it MUST support TLS_ECDHE_ECDSA_WITH_AES_128_CCM_8, as defined in <a href="#RFC7251" class="xref">[RFC7251]</a> and mandated in <a href="#RFC7925" class="xref">[RFC7925]</a>.</p>
<p id="rfc.section.5.1.8.p.3">If a LwM2M Client supports X.509 Certificate mode it MUST support at least one of the above mentioned ciphersuites.</p>
<p id="rfc.section.5.1.8.p.4">This mode requires the following resources of the Security Object defined in Appendix E.1 of (TODO add link LWM2M-CORE) to be populated:</p>
<p></p>

<ul>
<li>The &#8220;Security Mode&#8221; Resource MUST contain the value 2.</li>
<li>The &#8220;Public Key or Identity&#8221; Resource MUST be used to store the X.509 certificate of the DTLS client, or optional its complete certification path (including client certificate but not the trust anchor).</li>
<li>The &#8220;Secret Key&#8221; Resource MUST be used to store the private key of the DTLS client.</li>
<li>The &#8220;Server Public Key&#8221; Resource MUST be used to store either a trust anchor certificate suitable for path validation of the certificate of the DTLS server, or directly the certificate of the DTLS server (&#8220;domain-issued certificate mode&#8221;). The use of it is explained in more detail below.</li>
</ul>
<p id="rfc.section.5.1.8.p.6">The &#8220;LwM2M Server URI&#8221;, and the &#8220;Bootstrap Server&#8221; Resources are populated according to the description in Appendix E.1 of (TODO add link LWM2M-CORE).</p>
<p id="rfc.section.5.1.8.p.7">The algorithm for verifying the service identity, as described in Section 4.4.1 of <a href="#RFC7925" class="xref">[RFC7925]</a> and in <a href="#RFC6125" class="xref">[RFC6125]</a>, is essential for ensuring proper security when certificates are used and MUST be implemented and used by the DTLS client. Terms like reference identifier and presented identifier are defined in <a href="#RFC6125" class="xref">[RFC6125]</a>.</p>
<p id="rfc.section.5.1.8.p.8">Comparing the reference identifier against the presented identifier obtained from the certificate is required to ensure the DTLS client is communicating with the intended DTLS server. To cater for the case that the Server Public Key Resource directly contains the certificate of the DTLS server, DTLS client does not compare the reference identifier against the presented identifier if the certificate from the Server Public Key Resource matches the certificate provided by the DTLS server during the DTLS handshake. If that is not the case, the DTLS client MUST compare the reference identifier against the presented identifier as described below, and perform path validation.</p>
<p id="rfc.section.5.1.8.p.9">The algorithm description from RFC 6125 assumes that fully qualified DNS domain names (FQDN) are used. If a server node is provisioned with a FQDN, then the DTLS server certificate MUST contain this &#8220;FQDN&#8221;. This FQDN is stored in the SubjectAltName or in Common Name (CN) component of the subject name, as explained in Section 9.1.3.3 of <a href="#RFC7252" class="xref">[RFC7252]</a>, and used by the DTLS client to match it against the FQDN used during the lookup process, as described in <a href="#RFC6125" class="xref">[RFC6125]</a>.</p>
<p id="rfc.section.5.1.8.p.10">Note that the Server Name Indication (SNI) extension <a href="#RFC6066" class="xref">[RFC6066]</a> allows a DTLS client to tell a DTLS server the name of the DTLS server it is contacting. This is an important feature when the server is part of a hosting solution where multiple virtual servers are using a single underlying network address. Section 3 of <a href="#RFC6066" class="xref">[RFC6066]</a> only allows FQDN hostname of the DTLS server in the ServerName field. For the DTLS client running on a LwM2M Server the SNI extension allows the LwM2M Server to indicate what certificate it is expecting. The SNI extension MUST be set by the LwM2M client.</p>
<p id="rfc.section.5.1.8.p.11">In some deployment scenarios DNS is not used and hence LwM2M Clients need to follow a different procedure.</p>
<p id="rfc.section.5.1.8.p.12">If the CoAP URI stored in the &#8220;LwM2M Server URI&#8221; Resource contains an IP literal, such as <samp>coaps://[2001:db8::2:1]/</samp>, then certificate provided by the server MUST also contain this IP address in the Common Name (CN) component of the server certificate or in a field of URI type in the SubjectAltName set.</p>
<p id="rfc.section.5.1.8.p.13">The procedure for a client using such certificates is as follows:</p>
<p></p>

<ul>
<li>The LwM2M Client uses the IP address from the LwM2M Server URI Resource to connect to the LwM2M Server using a DTLS handshake. The IP address becomes the reference identifier.</li>
<li>The DTLS stack of the LwM2M Server returns a Certificate message as part of the handshake that contains a certificate. The IP address extracted from the server certificate becomes the presented identifier.</li>
<li>The client matches the reference identifier against the presented identifier. If the two match, the client continues with the certificate verification according to RFC 5280, otherwise it aborts the handshake with a fatal alert.</li>
</ul>
<p id="rfc.section.5.1.8.p.15">Note: In case no FQDN but IP addresses are used ,and the IP address of the LwM2M server changes, the IP address contained in the LwM2M Server URI Resource will naturally also need to be updated. As a result, in case the &#8220;Server Public Key&#8221; contains a trust anchor certificate, a new certificate for that LwM2M Server needs to be created.</p>
<p id="rfc.section.5.1.8.p.16">The use of certificates might require the DTLS client to understand the concept of time since it might need to check the validity of the server-provided certificate if required by the deployment. Different deployments may have different means of obtaining the current time and this specification does not mandate one mechanism. In general, the LwM2M Bootstrap-Server certificate is not expected to expire during the lifetime of the LwM2M Client since it has no easy possibility to recover from such an expired certificate. However, if the LwM2M Client determines that the LwM2M Server certificate is expired it MAY contact the LwM2M Bootstrap-Server to obtain new security credentials for use with the LwM2M Server.</p>
<p id="rfc.section.5.1.8.p.17">Note that the LwM2M Device Object allows the LwM2M Bootstrap-Server to configure the current time for the LwM2M Client using the Current Time Resource.</p>
<h1 id="rfc.section.5.1.9">
<a href="#rfc.section.5.1.9">5.1.9.</a> <a href="#nosec-mode" id="nosec-mode">&#8220;NoSec&#8221; mode</a>
</h1>
<p id="rfc.section.5.1.9.p.1">It is highly recommended to always protect the LwM2M protocol with DTLS. There are, however, scenarios where the LwM2M protocol is deployed in environments where lower layer security mechanisms are provided.</p>
<p id="rfc.section.5.1.9.p.2">The LwM2M Server MUST compare the endpoint client name identifier used during the Register and the Bootstrap-Request message with the identifier used for network access authentication (typically used to setup link layer security procedures).</p>
<p id="rfc.section.5.1.9.p.3">The LwM2M protocol may use the NoSec mode with or without a lower-layer security mechanism and matching the endpoint client name identifier with any lower layer identifier may in the latter case not be possible.</p>
<h1 id="rfc.section.5.1.10">
<a href="#rfc.section.5.1.10">5.1.10.</a> <a href="#certificate-mode-with-est" id="certificate-mode-with-est">Certificate mode with EST</a>
</h1>
<p id="rfc.section.5.1.10.p.1">This mode uses the configuration of the certificate mode defined in Section 7.1.9 with the following changes; instead of generating the certificate and the private key for the client by the LwM2M Bootstrap Server and to provision it to the LwM2M Client the Bootstrap Server MUST set the &#8220;Security Mode&#8221; Resource to value 4 and provisions the certificate of the DTLS server to the &#8220;Server Public Key&#8221; Resource. This triggers the LwM2M Client to locally generate a public / private key pair on the LwM2M Client and to initiate an EST over CoAP protocol exchange (TODO add link to CoAP-EST) to obtain a certificate. The EST over CoAP specification (TODO add link to CoAP-EST) profiles the use of EST for use in constrained environments.</p>
<p id="rfc.section.5.1.10.p.2">When generating a public / private key pair, the random generator used by the LwM2M Client MUST respect the characteristics of a sufficiently high quality random bit generator, such as defined for example by ISO/IEC 18031:2011, RFC 4086 <a href="#RFC4086" class="xref">[RFC4086]</a> or NIST Special Publication 800-90a (TODO add link to SP800-90A).</p>
<p id="rfc.section.5.1.10.p.3">Compared to the certificate mode additional over-the-air overhead is introduced by this mode since the LwM2M Client needs to convey the public key to the EST server and needs to demonstrate possession of the private key using the PKCS#10 defined mechanism, as referenced in the EST specification. Depending on the deployment environment this additional overhead needs to be compared against the added security benefit of not disclosing the private key to other parties.</p>
<p id="rfc.section.5.1.10.p.4">The &#8220;Secret Key&#8221; and the &#8220;Public Key or Identity&#8221; Resources are not used by this mode. The &#8220;LwM2M Server URI&#8221;, and the &#8220;Bootstrap Server&#8221; Resources are populated according to the description in Appendix E.1.</p>
<p id="rfc.section.5.1.10.p.5">Enrollment over Secure Transport (EST) offers multiple features, including</p>
<p></p>

<ul>
<li>Simple PKI messages,</li>
<li>CA certificate retrieval,</li>
<li>CSR Attributes Request,</li>
<li>Server-generated key request,</li>
</ul>
<p id="rfc.section.5.1.10.p.7">but only the first two are mandatory to implement.</p>
<p id="rfc.section.5.1.10.p.8">In context of this specification functionality for server-generated key requests is already covered as part of the security mode (1 - Raw Public Key mode and 2 - Certificate mode). CSR Attributes Request is also not required for this specification either since the LwM2M Bootstrap Server is typically in possession of the required attributes for generating a certificate. The CA certificate retrieval, while mandatory to implement for EST, is not used by version 1.0 of this specification since only the domain issued certificate mode is supported, as described in Section 7.1.9. Hence, CA certificates are not utilized.</p>
<h1 id="rfc.section.5.2">
<a href="#rfc.section.5.2">5.2.</a> <a href="#sms-channel-security" id="sms-channel-security">SMS Channel Security</a>
</h1>
<p id="rfc.section.5.2.p.1">Channel security for [CoAP] has been defined for the UDP transport and is based on the Datagram Transport Layer Security (DTLS) <a href="#RFC6347" class="xref">[RFC6347]</a></p>
<p id="rfc.section.5.2.p.2">This section defines the security modes for the transport of CoAP over SMS.</p>
<p id="rfc.section.5.2.p.3">LwM2M Clients supporting SMS, when the SMS Channel is only used for debugging purposes MAY support the NoSec mode.</p>
<p id="rfc.section.5.2.p.4">LwM2M Clients supporting UDP and SMS, when the SMS Channel is only used for triggering as defined in chapter 8.4 MUST support the adequate mechanism for securing UDP Channel as defined in chapter 7.1 UDP channel security. Those clients MAY use any SMS security mode. In particular SMS NoSec mode can be used for SMS triggering since all other communication will be secured by UDP channel security.</p>
<p id="rfc.section.5.2.p.5">Using SMS NoSec for SMS triggering could induce issues as &#8220;Denial of Service&#8221; (DoS), SMS auto reply attacks (based on PoR:) and is strongly not recommended.</p>
<p id="rfc.section.5.2.p.6">LwM2M Clients supporting SMS for communications other than triggering, or supporting only the SMS Channel MUST support SMS Secured Mode. In any security mode except for debugging purposes, when an SMS message is received from an MSISDN that is not recorded in the LwM2M Server SMS Number resource of the LwM2M Server Access Security, the SMS message MUST be silently ignored.</p>
<h1 id="rfc.section.5.2.1">
<a href="#rfc.section.5.2.1">5.2.1.</a> <a href="#sms-nosec-mode" id="sms-nosec-mode">SMS &#8220;NoSec&#8221; Mode</a>
</h1>
<p id="rfc.section.5.2.1.p.1">It is highly recommended to always use LwM2M with one of the security mechanisms described in this section. However, there are few scenarios and use cases where security is provided by lower layers. For example, LwM2M devices in a controlled environment behind a gateway, or, tests focussing first on other functions before performing end-to-end tests including security.</p>
<p id="rfc.section.5.2.1.p.2">This security profile is also useful to support SMS triggering when all other exchanges run over UDP Channel.</p>
<h1 id="rfc.section.5.2.2">
<a href="#rfc.section.5.2.2">5.2.2.</a> <a href="#sms-secured-mode" id="sms-secured-mode">SMS Secured Mode</a>
</h1>
<p id="rfc.section.5.2.2.p.1">The SMS Secured mode specified in this section MUST be supported when the SMS binding is used.</p>
<p id="rfc.section.5.2.2.p.2">A LwM2M Client which uses the SMS binding MUST either be directly provisioned for use with a target LwM2M Server (Factory Bootstrap or Bootstrap from Smartcard) or else be able to bootstrap via the UDP binding.</p>
<p id="rfc.section.5.2.2.p.3">The end-point for the SMS channel (delivery of mobile terminated SMS, and sending of mobile originated SMS) MAY be either on the Smartcard or on the Device. When the LwM2M Client device doesn&#8217;t support a Smartcard, the end-point is on the LwM2M Client device.</p>
<p id="rfc.section.5.2.2.p.4">A LwM2M Client, Server or Bootstrap-Server supporting SMS binding MUST discard SMS messages which are not correctly protected using the expected parameters stored in the &#8220;SMS Binding Key Parameters&#8221; Resource and the expected keys stored in the &#8220;SMS Binding Secret Keys&#8221; Resource, and MUST NOT respond with an error message secured using the correct parameters and keys.</p>
<h1 id="rfc.section.5.2.3">
<a href="#rfc.section.5.2.3">5.2.3.</a> <a href="#device-end-point" id="device-end-point">Device End-Point</a>
</h1>
<p id="rfc.section.5.2.3.p.1">The Secured Packet Structure is based on (TODO add ref to 3GPP TS 31 115 and ETSI TS 102 225) which was originally designed for securing packet structures for UICC based applications. However, for LwM2M it is suitable for securing the SMS payload exchanged between client and server. Usage of Secured Packet Structure Packet mode in LwM2M device needs evolution towards the introduction of a secure environment. The intention is to evolve the specifications in the next LwM2M release.</p>
<p id="rfc.section.5.2.3.p.2">In LwM2M Enabler 1.0 if the SMS channel end-point is on the Device, the Channel security for [CoAP] is based on the Datagram Transport Layer Security (DTLS) <a href="#RFC6347" class="xref">[RFC6347]</a>. For that reason the main lines of Section 7.1 on &#8220;DTLS-based Security&#8221; relative to DTLS binding on CoAP are also applicable to that section.</p>
<p id="rfc.section.5.2.3.p.3">Appendix A of <a href="#RFC7925" class="xref">[RFC7925]</a> describes how to bind CoAP/DTLS message to the SMS channel and specifies the restrictions on DTLS for fitting the SMS channel specific functioning and narrow bandwidth.</p>
<p><strong>Header Definitions (for one SMS)</strong></p>
<p id="rfc.section.5.2.3.p.5">a) SMS Frame for basic Request/Response Interaction message (no Token field required) <a href="#smsframe" class="xref">Figure 5</a>.</p>
<div id="rfc.figure.5"></div>
<div id="smsframe"></div>
<pre>
|----------------------------------------------------------------------------------------|
|                                 TPDU (140 bytes)                                       |
|------------------------------------|---------------------------------------------------|
| DTLS (29 bytes)                    | CoAP + Effective Payload                          |
|------------------------------------|---------------------------------------------------|
| Header (13), Nonce (8), IV (8)     |                                                   |
|------------------------------------|---------------------------------------------------|
|                                    | CoAP ( 4 bytes)  | Effective Payload ( 107 bytes) |
|------------------------------------|---------------------------------------------------|
</pre>
<p class="figure">Figure 5: Basic SMS Frame</p>
<p id="rfc.section.5.2.3.p.6">Model calculation using these header definitions, overall TPDU : 140 bytes</p>
<p></p>

<ul>
<li>DTLS requires 29 bytes: 13 bytes header according to (RFC 6347 and Appendix B of <a href="#RFC7925" class="xref">[RFC7925]</a> + 8 bytes for the explicit nonce and 8 bytes for the integrity check value when an AES-128-CCM-8 ciphersuite is used. This ciphersuite uses a short integrity check value.</li>
<li>CoAP header of variable length with at least 4 bytes <a href="#RFC7252" class="xref">[RFC7252]</a>.</li>
<li>Available bytes for the effective LwM2M payload from one SMS: 107 bytes.</li>
</ul>
<p id="rfc.section.5.2.3.p.8">b) SMS Frame for messages of the Information Reporting Interface (Token field required) <a href="#smsframe2" class="xref">Figure 6</a>.</p>
<div id="rfc.figure.6"></div>
<div id="smsframe2"></div>
<pre>
|----------------------------------------------------------------------------------------|
|                                 TPDU (140 bytes)                                       |
|------------------------------------|---------------------------------------------------|
| DTLS (29 bytes)                    | CoAP + Effective Payload                          |
|------------------------------------|---------------------------------------------------|
| Header (13), Nonce (8), IV (8)     |                                                   |
|------------------------------------|---------------------------------------------------|
|                                    | CoAP ( 4+8 bytes) | Effective Payload ( 99 bytes) |
|------------------------------------|---------------------------------------------------|
</pre>
<p class="figure">Figure 6: SMS Frame for Information Reporting Interface</p>
<p id="rfc.section.5.2.3.p.9">Model calculation using these header definitions,</p>
<p></p>

<ul>
<li>DTLS takes 29 bytes: 13 bytes <a href="#RFC6347" class="xref">[RFC6347]</a> of header + 16 bytes of integrity check for CoAP in DTLS <a href="#RFC6655" class="xref">[RFC6655]</a> . Cipher suite mandated by CoAP (AES-128).</li>
<li>CoAP header 4+8 <a href="#RFC7252" class="xref">[RFC7252]</a> (Token field required).</li>
<li>Available bytes for the effective LwM2M Payload from one SMS: 99 bytes.</li>
</ul>
<h1 id="rfc.section.5.2.4">
<a href="#rfc.section.5.2.4">5.2.4.</a> <a href="#smartcard-end-point" id="smartcard-end-point">Smartcard End-Point</a>
</h1>
<p id="rfc.section.5.2.4.p.1">If the SMS channel end-point is on the smart card, a CoAP message as defined in <a href="#RFC7252" class="xref">[RFC7252]</a> MUST be encapsulated in (TODO 3GPP 31.115) Secured Packets, in implementing - for SMS Point to Point (SMS_PP) - the general (TODO ETSI 102 225) specification for UICC based applications.</p>
<p id="rfc.section.5.2.4.p.2">The following settings MUST be applied:</p>
<p id="rfc.section.5.2.4.p.3">Class 2 SMS as specified in (TODO 3GPP TS 23.038). The (TODO 3GPP TS 23.040) SMS header MUST be defined as below:</p>
<p></p>

<ul>
<li>TP-PID : 111111 (USIM Data Download) as specified in (TODO 3GPP TS 23.040)</li>
<li>TP-OA : the TP-OA (originating address as defined in (TODO 3GPP 23.040) of an incoming command packet (e.g CoAP request) MUST be re-used as the TP-DA of the outgoing packet (e.g CoAP response)</li>
</ul>
<p><strong>Secure SMS Transfer to UICC</strong></p>
<p id="rfc.section.5.2.4.p.6">A SMS Secured Packet encapsulating a CoAP request received by the LwM2M device, MUST be &#8211; according to (TODO ETSI TS 102 225 and 3GPP TS 31.115) - addressed to the LwM2M UICC Application in the Smartcard where it will be decrypted, aggregated if needed, and checked for integrity.</p>
<p id="rfc.section.5.2.4.p.7">If decryption and integrity verification succeed, the message contained in the SMS MUST be provided to the LwM2M Client.</p>
<p id="rfc.section.5.2.4.p.8">If decryption or integrity verification failed, SMS MUST be discarded.</p>
<p id="rfc.section.5.2.4.p.9">The mechanism for providing the decrypted CoAP Request to the LwM2M Client relies on basic GET_DATA commands of (TODO GP SCP03) .This data MUST follow the format as below:</p>
<div id="rfc.figure.7"></div>
<div id="sampledata"></div>
<pre>
  data_rcv _ ::= &lt;address&gt; &lt;coap_msg&gt;

  address ::= TP_OA ; originated address

  coap_msg ::= CoAP_TAG &lt;coap_request_length&gt; &lt;coap_request&gt;

  coap_request_length ::= 16BITS_VALUE

  coap_request ::= CoAP message payload
</pre>
<p class="figure">Figure 7</p>
<p id="rfc.section.5.2.4.p.10">NOTE: In current LwM2M release, the way the LwM2M Client Application is triggered for retrieving the available message from the Smartcard is device specific: i.e. a middle class LwM2M Device implementing (TODO ETSI TS 102 223) ToolKit with class &#8220;e&#8221; and &#8220;k&#8221; support could be automatically triggered by Toolkit mechanisms, whereas a simpler LwM2M device could rely on a polling mechanisms on Smartcard for fetching data when available.</p>
<p><strong>Secured SMS Transfer to LwM2M Server</strong></p>
<p id="rfc.section.5.2.4.p.12">For sending a CoAP message to the LwM2M Server, the LwM2M Client prepares a data containing the right TP-DA to use, concatenated with the CoAP message and MUST provide that data to the LwM2M UICC Application in using the [GP SCP03] STORE-DATA command.</p>
<p id="rfc.section.5.2.4.p.13">According to (TODO ETSI TS 102 225 and 3GPP TS 31.115) the Smartcard will be in charge to prepare (encryption / concatenation) the CoAP message before sending it as a SMS Secure Packet (TODO ETSI TS 102 223) SEND_SMS command).</p>
<p id="rfc.section.5.2.4.p.14">The SMS Secured Packet MUST be formatted as Secured Data specified in section TODO 7.2.2.3.</p>
<p id="rfc.section.5.2.4.p.15">The Secure Channel as specified in Appendix H of this document SHOULD be used to provide the prepared data to the Smartcard.</p>
<h1 id="rfc.section.5.2.5">
<a href="#rfc.section.5.2.5">5.2.5.</a> <a href="#sms-secured-packet-binding-for-coap-messages" id="sms-secured-packet-binding-for-coap-messages">SMS Secured Packet Binding for CoAP messages</a>
</h1>
<p id="rfc.section.5.2.5.p.1">In SMS Secured Packet Structure mode, a CoAP message as defined in <a href="#RFC7252" class="xref">[RFC7252]</a> MUST be encapsulated in (TODO 3GPP 31.115) Secured Packets, in implementing - for SMS Point to Point (SMS_PP) - the general (TODO ETSI 102 225) specification for UICC based applications.</p>
<p></p>

<ul>
<li>The &#8220;Command Packet&#8221; command specified in (TODO 3GPP 31.115)/(TODO ETSI 102 225) MUST be used for both CoAP Request and Response message</li>
<li>The Structure of the Command Packet contained in the Short Message MUST follow (TODO 3GPP 31.115) specification</li>
<li>SPI MUST be set as follow (see coding of SPI in (TODO ETSI TS 102 225) section 5.2.1):  <ul>
<li>use of cryptographic checksum</li>
<li>use of ciphering      <ul>
<li>The ciphering and crypto graphic checksum MUST use either AES or Triple DES</li>
<li>Single DES MUST NOT be used</li>
<li>AES SHOULD be used</li>
<li>When Triple DES is used , then it MUST be used in outer CBC mode and 3 different keys MUST be used</li>
<li>When AES is used it MUST be used with CBC mode for ciphering (see coding of KIc in (TODO ETSI TS 102 225) section 5.2.2) and in CMAC mode for integrity (see coding of KID in (TODO ETSI TS 102 225) section 5.2.3).</li>
</ul>
</li>
<li>process if and only if counter value is higher than the value in the RE</li>
<li>PoR depends on LwM2M Server Policy</li>
</ul>
</li>
<li>TAR MUST be set to &#8216;B2 02 03&#8217; value for the LwM2M UICC Application as registered in (TODO ETSI TS 101 220) Appendix D</li>
<li>Secured Data : contains the Secured Application Message which MUST be coded as a BER-TLV, the Tag (TBD : e.g 0x05) will indicate the type (e.g CoAP type) of that message.</li>
</ul>
<h1 id="rfc.section.5.3">
<a href="#rfc.section.5.3">5.3.</a> <a href="#lpwa-security" id="lpwa-security">LPWA Security</a>
</h1>
<p id="rfc.section.5.3.p.1">Low Power Wide Area (LPWA) networks are dedicated networks for communications with very resource constrained devices. Such devices are often battery driven and have limited processing capabilities.</p>
<p id="rfc.section.5.3.p.2">LWM2M can be deployed as a &#8220;thin&#8221; service layer providing security in LPWA scenarios since LWM2M has been designed to keep the requirements of constrained devices in mind. However, some of the LPWA radio technologies offer their own link layer security mechanisms, which need to be considered when offering additionally LWM2M security based on DTLS. For example, when deploying link layer security as well as DTLS together the resulting double encryption (for some part of communication path) will result in higher power consumption and additional transmission overhead, which might not be acceptable for a range of battery driven devices.</p>
<p id="rfc.section.5.3.p.3">In case the LPWA network offers link layer security and the threat analysis concluded that no additional communication security at higher layers, such as with DTLS, is necessary, the LWM2M &#8220;NoSec&#8221; mode MAY be used. Protecting LWM2M communication using DTLS remains a deployment choice. Protocol designers may need to take into account that the link layer security mechanism typically terminates at a different node than security mechanisms offered at higher layers and solely relying on link layer security may leave some segment of the communication path unprotected.</p>
<p id="rfc.section.5.3.p.4">Examples of LPWA network security mechanisms can, for example, be found in TS 33.401 &#8220;SAE, Security architecture&#8221; describes the keys and processes for Narrow band IoT (TODO NB-IoT) security based on what is called &#8220;end-to-middle (e2m) security&#8221; from the device to the 3GPP network.</p>
<p id="rfc.section.5.3.p.5">When using LWM2M security based on DTLS in a LPWA environment it is recommended to consider the work done in IETF on &#8220;DTLS In Constrained Environments&#8221; (TODO DICE), see (TODO REF draft-ietf-dice-profile-17). (TODO REF draft-ietf-dice-profile-17) does not introduce any changes to DTLS and TLS but rather offers guidance for use of various extensions for increased interoperability, and gives recommendations for improving the handshake procedures.</p>
<p id="rfc.section.5.3.p.6">(TODO REF draft-ietf-dice-profile-17) gives recommendations for three types of credentials, namely pre-shared keys, raw public keys, and X.509 certificates. LWM2M works with all three types of credentials but the performance and security trade-offs for these three mechanisms are different. As a summary, the three credential types have the following properties:</p>
<p></p>

<ul>
<li>The pre-shared key profile offers the most efficient solution for integration of DTLS into LWM2M since DTLS pre-shared ciphersuites recommended in (TODO REF draft-ietf-dice-profile-17) are computationally efficient (since they use the most efficient cryptographic primitives), and require a minimum amount of flash as well as RAM. The size of the exchanged messages is also kept at a minimum. There is, however, a downside as well: symmetric keys need to be available to both communication endpoints.</li>
<li>The certificate-based profile re-uses widely used X.509 certificates. This allows both tools as well as existing infrastructure, such as Certification Authorities (CAs), to be re-used. Unlike the typical web browser use of certificates the DICE profile (TODO REF draft-ietf-dice-profile-17) uses certificates for clients and servers. The use of certificates comes at a price. The use of asymmetric cryptography is more complex to implement, requires more bandwidth for the exchanged messages, is computationally more demanding, and requires a larger code size as well as more RAM. The benefits are, in addition to the re-use of existing technologies, the need to only share the certificates (and the public key that is contained inside the certificate) with other communication partners and to keep the private key local to each party. This property of asymmetric cryptography reduces the risk of exposing private keying material.</li>
<li>The raw public key profile offers features that sit between the pre-shared key and the certificate-based profile and combines the benefits of these two profiles. The use of asymmetric cryptography offers improved security but avoids the overhead associated with certificates and the PKI.</li>
</ul>
<p id="rfc.section.5.3.p.8">For purpose of DTLS usage with LWM2M over LWPAN this specification RECOMMENDs the implementation and use of the pre-shared key profile primarily due to the over-the-wire communication overhead. Deployments MAY implement other profiles as well. The subsequent text summarizes the key aspects of the pre-shared key profile described in (TODO REF draft-ietf-dice-profile-17) which is based on TLS_PSK_WITH_AES_128_CCM_8 that uses the AES-128-based without offering perfect forward secrecy:</p>
<p></p>

<ul>
<li>The Maximum Fragment Length extension described in Section 15 of (TODO  REF draft-ietf-dice-profile-17) allows a client to lower their RAM requirements and client implementations MUST implement this extension. Without this extension a client is required to maintain a maximum buffer size of 16KB.</li>
<li>Session resumption, described in Section 7 of (TODO REF draft-ietf-dice-profile-17), offers slightly improved performance for a PSK-based ciphersuite and is RECOMMENDED. Session resumption allows a client to abbreviate the handshake based on session state established in an executed full handshake. This results in fewer messages and smaller message sizes. It is therefore RECOMMENDED to maintain session state information as long as possible (consistent with the security requirement to protect session key material on both Client and Server; e.g. a long-lived session key must be managed at least as securely as an underlying pre-shared key).</li>
<li>Compression offered by DTLS is NOT RECOMMENDED due to security attacks, as described in Section 8 of (TODO REF draft-ietf-dice-profile-17). Compression functionality is better offered by higher layer protocols and various components used in LWM2M make use of compression techniques, such as CoAP with header compression, and the binary encoding of payloads.  The timeout recommendations provided in Section 11 of (TODO REF draft-ietf-dice-profile-17) MUST be followed since the modified timer settings prevent spurious retransmissions. Failure to increase the timeout value can lead to failed protocol exchanges.</li>
<li>A number of DTLS extensions are not applicable or are not recommended for use with the PSK-based ciphersuite and the recommendations made throughout (TODO REF draft-ietf-dice-profile-17) have to be taken into account. Note that the use of False Start, described in Section 21 of (TODO REF draft-ietf-dice-profile-17), is not required since the ability to transmit application data earlier is less important with long-lived DTLS sessions.</li>
</ul>
<p id="rfc.section.5.3.p.10">The guidance for credential-based profile can be found in Section 4.4 of (TODO REF draft-ietf-dice-profile-17) and guidance for the raw public key profile can be found in Section 4.3 of (TODO REF draft-ietf-dice-profile-17). Both profiles use Elliptic Curve Cryptography algorithms and offer perfect forward secrecy, as described in Section 9 of (TODO REF draft-ietf-dice-profile-17).</p>
<h1 id="rfc.section.6">
<a href="#rfc.section.6">6.</a> <a href="#iana-considerations" id="iana-considerations">IANA Considerations</a>
</h1>
<h1 id="rfc.section.6.1">
<a href="#rfc.section.6.1">6.1.</a> <a href="#resource-type-rt-link-target-attribute-values-registry" id="resource-type-rt-link-target-attribute-values-registry">Resource Type (rt=) Link Target Attribute Values Registry</a>
</h1>
<p id="rfc.section.6.1.p.1">TODO This document should add the various (rt=) Link Attributes that it uses. It adds the following resource type to the &#8220;Resource Type (rt=) Link Target Attribute Values&#8221;, within the &#8220;Constrained RESTful Environments (CoRE) Parameters&#8221; registry.</p>
<table cellpadding="3" cellspacing="0" class="tt full left">
<thead><tr>
<th class="left">Value</th>
<th class="left">Description</th>
<th class="left">Reference</th>
</tr></thead>
<tbody>
<tr>
<td class="left">omadm.valuexxx</td>
<td class="left">OMA value</td>
<td class="left">RFC XXXX</td>
</tr>
<tr>
<td class="left">omadm.valuexxx</td>
<td class="left">OMA value</td>
<td class="left">RFC XXXX</td>
</tr>
<tr>
<td class="left">omadm.valuexxx</td>
<td class="left">OMA value</td>
<td class="left">RFC XXXX</td>
</tr>
</tbody>
</table>
<p id="rfc.section.6.1.p.2">// RFC Ed.: replace RFC XXXX with this RFC number and remove this note. OMA should request that to IANA.</p>
<h1 id="rfc.section.6.2">
<a href="#rfc.section.6.2">6.2.</a> <a href="#coap-content-formats-registry" id="coap-content-formats-registry">CoAP Content-Formats Registry</a>
</h1>
<p id="rfc.section.6.2.p.1">TODO This document adds the following Content-Format to the &#8220;CoAP Content-Formats&#8221;, within the &#8220;Constrained RESTful Environments (CoRE) Parameters&#8221; registry.</p>
<table cellpadding="3" cellspacing="0" class="tt full left">
<thead><tr>
<th class="left">Media Type</th>
<th class="left">Excoding ID</th>
<th class="left">Reference</th>
</tr></thead>
<tbody>
<tr>
<td class="left">application/oma+JSON</td>
<td class="left">XXX</td>
<td class="left">RFC XXXX</td>
</tr>
<tr>
<td class="left">application/oma+CBOR</td>
<td class="left">XXX</td>
<td class="left">RFC XXXX</td>
</tr>
<tr>
<td class="left">application/oma+TLV</td>
<td class="left">XXX</td>
<td class="left">RFC XXXX</td>
</tr>
<tr>
<td class="left">application/oma+SenML</td>
<td class="left">XXX</td>
<td class="left">RFC XXXX</td>
</tr>
</tbody>
</table>
<p id="rfc.section.6.2.p.2">// RFC Ed.: replace XXX with assigned IDs and remove this note.  // RFC Ed.: replace RFC XXXX with this RFC number and remove this note.</p>
<h1 id="rfc.section.7">
<a href="#rfc.section.7">7.</a> <a href="#acknowledgements" id="acknowledgements">Acknowledgements</a>
</h1>
<p id="rfc.section.7.p.1">The authors would like to thank Jaime Jim&#233;nez for his work as editor of this document.  They would also like to thank the OMA organization for providing support to make this work possible.</p>
<h1 id="rfc.references">
<a href="#rfc.references">8.</a> References</h1>
<h1 id="rfc.references.1">
<a href="#rfc.references.1">8.1.</a> Normative References</h1>
<table><tbody>
<tr>
<td class="reference"><b id="RFC2119">[RFC2119]</b></td>
<td class="top">
<a>Bradner, S.</a>, "<a href="https://tools.ietf.org/html/rfc2119">Key words for use in RFCs to Indicate Requirement Levels</a>", BCP 14, RFC 2119, DOI 10.17487/RFC2119, March 1997.</td>
</tr>
<tr>
<td class="reference"><b id="RFC4648">[RFC4648]</b></td>
<td class="top">
<a>Josefsson, S.</a>, "<a href="https://tools.ietf.org/html/rfc4648">The Base16, Base32, and Base64 Data Encodings</a>", RFC 4648, DOI 10.17487/RFC4648, October 2006.</td>
</tr>
<tr>
<td class="reference"><b id="RFC5246">[RFC5246]</b></td>
<td class="top">
<a>Dierks, T.</a> and <a>E. Rescorla</a>, "<a href="https://tools.ietf.org/html/rfc5246">The Transport Layer Security (TLS) Protocol Version 1.2</a>", RFC 5246, DOI 10.17487/RFC5246, August 2008.</td>
</tr>
<tr>
<td class="reference"><b id="RFC5277">[RFC5277]</b></td>
<td class="top">
<a>Chisholm, S.</a> and <a>H. Trevino</a>, "<a href="https://tools.ietf.org/html/rfc5277">NETCONF Event Notifications</a>", RFC 5277, DOI 10.17487/RFC5277, July 2008.</td>
</tr>
<tr>
<td class="reference"><b id="RFC6243">[RFC6243]</b></td>
<td class="top">
<a>Bierman, A.</a> and <a>B. Lengyel</a>, "<a href="https://tools.ietf.org/html/rfc6243">With-defaults Capability for NETCONF</a>", RFC 6243, DOI 10.17487/RFC6243, June 2011.</td>
</tr>
<tr>
<td class="reference"><b id="RFC7049">[RFC7049]</b></td>
<td class="top">
<a>Bormann, C.</a> and <a>P. Hoffman</a>, "<a href="https://tools.ietf.org/html/rfc7049">Concise Binary Object Representation (CBOR)</a>", RFC 7049, DOI 10.17487/RFC7049, October 2013.</td>
</tr>
<tr>
<td class="reference"><b id="RFC7252">[RFC7252]</b></td>
<td class="top">
<a>Shelby, Z.</a>, <a>Hartke, K.</a> and <a>C. Bormann</a>, "<a href="https://tools.ietf.org/html/rfc7252">The Constrained Application Protocol (CoAP)</a>", RFC 7252, DOI 10.17487/RFC7252, June 2014.</td>
</tr>
<tr>
<td class="reference"><b id="RFC7641">[RFC7641]</b></td>
<td class="top">
<a>Hartke, K.</a>, "<a href="https://tools.ietf.org/html/rfc7641">Observing Resources in the Constrained Application Protocol (CoAP)</a>", RFC 7641, DOI 10.17487/RFC7641, September 2015.</td>
</tr>
<tr>
<td class="reference"><b id="RFC7950">[RFC7950]</b></td>
<td class="top">
<a>Bjorklund, M.</a>, "<a href="https://tools.ietf.org/html/rfc7950">The YANG 1.1 Data Modeling Language</a>", RFC 7950, DOI 10.17487/RFC7950, August 2016.</td>
</tr>
<tr>
<td class="reference"><b id="RFC7959">[RFC7959]</b></td>
<td class="top">
<a>Bormann, C.</a> and <a>Z. Shelby</a>, "<a href="https://tools.ietf.org/html/rfc7959">Block-Wise Transfers in the Constrained Application Protocol (CoAP)</a>", RFC 7959, DOI 10.17487/RFC7959, August 2016.</td>
</tr>
<tr>
<td class="reference"><b id="RFC8040">[RFC8040]</b></td>
<td class="top">
<a>Bierman, A.</a>, <a>Bjorklund, M.</a> and <a>K. Watsen</a>, "<a href="https://tools.ietf.org/html/rfc8040">RESTCONF Protocol</a>", RFC 8040, DOI 10.17487/RFC8040, January 2017.</td>
</tr>
<tr>
<td class="reference"><b id="RFC8132">[RFC8132]</b></td>
<td class="top">
<a>van der Stok, P.</a>, <a>Bormann, C.</a> and <a>A. Sehgal</a>, "<a href="https://tools.ietf.org/html/rfc8132">PATCH and FETCH Methods for the Constrained Application Protocol (CoAP)</a>", RFC 8132, DOI 10.17487/RFC8132, April 2017.</td>
</tr>
</tbody></table>
<h1 id="rfc.references.2">
<a href="#rfc.references.2">8.2.</a> Informative References</h1>
<table><tbody>
<tr>
<td class="reference"><b id="I-D.ietf-core-interfaces">[I-D.ietf-core-interfaces]</b></td>
<td class="top">
<a>Shelby, Z.</a>, <a>Vial, M.</a>, <a>Koster, M.</a>, <a>Groves, C.</a>, <a>Zhu, J.</a> and <a>B. Silverajan</a>, "<a href="https://tools.ietf.org/html/draft-ietf-core-interfaces-10">Reusable Interface Definitions for Constrained RESTful Environments</a>", Internet-Draft draft-ietf-core-interfaces-10, September 2017.</td>
</tr>
<tr>
<td class="reference"><b id="RFC4086">[RFC4086]</b></td>
<td class="top">
<a>Eastlake 3rd, D.</a>, <a>Schiller, J.</a> and <a>S. Crocker</a>, "<a href="https://tools.ietf.org/html/rfc4086">Randomness Requirements for Security</a>", BCP 106, RFC 4086, DOI 10.17487/RFC4086, June 2005.</td>
</tr>
<tr>
<td class="reference"><b id="RFC4279">[RFC4279]</b></td>
<td class="top">
<a>Eronen, P.</a> and <a>H. Tschofenig</a>, "<a href="https://tools.ietf.org/html/rfc4279">Pre-Shared Key Ciphersuites for Transport Layer Security (TLS)</a>", RFC 4279, DOI 10.17487/RFC4279, December 2005.</td>
</tr>
<tr>
<td class="reference"><b id="RFC4293">[RFC4293]</b></td>
<td class="top">
<a>Routhier, S.</a>, "<a href="https://tools.ietf.org/html/rfc4293">Management Information Base for the Internet Protocol (IP)</a>", RFC 4293, DOI 10.17487/RFC4293, April 2006.</td>
</tr>
<tr>
<td class="reference"><b id="RFC5280">[RFC5280]</b></td>
<td class="top">
<a>Cooper, D.</a>, <a>Santesson, S.</a>, <a>Farrell, S.</a>, <a>Boeyen, S.</a>, <a>Housley, R.</a> and <a>W. Polk</a>, "<a href="https://tools.ietf.org/html/rfc5280">Internet X.509 Public Key Infrastructure Certificate and Certificate Revocation List (CRL) Profile</a>", RFC 5280, DOI 10.17487/RFC5280, May 2008.</td>
</tr>
<tr>
<td class="reference"><b id="RFC6066">[RFC6066]</b></td>
<td class="top">
<a>Eastlake 3rd, D.</a>, "<a href="https://tools.ietf.org/html/rfc6066">Transport Layer Security (TLS) Extensions: Extension Definitions</a>", RFC 6066, DOI 10.17487/RFC6066, January 2011.</td>
</tr>
<tr>
<td class="reference"><b id="RFC6125">[RFC6125]</b></td>
<td class="top">
<a>Saint-Andre, P.</a> and <a>J. Hodges</a>, "<a href="https://tools.ietf.org/html/rfc6125">Representation and Verification of Domain-Based Application Service Identity within Internet Public Key Infrastructure Using X.509 (PKIX) Certificates in the Context of Transport Layer Security (TLS)</a>", RFC 6125, DOI 10.17487/RFC6125, March 2011.</td>
</tr>
<tr>
<td class="reference"><b id="RFC6347">[RFC6347]</b></td>
<td class="top">
<a>Rescorla, E.</a> and <a>N. Modadugu</a>, "<a href="https://tools.ietf.org/html/rfc6347">Datagram Transport Layer Security Version 1.2</a>", RFC 6347, DOI 10.17487/RFC6347, January 2012.</td>
</tr>
<tr>
<td class="reference"><b id="RFC6655">[RFC6655]</b></td>
<td class="top">
<a>McGrew, D.</a> and <a>D. Bailey</a>, "<a href="https://tools.ietf.org/html/rfc6655">AES-CCM Cipher Suites for Transport Layer Security (TLS)</a>", RFC 6655, DOI 10.17487/RFC6655, July 2012.</td>
</tr>
<tr>
<td class="reference"><b id="RFC6690">[RFC6690]</b></td>
<td class="top">
<a>Shelby, Z.</a>, "<a href="https://tools.ietf.org/html/rfc6690">Constrained RESTful Environments (CoRE) Link Format</a>", RFC 6690, DOI 10.17487/RFC6690, August 2012.</td>
</tr>
<tr>
<td class="reference"><b id="RFC7159">[RFC7159]</b></td>
<td class="top">
<a>Bray, T.</a>, "<a href="https://tools.ietf.org/html/rfc7159">The JavaScript Object Notation (JSON) Data Interchange Format</a>", RFC 7159, DOI 10.17487/RFC7159, March 2014.</td>
</tr>
<tr>
<td class="reference"><b id="RFC7223">[RFC7223]</b></td>
<td class="top">
<a>Bjorklund, M.</a>, "<a href="https://tools.ietf.org/html/rfc7223">A YANG Data Model for Interface Management</a>", RFC 7223, DOI 10.17487/RFC7223, May 2014.</td>
</tr>
<tr>
<td class="reference"><b id="RFC7251">[RFC7251]</b></td>
<td class="top">
<a>McGrew, D.</a>, <a>Bailey, D.</a>, <a>Campagna, M.</a> and <a>R. Dugal</a>, "<a href="https://tools.ietf.org/html/rfc7251">AES-CCM Elliptic Curve Cryptography (ECC) Cipher Suites for TLS</a>", RFC 7251, DOI 10.17487/RFC7251, June 2014.</td>
</tr>
<tr>
<td class="reference"><b id="RFC7317">[RFC7317]</b></td>
<td class="top">
<a>Bierman, A.</a> and <a>M. Bjorklund</a>, "<a href="https://tools.ietf.org/html/rfc7317">A YANG Data Model for System Management</a>", RFC 7317, DOI 10.17487/RFC7317, August 2014.</td>
</tr>
<tr>
<td class="reference"><b id="RFC7925">[RFC7925]</b></td>
<td class="top">
<a>Tschofenig, H.</a> and <a>T. Fossati</a>, "<a href="https://tools.ietf.org/html/rfc7925">Transport Layer Security (TLS) / Datagram Transport Layer Security (DTLS) Profiles for the Internet of Things</a>", RFC 7925, DOI 10.17487/RFC7925, July 2016.</td>
</tr>
<tr>
<td class="reference"><b id="XML">[XML]</b></td>
<td class="top">
<a>W3C</a>, "<a>Extensible Markup Language (XML)</a>", Web http://www.w3.org/xml</td>
</tr>
</tbody></table>
<h1 id="rfc.appendix.A">
<a href="#rfc.appendix.A">Appendix A.</a> <a href="#appendix1" id="appendix1">Appendix 1: TITLE</a>
</h1>
<p id="rfc.section.A.p.1">askdjhasdkjhaskdjhaskjdhkajshdkjahsd asdlkjasldkjasd alskdjlaksjdlkajsd aslkdaslkdj</p>
<h1 id="rfc.appendix.B">
<a href="#rfc.appendix.B">Appendix B.</a> <a href="#example-objects" id="example-objects">OMA DM example Objects</a>
</h1>
<p id="rfc.section.B.p.1">This appendix shows &#8230;..</p>
<h1 id="rfc.authors"><a href="#rfc.authors">Authors' Addresses</a></h1>
<div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">Jaime Jimenez</span> (editor)
	  <span class="n hidden">
		<span class="family-name">Jimenez</span>
	  </span>
	</span>
	<span class="org vcardline">Ericsson</span>
	<span class="adr">
	  <span class="vcardline">My Great Street</span>

	  <span class="vcardline">
		<span class="locality">Madrid</span>,  
		<span class="region">Spain</span> 
		<span class="code"></span>
	  </span>
	  <span class="country-name vcardline"></span>
	</span>
	
  </address>
</div><div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">Author One</span> 
	  <span class="n hidden">
		<span class="family-name">One</span>
	  </span>
	</span>
	<span class="org vcardline">Company</span>
	<span class="adr">
	  
	  <span class="vcardline">
		<span class="locality"></span> 
		<span class="region"></span>
		<span class="code"></span>
	  </span>
	  <span class="country-name vcardline"></span>
	</span>
	<span class="vcardline">EMail: <a href="mailto:author@company.org">author@company.org</a></span>

  </address>
</div><div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">Author Two</span> 
	  <span class="n hidden">
		<span class="family-name">Two</span>
	  </span>
	</span>
	<span class="org vcardline">Company</span>
	<span class="adr">
	  
	  <span class="vcardline">
		<span class="locality"></span> 
		<span class="region"></span>
		<span class="code"></span>
	  </span>
	  <span class="country-name vcardline"></span>
	</span>
	<span class="vcardline">EMail: <a href="mailto:author@company.org">author@company.org</a></span>

  </address>
</div><div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">Author Three</span> 
	  <span class="n hidden">
		<span class="family-name">Three</span>
	  </span>
	</span>
	<span class="org vcardline">Company</span>
	<span class="adr">
	  
	  <span class="vcardline">
		<span class="locality"></span> 
		<span class="region"></span>
		<span class="code"></span>
	  </span>
	  <span class="country-name vcardline"></span>
	</span>
	<span class="vcardline">EMail: <a href="mailto:author@company.org">author@company.org</a></span>

  </address>
</div>

  <div class="github-fork-ribbon-wrapper"><div class="github-fork-ribbon"><a href="https://github.com/omadm/comi">Fork me on GitHub</a></div></div>
</body>
</html>
